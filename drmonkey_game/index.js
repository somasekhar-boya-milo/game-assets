System.register("chunks:///_virtual/DrMonkey_AiJudgementScreen.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_Menu.ts","./DrMonkeyGameHandler.ts","./DrMonkey_AudioManager.ts","./DrMonkey_UIManager.ts","./DrMonkey_Utils.ts"],(function(e){var t,i,n,r,a,o,s,l,u,c,d,h,p,g,v,y,f,b,m;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,s=e.Node,l=e.Label,u=e.Sprite,c=e.SpriteFrame,d=e.Animation,h=e.Color,p=e.Vec3,g=e.tween},function(e){v=e.DrMonkeyMenu},function(e){y=e.DrMonkeyGameHandler},function(e){f=e.DrMonkeyAudioManager},function(e){b=e.DrMonkeyUIManager},function(e){m=e.DrMonkeyUtils}],execute:function(){var S,A,N,P,T,w,L,C,D,E,O,k,M,J,I,_,z,R,U,V,F,G,j,x,K,B,H,Y,W,q,Q,X,Z,$,ee;a._RF.push({},"a04e5zgMo5B6rK/mWqFA7xY","DrMonkey_AiJudgementScreen",void 0);var te=o.ccclass,ie=o.property,ne=function(e){return e.JUDGING="Judging",e.TALKING_UP="Talking_Up",e.TALKING_DOWN="Talking_Down",e.USER_NOT_SURVIVED="user_not_survived",e.USER_SURVIVED="user_survived",e}(ne||{});e("DrMonkeyAiJudgementScreen",(S=te("DrMonkeyAiJudgementScreen"),A=ie({type:s}),N=ie({type:l}),P=ie({type:s}),T=ie({type:l}),w=ie({type:l}),L=ie({type:s}),C=ie({type:l}),D=ie({type:l}),E=ie({type:l}),O=ie({type:u}),k=ie({type:c}),M=ie({type:c}),J=ie({type:s}),I=ie({type:s}),_=ie({type:s}),z=ie({type:s}),S((V=t((U=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))||this).TRANSITION_DELAY_SEC=6,t.DOTS_ANIMATION_INTERVAL=.5,n(t,"loadingParent",V,r(t)),n(t,"judgingMessageLabel",F,r(t)),n(t,"playerAnswerParent",G,r(t)),n(t,"playerAnswerTriesTooLabel",j,r(t)),n(t,"playerAnswerLabel",x,r(t)),n(t,"aiJudgementParent",K,r(t)),n(t,"aiAnswerTriesTooLabel",B,r(t)),n(t,"aiJudgementLabel",H,r(t)),n(t,"aiSurvivedOrNotLabel",Y,r(t)),n(t,"aiSurvivedOrNotSprite",W,r(t)),n(t,"aiSurvivedSpriteFrame",q,r(t)),n(t,"aiDidNotSurviveSpriteFrame",Q,r(t)),t.drChaosAnimation=null,n(t,"drChaosNode",X,r(t)),n(t,"drChaosPlayerAnswerStateParentNode",Z,r(t)),n(t,"drChaosAiJudgementStateParentNode",$,r(t)),n(t,"drChaosLoadingStateParentNode",ee,r(t)),t.currentPlayerData=null,t.currentPlayerName="",t.currentPlayerAnswer="",t.currentAiJudgement="",t.currentAiSurvivedOrNot=!1,t.judgementReadTime=0,t.activeTypeEffectCallbacks=new Map,t}i(t,e);var a=t.prototype;return a.Open=function(){e.prototype.Open.call(this),this.resetUIElements(),this.loadingParent.active=!0,this.startJudgingDotsAnimation()},a.Close=function(){e.prototype.Close.call(this),this.resetUIElements()},a.onLoad=function(){this.drChaosAnimation=this.drChaosNode.getComponent(d)},a.onDestroy=function(){this.clearPreviousAnimations(),this.currentPlayerData=null,this.currentPlayerName="",this.currentPlayerAnswer="",this.currentAiJudgement="",this.judgementReadTime=0,this.activeTypeEffectCallbacks.clear(),e.prototype.onDestroy&&e.prototype.onDestroy.call(this)},a.setAiJudgement=function(e){this.clearPreviousAnimations(),this.storeJudgementData(e),this.showPlayerAnswer(),this.scheduleAiJudgementTransition()},a.setFateSealed=function(){this.clearPreviousAnimations(),this.loadingParent.active=!0,this.judgingMessageLabel.string="YOUR FATE\nHAS BEEN\nSEALED",this.drChaosNode.setParent(this.drChaosLoadingStateParentNode),this.drChaosAnimation.play(ne.TALKING_UP)},a.startJudgingDotsAnimation=function(){var e=this;if(this.judgingMessageLabel&&this.loadingParent.active){this.judgingMessageLabel.string="JUDGING";var t=0,i="judgingDotsAnimation",n=function(){if(!e.loadingParent.active)return e.unschedule(r),void e.activeTypeEffectCallbacks.delete(i);var n=".".repeat(t=t%3+1);e.judgingMessageLabel.string="JUDGING"+n},r=function(){return n()};this.activeTypeEffectCallbacks.has(i)&&this.unschedule(this.activeTypeEffectCallbacks.get(i)),this.activeTypeEffectCallbacks.set(i,r),this.schedule(r,this.DOTS_ANIMATION_INTERVAL),this.drChaosNode.setParent(this.drChaosLoadingStateParentNode),this.drChaosAnimation.play(ne.JUDGING)}},a.clearPreviousAnimations=function(){this.unscheduleAllCallbacks(),this.cancelAllTypeEffects(),this.stopAllMenuSounds(),this.clearVideoCallbacks()},a.cancelAllTypeEffects=function(){var e=this;this.activeTypeEffectCallbacks.forEach((function(t,i){e.unschedule(t)})),this.activeTypeEffectCallbacks.clear(),f.instance.stopSound("MonkeyTalking")},a.clearVideoCallbacks=function(){},a.resetUIElements=function(){this.stopAllMenuSounds(),this.loadingParent.active=!1,this.playerAnswerParent.active=!1,this.aiJudgementParent.active=!1,this.judgingMessageLabel&&(this.judgingMessageLabel.string=""),this.playerAnswerLabel&&(this.playerAnswerLabel.string=""),this.playerAnswerTriesTooLabel&&(this.playerAnswerTriesTooLabel.string=""),this.aiJudgementLabel&&(this.aiJudgementLabel.string=""),this.aiAnswerTriesTooLabel&&(this.aiAnswerTriesTooLabel.string=""),this.aiSurvivedOrNotLabel&&(this.aiSurvivedOrNotLabel.string=""),this.aiSurvivedOrNotSprite&&(this.aiSurvivedOrNotSprite.spriteFrame=null)},a.stopAllMenuSounds=function(){f.instance.stopSound("MonkeyTalking"),f.instance.stopSound("Death"),f.instance.stopSound("Survived")},a.storeJudgementData=function(e){this.currentPlayerData=y.Instance.getRoomState().getPlayerBySessionId(e.playerSessionId),this.currentPlayerName=m.truncateName(e.playerName,10),this.currentPlayerAnswer=this.currentPlayerData.currentAnswer,this.currentAiJudgement=this.currentPlayerData.aiJudgement,this.currentAiSurvivedOrNot=e.survived,this.judgementReadTime=e.judgementReadTime},a.showPlayerAnswer=function(){this.clearVideoCallbacks(),this.loadingParent.active=!1,this.aiJudgementParent.active=!1,this.playerAnswerParent.active=!0,this.playerAnswerTriesTooLabel.string=m.truncateName(this.currentPlayerName,10)+" tries too:";var e=y.Instance.getRoomState().roomSettings.timePerChar;this.applyTypeEffect(this.playerAnswerLabel,this.currentPlayerAnswer,e),this.drChaosNode.setParent(this.drChaosPlayerAnswerStateParentNode),this.drChaosAnimation.play(ne.TALKING_DOWN)},a.scheduleAiJudgementTransition=function(){var e=y.Instance.getRoomState().roomSettings.timePerChar,t=this.calculateReadTime(this.currentPlayerAnswer,e);this.scheduleOnce(this.showAiJudgement.bind(this),this.TRANSITION_DELAY_SEC+t)},a.showAiJudgement=function(){var e=this;this.clearVideoCallbacks(),this.loadingParent.active=!1,this.playerAnswerParent.active=!1,this.aiJudgementParent.active=!0,this.aiAnswerTriesTooLabel.string=m.truncateName(this.currentPlayerName)+" tries to..:";var t=y.Instance.getRoomState().roomSettings.timePerChar;this.aiSurvivedOrNotLabel.color=new h(255,255,255,0),this.drChaosNode.setParent(this.drChaosAiJudgementStateParentNode),this.drChaosAnimation.play(ne.TALKING_UP),this.applyTypeEffect(this.aiJudgementLabel,this.currentAiJudgement,t,(function(){e.aiSurvivedOrNotLabel.string=e.currentAiSurvivedOrNot?"Survived":"Did Not Survive",e.aiSurvivedOrNotSprite&&(e.aiSurvivedOrNotSprite.spriteFrame=e.currentAiSurvivedOrNot?e.aiSurvivedSpriteFrame:e.aiDidNotSurviveSpriteFrame),e.aiSurvivedOrNotLabel.color=new h(255,255,255,0);var t=e.currentAiSurvivedOrNot?new h(0,255,0,255):new h(255,0,0,255),i=e.aiSurvivedOrNotLabel.node.scale.clone();e.aiSurvivedOrNotLabel.node.setScale(new p(2.5*i.x,2.5*i.y,i.z));var n=e.aiSurvivedOrNotLabel.node.position.clone();if(e.aiSurvivedOrNotLabel.node.setPosition(n.x,n.y+50,n.z),!e.currentAiSurvivedOrNot&&e.aiJudgementParent.active){console.log("=== Playing laughing video ===");var r=e.currentAiSurvivedOrNot?ne.USER_SURVIVED:ne.USER_NOT_SURVIVED;e.drChaosNode.setParent(e.drChaosAiJudgementStateParentNode),e.drChaosAnimation.play(r),f.instance.playSound("Death"),b.instance.playFlashEffect()}else e.currentAiSurvivedOrNot&&(f.instance.playSound("Survived"),b.instance.playFlashEffect(new h(15,156,4)));e.scheduleOnce((function(){if(e.aiJudgementParent.active){g(e.aiSurvivedOrNotLabel.node).set({angle:10}).to(.15,{position:n,scale:i,angle:-2},{easing:"quartIn"}).to(.1,{scale:new p(1.1*i.x,1.1*i.y,i.z),angle:0},{easing:"bounceOut"}).to(.2,{scale:i},{easing:"elasticOut"}).start(),g(e.aiSurvivedOrNotLabel).to(.05,{color:new h(t.r,t.g,t.b,0)}).to(.1,{color:t}).start();var r=e.aiJudgementParent;if(r){var a=r.position.clone();g(r).to(.02,{position:new p(a.x+5,a.y,a.z)}).to(.02,{position:new p(a.x-5,a.y,a.z)}).to(.02,{position:new p(a.x,a.y,a.z)}).start()}}}),.5)}))},a.applyTypeEffect=function(e,t,i,n){var r=this;if(void 0===i&&(i=.1),f.instance.playSound("MonkeyTalking"),e.string="",t){var a=0,o=t.length,s=e.uuid+"_typeEffect";this.activeTypeEffectCallbacks.has(s)&&(this.unschedule(this.activeTypeEffectCallbacks.get(s)),this.activeTypeEffectCallbacks.delete(s));var l=!0;this.activeTypeEffectCallbacks.set(s,(function(){l=!1})),function u(){var c=e.node.parent;if(!c||!c.active||!e.isValid)return l=!1,void r.activeTypeEffectCallbacks.delete(s);a<o?(e.string=t.substring(0,a+1),a++,l&&r.scheduleOnce((function(){return u()}),i)):(l=!1,r.activeTypeEffectCallbacks.delete(s),n&&c.active&&e.isValid&&(f.instance.stopSound("MonkeyTalking"),n()))}()}else n&&n()},a.calculateReadTime=function(e,t){if(void 0===t&&(t=.05),!e)return 0;var i=e.replace(/\s+/g,"").length;return Math.max(1,i*t)},t}(v)).prototype,"loadingParent",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(U.prototype,"judgingMessageLabel",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=t(U.prototype,"playerAnswerParent",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),j=t(U.prototype,"playerAnswerTriesTooLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=t(U.prototype,"playerAnswerLabel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),K=t(U.prototype,"aiJudgementParent",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(U.prototype,"aiAnswerTriesTooLabel",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),H=t(U.prototype,"aiJudgementLabel",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Y=t(U.prototype,"aiSurvivedOrNotLabel",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),W=t(U.prototype,"aiSurvivedOrNotSprite",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),q=t(U.prototype,"aiSurvivedSpriteFrame",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Q=t(U.prototype,"aiDidNotSurviveSpriteFrame",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),X=t(U.prototype,"drChaosNode",[J],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Z=t(U.prototype,"drChaosPlayerAnswerStateParentNode",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$=t(U.prototype,"drChaosAiJudgementStateParentNode",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ee=t(U.prototype,"drChaosLoadingStateParentNode",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=U))||R));a._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_AnimationAssets.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var n,a,i,e,o,s,r,l,c,p,u,m,A;return{setters:[function(t){n=t.applyDecoratedDescriptor,a=t.initializerDefineProperty,i=t.inheritsLoose,e=t.assertThisInitialized,o=t.createForOfIteratorHelperLoose,s=t.createClass},function(t){r=t.cclegacy,l=t._decorator,c=t.Enum,p=t.Asset,u=t.resources,m=t.assetManager,A=t.Component}],execute:function(){var f,y,h,d,M,_,k,b,g,v,C,D,I;r._RF.push({},"f8a0fzJaFRFCpqdw9H17mjL","DrMonkey_AnimationAssets",void 0);var L=l.ccclass,w=l.property,F=t("MonkeyAnimationType",function(t){return t.IDLE="idle",t.THINKING="thinking",t.TALKING="talking",t.LOOKING_UP="looking_up",t.LOOKING_DOWN="looking_down",t.LAUGHING="laughing",t}({})),N=(f=L("DrMonkeyAnimationAssetMapping"),y=w({type:c(F),tooltip:"Animation type from MonkeyAnimationType"}),h=w({type:p,tooltip:"Asset for this animation type"}),f((_=n((M=function(){a(this,"type",_,this),a(this,"asset",k,this),this.callback=null}).prototype,"type",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return F.IDLE}}),k=n(M.prototype,"asset",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=M))||d);t("DrMonkeyAnimationAssets",(b=L("DrMonkeyAnimationAssets"),g=w({type:[N],tooltip:"List of animation assets mapped to animation types"}),b(((I=function(t){function n(){for(var n,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return n=t.call.apply(t,[this].concat(o))||this,a(n,"animationMappings",D,e(n)),n._animationAssetMap=new Map,n._animationCallbackMap=new Map,n._currentVideo=null,n}i(n,t);var r=n.prototype;return r.onLoad=function(){n._instance=this,this._updateInternalMap()},r._updateInternalMap=function(){this._animationAssetMap.clear(),this._animationCallbackMap.clear();for(var t,n=o(this.animationMappings);!(t=n()).done;){var a=t.value;a.type&&a.asset&&(this._animationAssetMap.set(a.type,a.asset),a.callback&&this._animationCallbackMap.set(a.type,a.callback))}},r.getAnimationAsset=function(t){return this._animationAssetMap.get(t)||null},r.setAnimationAsset=function(t,n,a){this._animationAssetMap.set(t,n),a&&this._animationCallbackMap.set(t,a);for(var i,e=!1,s=o(this.animationMappings);!(i=s()).done;){var r=i.value;if(r.type===t){r.asset=n,r.callback=a||null,e=!0;break}}if(!e){var l=new N;l.type=t,l.asset=n,l.callback=a||null,this.animationMappings.push(l)}},r.setAnimationEndedCallback=function(t,n){if(n){this._animationCallbackMap.set(t,n);for(var a,i=o(this.animationMappings);!(a=i()).done;){var e=a.value;if(e.type===t){e.callback=n;break}}}},r.executeCallback=function(t){var n=this._animationCallbackMap.get(t);n&&n()},r.playAnimation=function(t,n){var a=this,i=this.getAnimationAsset(t);i&&n?(this._currentVideo=t,n.setVideoEndedCallback((function(){a._currentVideo===t&&(a.executeCallback(t),a._currentVideo=null)})),n.configureVideoSource(i.nativeUrl),n.playVideo()):console.error("[MonkeyAnimationAssets] Cannot play animation: asset or video player not found for type "+t)},r.hasAnimationAsset=function(t){return this._animationAssetMap.has(t)},r.getAvailableAnimationTypes=function(){return Array.from(this._animationAssetMap.keys())},r.loadAnimationAsset=function(t,n,a,i){var e=this;u.load(n,p,(function(o,s){if(o)return console.error("[MonkeyAnimationAssets] Failed to load asset at path: "+n,o),void(null==a||a(!1));e.setAnimationAsset(t,s,i),null==a||a(!0)}))},r.loadAnimationAssetFromRemote=function(t,n,a,i){var e=this;m.loadRemote(n,(function(o,s){if(o)return console.error("[MonkeyAnimationAssets] Failed to load remote asset: "+n,o),void(null==a||a(!1));e.setAnimationAsset(t,s,i),null==a||a(!0)}))},r.clearAnimationAssets=function(){this._animationAssetMap.clear(),this._animationCallbackMap.clear(),this.animationMappings=[]},r._loadDefaultAssets=function(){},r.onDestroy=function(){n._instance===this&&(n._instance=null)},s(n,null,[{key:"Instance",get:function(){return this._instance}}]),n}(A))._instance=null,D=n((C=I).prototype,"animationMappings",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),v=C))||v));r._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_AudioManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(i){var e,o,t,n,a,u,r,l,s,c,d,p,h,f,y,b;return{setters:[function(i){e=i.applyDecoratedDescriptor,o=i.inheritsLoose,t=i.initializerDefineProperty,n=i.assertThisInitialized,a=i.createClass},function(i){u=i.cclegacy,r=i._decorator,l=i.CCString,s=i.AudioClip,c=i.CCFloat,d=i.CCBoolean,p=i.AudioSource,h=i.Prefab,f=i.sys,y=i.instantiate,b=i.Component}],execute:function(){var g,A,S,C,m,E,v,P,w,D,I,k,L,M,z,_,B,x,T,R,F,G,K;u._RF.push({},"289a5GSwBtNjJrWx9nSuRCh","DrMonkey_AudioManager",void 0);var W=r.ccclass,j=r.property,U=(g=W("DrMonkeyAudioClipData"),A=j({type:l}),S=j({type:s}),C=j({type:c}),m=j({type:c}),E=j({type:d}),g((w=e((P=function(){function i(){t(this,"name",w,this),t(this,"audioClips",D,this),t(this,"delayBetweenClips",I,this),t(this,"volume",k,this),t(this,"loop",L,this),this.isLoopPlaying=void 0,this.lastPlayedTime=0,this.clipIndex=0}var e=i.prototype;return e.GetClip=function(){var i=this.audioClips[this.clipIndex];if(this.clipIndex=(this.clipIndex+1)%this.audioClips.length,this.CanPlay())return this.lastPlayedTime=Date.now(),i},e.CanPlay=function(){return Date.now()-this.lastPlayedTime>1e3*this.delayBetweenClips},i}()).prototype,"name",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=e(P.prototype,"audioClips",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=e(P.prototype,"delayBetweenClips",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),k=e(P.prototype,"volume",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),L=e(P.prototype,"loop",[E],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),v=P))||v);i("DrMonkeyAudioManager",(M=W("DrMonkeyAudioManager"),z=j({type:U}),_=j({type:p}),B=j({type:h}),M(((K=function(i){function e(){for(var e,o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return e=i.call.apply(i,[this].concat(a))||this,t(e,"audioClipData",R,n(e)),t(e,"backgroundAudioSource",F,n(e)),e.localStorageAudioEnabledKey="PBCRAudioEnabled",t(e,"audioSourcePrefab",G,n(e)),e.audioSources=[],e._isAudioEnabled="true",e}o(e,i);var u=e.prototype;return u.onLoad=function(){e.instance=this,this.ReadAudioEnabledFromLocalStorage()},u.start=function(){this.SetAudioEnabled(this.IsAudioEnabled)},u.playSound=function(i){if("false"!=this.IsAudioEnabled){var e=this.audioClipData.find((function(e){return e.name==i}));if(null!=e){var o=e.GetClip();if(o){if(e.isLoopPlaying)return;var t=this.getEmptyAudioSource();t.loop=e.loop,e.isLoopPlaying=e.loop,t.volume=e.volume,t.clip=o,e.loop?t.play():t.playOneShot(o)}else console.warn("Audio Clip is in use ",i)}}},u.stopSound=function(i){var e=this.audioClipData.find((function(e){return e.name==i}));e?this.audioSources.forEach((function(i){i.clip==e.audioClips[e.clipIndex]&&(e.isLoopPlaying=!1,i.stop())})):console.warn("Audio Clip not found for ",i)},u.stopAllSounds=function(){this.audioSources.forEach((function(i){i.stop()})),this.audioClipData.forEach((function(i){i.isLoopPlaying=!1}))},u.ToggleAudio=function(){"true"==this.IsAudioEnabled?this.SetAudioEnabled("false"):this.SetAudioEnabled("true")},u.SetAudioEnabled=function(i){this._isAudioEnabled=i,this.UpdateBackgroundMusic(),this.WriteAudioEnabledToLocalStorage()},u.WriteAudioEnabledToLocalStorage=function(){f.localStorage.setItem(this.localStorageAudioEnabledKey,this.IsAudioEnabled)},u.ReadAudioEnabledFromLocalStorage=function(){var i=f.localStorage.getItem(this.localStorageAudioEnabledKey);this._isAudioEnabled=null==i?"true":i},u.UpdateBackgroundMusic=function(){var i,e;"true"==this.IsAudioEnabled?null==(i=this.backgroundAudioSource)||i.play():null==(e=this.backgroundAudioSource)||e.stop()},u.printAllPlayingAudioSources=function(){this.audioSources.forEach((function(i){i.playing&&console.log("Playing audio source: ",i.playing,i.clip.name,i.uuid)}))},u.getEmptyAudioSource=function(){var i=this.audioSources.find((function(i){return!i.playing}));return null==i&&(i=this.createAudioSource()),i},u.createAudioSource=function(){var i=y(this.audioSourcePrefab).getComponent(p);return i.node.setParent(this.node),this.audioSources.push(i),console.log("==== Created new audio source: ",this.audioSources.length),i},u.onDestroy=function(){e.instance===this&&(e.instance=null)},a(e,[{key:"IsAudioEnabled",get:function(){return this._isAudioEnabled}}]),e}(b)).instance=null,R=e((T=K).prototype,"audioClipData",[z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),F=e(T.prototype,"backgroundAudioSource",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(T.prototype,"audioSourcePrefab",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=T))||x));u._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_BasePlayerData.ts",["cc"],(function(i){var e;return{setters:[function(i){e=i.cclegacy}],execute:function(){e._RF.push({},"9384eYnVbdAdIj0/PY3yqZq","DrMonkey_BasePlayerData",void 0);i("DrMonkeyBasePlayerData",function(){function i(){this.userId=void 0,this.name=void 0,this.avatar=void 0,this.sessionId=void 0,this.playerNumber=void 0,this.type=void 0,this.isOnline=void 0,this.isConnected=void 0,this.isReplacedByBot=void 0,this.isKickedOut=void 0,this.isReady=void 0,this.score=void 0}return i.prototype.copyFrom=function(i){this.userId=i.userId,this.name=i.name,this.avatar=i.avatar,this.sessionId=i.sessionId,this.playerNumber=i.playerNumber,this.type=i.type,this.isOnline=i.isOnline,this.isConnected=i.isConnected,this.isReplacedByBot=i.isReplacedByBot,this.isKickedOut=i.isKickedOut,this.isReady=i.isReady,this.score=i.score},i}());e._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_BaseRoomSettings.ts",["cc"],(function(e){var t;return{setters:[function(e){t=e.cclegacy}],execute:function(){t._RF.push({},"9210d69+T9OjIjFOkPmehuV","DrMonkey_BaseRoomSettings",void 0);e("DefaultRoomSettings",{maxPlayers:8,minPlayers:2,maxClients:8,countdownTimeInSeconds:3,allowLateJoin:!0,maxReconnectionAttempts:3,reconnectionAttemptInterval:1e3,reconnectionTime:1e4,gameFPS:30,serverFPS:30,patchRate:1e3}),e("DrMonkeyBaseRoomSettings",function(){function e(){this.maxPlayers=void 0,this.minPlayers=void 0,this.maxClients=void 0,this.countdownTimeInSeconds=void 0,this.allowLateJoin=void 0,this.maxReconnectionAttempts=void 0,this.reconnectionAttemptInterval=void 0,this.reconnectionTime=void 0,this.gameFPS=void 0,this.serverFPS=void 0,this.patchRate=void 0}return e.prototype.copyFrom=function(e){this.maxPlayers=e.maxPlayers,this.minPlayers=e.minPlayers,this.maxClients=e.maxClients,this.countdownTimeInSeconds=e.countdownTimeInSeconds,this.allowLateJoin=e.allowLateJoin,this.reconnectionTime=e.reconnectionTime,this.gameFPS=e.gameFPS,this.serverFPS=e.serverFPS,this.patchRate=e.patchRate},e}());t._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_BaseRoomState.ts",["cc","./DrMonkey_RoomTypes.ts"],(function(t){var o,s;return{setters:[function(t){o=t.cclegacy},function(t){s=t.DrMonkeyRoomStatus}],execute:function(){o._RF.push({},"beba3vZ96NIbpZoydKeMTYZ","DrMonkey_BaseRoomState",void 0);t("DrMonkeyBaseRoomState",function(){function t(t,o){this.currentRoomStatus=s.WAITING_FOR_PLAYERS,this.previousRoomStatus=s.NONE,this.roomSettings=void 0,this.playersData=void 0,this.spectatorsData=void 0,this.roomSettings=t,this.playersData=o,this.spectatorsData=[]}return t.prototype.copyFrom=function(t){this.currentRoomStatus=t.currentRoomStatus,this.previousRoomStatus=t.previousRoomStatus,this.roomSettings.copyFrom(t.roomSettings)},t}());o._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_CameraManger.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var t,i,r,n,a,o,h,s,c,u,d,f,g,l;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,r=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){a=e.cclegacy,o=e._decorator,h=e.EventTarget,s=e.UITransform,c=e.Camera,u=e.screen,d=e.sys,f=e.view,g=e.math,l=e.Component}],execute:function(){var p,w,m,v,H,b,y,S,O,z,C,A;a._RF.push({},"3f3ff+JHhVCB50fEFvbM/3Q","DrMonkey_CameraManger",void 0);var R=o.ccclass,W=o.property,M=o.executionOrder,D=e("CameraOrthoSizeChangeEvent",new h);M(-100);e("DrMonkeyCameraManger",(p=R("DrMonkeyCameraManger"),w=W({type:s}),p(((A=function(e){function t(){for(var t,i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return t=e.call.apply(e,[this].concat(a))||this,r(t,"canvasUITransform",H,n(t)),r(t,"designHeight",b,n(t)),r(t,"designWidth",y,n(t)),r(t,"defaultOrthoHeight",S,n(t)),r(t,"minOrthoHeight",O,n(t)),r(t,"maxOrthoHeight",z,n(t)),r(t,"safeAreaPadding",C,n(t)),t.designAspectRatio=void 0,t.currentAspectRatio=void 0,t.camera=null,t.windowWidth=1080,t.windowHeight=1920,t.effectiveWidth=0,t.effectiveHeight=0,t.effectiveAspectRatio=0,t}i(t,e);var a=t.prototype;return a.onLoad=function(){t.instance=this,this.designAspectRatio=this.designWidth/this.designHeight,this.camera=this.node.getComponent(c)},a.start=function(){var e=this;this.updateScreenSize(),this.adaptCameraToScreen(),window.addEventListener("resize",(function(){e.updateScreenSize(),e.adaptCameraToScreen()}))},a.updateScreenSize=function(){this.windowWidth=u.windowSize.width||window.innerWidth,this.windowHeight=u.windowSize.height||window.innerHeight,this.currentAspectRatio=this.windowWidth/this.windowHeight},a.adaptCameraToScreen=function(){if(this.camera){var e=0,t=0,i=0,r=0;if(d.os===d.OS.IOS||d.os===d.OS.ANDROID){var n=f.getVisibleSize(),a=f.getVisibleOrigin();n&&(e=a.y,t=this.windowHeight-(a.y+n.height),i=a.x,r=this.windowWidth-(a.x+n.width))}this.effectiveHeight=this.windowHeight-e-t-2*this.safeAreaPadding,this.effectiveWidth=this.windowWidth-i-r-2*this.safeAreaPadding,this.effectiveAspectRatio=this.effectiveWidth/this.effectiveHeight;var o=this.currentAspectRatio>=1,h=this.defaultOrthoHeight;if(o)h=this.defaultOrthoHeight*(1/this.currentAspectRatio)*1.5;else{var s=.6/Math.min(this.currentAspectRatio,.6);h=this.defaultOrthoHeight*s}h=g.clamp(h,this.minOrthoHeight,this.maxOrthoHeight),this.camera.orthoHeight=h,D.emit("CameraOrthoSizeChange",h)}},a.getWidth=function(){return 2*this.camera.orthoHeight*this.currentAspectRatio},a.getCurrentOrthoHeight=function(){return this.camera.orthoHeight},a.refreshCameraAdaptation=function(){this.updateScreenSize(),this.adaptCameraToScreen()},t}(l)).instance=null,H=t((v=A).prototype,"canvasUITransform",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),b=t(v.prototype,"designHeight",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1920}}),y=t(v.prototype,"designWidth",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1080}}),S=t(v.prototype,"defaultOrthoHeight",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 820}}),O=t(v.prototype,"minOrthoHeight",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 750}}),z=t(v.prototype,"maxOrthoHeight",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1080}}),C=t(v.prototype,"safeAreaPadding",[W],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),m=v))||m));a._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_CountDownScreen.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_Menu.ts"],(function(t){var n,o,e,i,a,c,r,u,l,s,d,p;return{setters:[function(t){n=t.applyDecoratedDescriptor,o=t.inheritsLoose,e=t.initializerDefineProperty,i=t.assertThisInitialized},function(t){a=t.cclegacy,c=t._decorator,r=t.Label,u=t.Color,l=t.UIOpacity,s=t.tween,d=t.Vec3},function(t){p=t.DrMonkeyMenu}],execute:function(){var h,w,f,y,_,T,m,b,C,g;a._RF.push({},"4fcd26hgZdFNq155872CM5b","DrMonkey_CountDownScreen",void 0);var x=c.ccclass,O=c.property;t("DrMonkeyCountdownScreen",(h=x("DrMonkeyCountdownScreen"),w=O({type:r}),h((_=n((y=function(t){function n(){for(var n,o=arguments.length,a=new Array(o),c=0;c<o;c++)a[c]=arguments[c];return n=t.call.apply(t,[this].concat(a))||this,e(n,"countdownText",_,i(n)),e(n,"useColorTransition",T,i(n)),e(n,"initialScale",m,i(n)),e(n,"finalScale",b,i(n)),e(n,"animationDuration",C,i(n)),e(n,"showGoMessage",g,i(n)),n._countdownTween=null,n._uiOpacity=null,n._countColors=[new u(255,0,0,255),new u(255,165,0,255),new u(0,255,0,255)],n}o(n,t);var a=n.prototype;return a.onLoad=function(){t.prototype.onLoad.call(this),this._initUIOpacity()},a._initUIOpacity=function(){this._uiOpacity=this.countdownText.node.getComponent(l),this._uiOpacity||(this._uiOpacity=this.countdownText.node.addComponent(l))},a.Open=function(){t.prototype.Open.call(this),this._startCountdown()},a.Close=function(){t.prototype.Close.call(this),this._stopCountdown()},a._stopCountdown=function(){this._countdownTween&&(this._countdownTween.stop(),this._countdownTween=null)},a._startCountdown=function(){var t;this._createCountdownSequence(),null==(t=this._countdownTween)||t.start()},a._createCountdownSequence=function(){var t=this;this.countdownText.node.active=!0,this._countdownTween=s(this.countdownText.node);for(var n=3;n>=1;n--)this._addNumberAnimation(n,3-n);this.showGoMessage&&this._addGoAnimation(),this._countdownTween.call((function(){return t._hideCountdown()}))},a._addNumberAnimation=function(t,n){var o=this,e=1-this.animationDuration-.2;this._countdownTween.call((function(){o._setupTextForAnimation(t.toString(),n)})).to(this.animationDuration,{scale:d.ONE.clone().multiplyScalar(this.finalScale)},{easing:"backOut"}).delay(.1).call((function(){o._fadeTextPartially()})).delay(e)},a._addGoAnimation=function(){var t=this;this._countdownTween.call((function(){t._setupTextForAnimation("GO!",2)})).to(.4,{scale:d.ONE.clone().multiplyScalar(1.2*this.finalScale)},{easing:"bounceOut"}).delay(.3).call((function(){t._fadeTextCompletely()}))},a._setupTextForAnimation=function(t,n){this.countdownText.string=t,this.countdownText.node.scale=d.ONE.clone().multiplyScalar(this.initialScale),this._uiOpacity.opacity=255,this.useColorTransition&&(this.countdownText.color=this._countColors[n])},a._fadeTextPartially=function(){s(this._uiOpacity).to(.1,{opacity:180}).start()},a._fadeTextCompletely=function(){s(this._uiOpacity).to(.3,{opacity:0}).start(),s(this.countdownText.node).to(.3,{scale:d.ONE.clone().multiplyScalar(1.5*this.finalScale)},{easing:"sineOut"}).start()},a._hideCountdown=function(){this.countdownText.string="",this.countdownText.node.active=!1},n}(p)).prototype,"countdownText",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=n(y.prototype,"useColorTransition",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),m=n(y.prototype,"initialScale",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2.5}}),b=n(y.prototype,"finalScale",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),C=n(y.prototype,"animationDuration",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return.8}}),g=n(y.prototype,"showGoMessage",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!0}}),f=y))||f));a._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_DeathScenarioScreen.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_Menu.ts","./DrMonkeyGameHandler.ts","./DrMonkey_GameState.ts","./DrMonkey_GameMessageType.ts","./DrMonkey_NetworkManager.ts","./DrMonkey_NetworkTypes.ts","./DrMonkey_Utils.ts"],(function(e){var n,t,o,i,r,a,u,c,s,l,h,y,p,f,g,b,m;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){r=e.cclegacy,a=e._decorator,u=e.Node,c=e.Label,s=e.Button},function(e){l=e.DrMonkeyMenu},function(e){h=e.DrMonkeyGameHandler,y=e.GameStateChangeEvent},function(e){p=e.DrMonkeyGameState},function(e){f=e.DrMonkeyGameMessageType},function(e){g=e.DrMonkeyNetworkManager},function(e){b=e.DrMonkeyNetworkEvents},function(e){m=e.DrMonkeyUtils}],execute:function(){var S,k,d,D,M,C,L,B,I,v,T,E,R,_,w;r._RF.push({},"bee9e8toI1Dy76M2uZwoUty","DrMonkey_DeathScenarioScreen",void 0);var z=a.ccclass,N=a.property,G="[DeathScenarioScreen]";e("DrMonkeyDeathScenarioScreen",(S=z("DrMonkeyDeathScenarioScreen"),k=N(u),d=N(u),D=N(c),M=N(c),C=N(s),L=N(s),S((v=n((I=function(e){function n(){for(var n,t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n=e.call.apply(e,[this].concat(r))||this,o(n,"myTurnRoot",v,i(n)),o(n,"otherTurnRoot",T,i(n)),o(n,"whoIsPickingLabel",E,i(n)),o(n,"scenarioLabel",R,i(n)),o(n,"randomizeButton",_,i(n)),o(n,"continueButton",w,i(n)),n}t(n,e);var r=n.prototype;return r.start=function(){this.registerEventListeners()},r.onEnable=function(){this.setupButtonListeners()},r.onDisable=function(){this.removeButtonListeners()},r.displayCurrentDeathScenario=function(){var e=h.Instance,n=e.getLocalPlayerNumber(),t=e.currentRoomState.isMyTurnInScenarioPicking(n);console.log(G+" Local player number: "+n+", Is my turn: "+t),this.updateTurnVisibility(t),this.updateScenarioLabel(),this.updateWhoIsPickingLabel()},r.updateScenarioLabel=function(){this.scenarioLabel.string=h.Instance.currentRoomState.deathScenario},r.refetchAnotherScenario=function(){console.log(G+" Requesting another scenario from server"),g.Instance.sendMessage(f.REFETCH_SCENARIO,{}),this.scenarioLabel.string="Getting new scenario..."},r.onContinueScenarioButtonClick=function(){console.log(G+" Continuing scenario"),g.Instance.sendMessage(f.CONTINUE_SCENARIO,{})},r.registerEventListeners=function(){y.on(b.GAME_STATE_CHANGE,this.onGameStateChange,this)},r.setupButtonListeners=function(){this.randomizeButton&&this.randomizeButton.node.on(s.EventType.CLICK,this.refetchAnotherScenario,this),this.continueButton&&this.continueButton.node.on(s.EventType.CLICK,this.onContinueScenarioButtonClick,this)},r.removeButtonListeners=function(){this.randomizeButton&&this.randomizeButton.node&&this.randomizeButton.node.off(s.EventType.CLICK,this.refetchAnotherScenario,this),this.continueButton&&this.continueButton.node&&this.continueButton.node.off(s.EventType.CLICK,this.onContinueScenarioButtonClick,this)},r.onGameStateChange=function(e){e===p.DEATH_SCENARIO&&this.displayCurrentDeathScenario()},r.updateTurnVisibility=function(e){this.myTurnRoot.active=e,this.otherTurnRoot.active=!e},r.updateWhoIsPickingLabel=function(){var e=h.Instance,n=e.currentRoomState.currentScenarioPickingPlayerNumber,t=e.currentRoomState.getPlayerByIndex(n);console.log(G+" Current picking player number: "+n),console.log(G+" Current picking player data:",t),this.whoIsPickingLabel.string=m.truncateName(t.name,50)+" is picking a scenario"},n}(l)).prototype,"myTurnRoot",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),T=n(I.prototype,"otherTurnRoot",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=n(I.prototype,"whoIsPickingLabel",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),R=n(I.prototype,"scenarioLabel",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=n(I.prototype,"randomizeButton",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=n(I.prototype,"continueButton",[L],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=I))||B));r._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_FitToScreen.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_CameraManger.ts"],(function(e){var t,i,n,r,o,a,s,c,u,l,p,d,h,f,g;return{setters:[function(e){t=e.applyDecoratedDescriptor,i=e.inheritsLoose,n=e.initializerDefineProperty,r=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,s=e.CCBoolean,c=e.CCFloat,u=e.director,l=e.Director,p=e.UITransform,d=e.screen,h=e.Widget,f=e.Component},function(e){g=e.DrMonkeyCameraManger}],execute:function(){var y,v,S,b,w,m,z,C,D,R,T;o._RF.push({},"b7133qOTDxJzq9m066wFCuW","DrMonkey_FitToScreen",void 0);var A=a.ccclass,W=a.property;e("DrMonkeyFitToScreen",(y=A("DrMonkeyFitToScreen"),v=W({type:s}),S=W({type:s}),b=W({visible:function(){return this.preserveAspectRatio}}),w=W({type:c}),y((C=t((z=function(e){function t(){for(var t,i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return t=e.call.apply(e,[this].concat(o))||this,n(t,"updateWidgetsRecursively",C,r(t)),n(t,"preserveAspectRatio",D,r(t)),n(t,"aspectRatio",R,r(t)),n(t,"extraScale",T,r(t)),t}i(t,e);var o=t.prototype;return o.onEnable=function(){var e=this;u.once(l.EVENT_AFTER_UPDATE,(function(){e.refresh()}))},o.setUiTransformToScreenSize=function(){var e=this.node.getComponent(p),t=g.instance.getCurrentOrthoHeight()/g.instance.defaultOrthoHeight,i=d.windowSize.width||window.innerWidth,n=d.windowSize.height||window.innerHeight,r=g.instance.designHeight*t,o=r*i/n;if(this.preserveAspectRatio)if(o/r>=this.aspectRatio){var a=r*this.aspectRatio;e.setContentSize(a,r)}else{var s=o/this.aspectRatio;e.setContentSize(o,s)}else e.setContentSize(o,r);1!=this.extraScale&&e.setContentSize(e.width*this.extraScale,e.height*this.extraScale)},o.refresh=function(){this.setUiTransformToScreenSize(),this.updateWidgetsRecursively&&this.updateWidgetsInHierarchy()},o.updateWidgetsInHierarchy=function(){this.updateWidgetAndDescendants(this.node)},o.updateWidgetAndDescendants=function(e){var t=this,i=e.getComponent(h);i&&this.node.uuid!=e.uuid&&i.updateAlignment(),e.children.forEach((function(e){t.updateWidgetAndDescendants(e)}))},t}(f)).prototype,"updateWidgetsRecursively",[v],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),D=t(z.prototype,"preserveAspectRatio",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),R=t(z.prototype,"aspectRatio",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),T=t(z.prototype,"extraScale",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),m=z))||m));o._RF.pop()}}}));

System.register("chunks:///_virtual/drmonkey_game",["./DrMonkey_NetworkConfig.ts","./DrMonkey_NetworkManager.ts","./DrMonkey_CameraManger.ts","./DrMonkey_FitToScreen.ts","./DrMonkey_MiloLayout.ts","./DrMonkey_PBLogger.ts","./DrMonkey_PbExtensions.ts","./DrMonkey_PbSaveSystem.ts","./DrMonkey_Utils.ts","./DrMonkey_BasePlayerData.ts","./DrMonkey_BaseRoomSettings.ts","./DrMonkey_BaseRoomState.ts","./DrMonkey_NetworkTypes.ts","./DrMonkey_PlayerTypes.ts","./DrMonkey_RoomTypes.ts","./DrMonkeyGameHandler.ts","./DrMonkey_AnimationAssets.ts","./DrMonkey_AudioManager.ts","./DrMonkey_LocalVideo.ts","./DrMonkey_Player.ts","./DrMonkey_Timer.ts","./DrMonkey_GameManager.ts","./DrMonkey_RoomState.ts","./DrMonkey_GameMessageType.ts","./DrMonkey_GameState.ts","./DrMonkey_AiJudgementScreen.ts","./DrMonkey_CountDownScreen.ts","./DrMonkey_DeathScenarioScreen.ts","./DrMonkey_GameOverScreen.ts","./DrMonkey_Menu.ts","./DrMonkey_PlayerAnswerScreen.ts","./DrMonkey_ResultsScreen.ts","./DrMonkey_ShowScenarioScreen.ts","./DrMonkey_StartRoundScreen.ts","./DrMonkey_UIManager.ts","./DrMonkey_WaitingScreen.ts"],(function(){return{setters:[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],execute:function(){}}}));

System.register("chunks:///_virtual/DrMonkey_GameManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_RoomState.ts","./DrMonkey_AudioManager.ts","./MiloGameSDK.ts","./DrMonkey_RoomTypes.ts","./DrMonkey_NetworkManager.ts","./DrMonkey_NetworkTypes.ts"],(function(e){var t,n,a,o,s,r,i,c,m,l,u,S,h,g,_;return{setters:[function(e){t=e.inheritsLoose,n=e.createClass},function(e){a=e.cclegacy,o=e._decorator,s=e.EventTarget,r=e.Component},function(e){i=e.DrMonkeyRoomState},function(e){c=e.DrMonkeyAudioManager},function(e){m=e.MiloGameSDK},function(e){l=e.DrMonkeyRoomStatus},function(e){u=e.ConnectionStateChangeEvent,S=e.ServerRoomStateChangeEvent,h=e.DrMonkeyNetworkManager},function(e){g=e.DrMonkeyNetworkEvents,_=e.DrMonkeyConnectionState}],execute:function(){var C,v;a._RF.push({},"753e07j7plHYY5hxI80wsa3","DrMonkey_GameManager",void 0);var M=o.ccclass,d=o.executionOrder,G=e("RoomStatusChangeEvent",new s);e("DrMonkeyGameManager",M("DrMonkeyGameManager")(C=d(-2)(((v=function(e){function a(){for(var t,n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(t=e.call.apply(e,[this].concat(a))||this)._roomStatus=l.NONE,t._won=!1,t._handledGameOverCallbacks=!1,t._serverStateCopy=null,t.miloGameSDK=new m,t._gameStartTime=0,t}t(a,e);var o=a.prototype;return o.onLoad=function(){a._instance&&this.node.destroy(),a._instance=this,this.initializeMiloGameSDK(),this.registerEvents()},o.onDestroy=function(){this.unregisterEvents(),a._instance===this&&(a._instance=null)},o.registerEvents=function(){u.on(g.CONNECTION_STATE_CHANGE,this.onConnectionStateChange,this),S.on(g.SERVER_ROOM_STATE_CHANGE,this.onServerRoomStateChange,this)},o.unregisterEvents=function(){u.off(g.CONNECTION_STATE_CHANGE,this.onConnectionStateChange,this),S.off(g.SERVER_ROOM_STATE_CHANGE,this.onServerRoomStateChange,this)},o.onConnectionStateChange=function(e,t){switch(t){case _.DISCONNECTED:this._roomStatus!==l.END_GAME&&h.Instance.reconnect();break;case _.KICKED_OUT:}},o.onServerRoomStateChange=function(e){this.log("ServerRoomStateChange Message: "+e.currentRoomStatus),this.log(!this._serverStateCopy),this._serverStateCopy||(this._serverStateCopy=new i,this._serverStateCopy.copyFrom(e)),e.currentRoomStatus===l.END_GAME&&(console.log("Game Over"),this.handleWon(e)),this.log("Setting room status to: ",e.currentRoomStatus),this.setRoomStatus(e.currentRoomStatus)},o.resetServerState=function(e){this._serverStateCopy||(this._serverStateCopy=new i),this._serverStateCopy.copyFrom(e)},o.handleWon=function(e){},o.setRoomStatus=function(e){if(this._roomStatus!==e){console.log("[GameManager] ==== Room Status Change ==== :",e);var t=this._roomStatus;this._roomStatus=e,this.OnRemoteGameStateChange(e),console.log("[GameManager] Emitting room status change event"),G.emit(g.ROOM_STATUS_CHANGE,t,e)}},o.GetMyPlayerData=function(){var e,t=h.Instance.CurrentRoom.sessionId;return null==(e=this._serverStateCopy)?void 0:e.playersData.find((function(e){return e.sessionId===t}))},o.GetWinnerPlayerData=function(){return null},o.OnRemoteGameStateChange=function(e){switch(console.log("RemoteGameStateChange Message: "+e),e){case l.NONE:case l.WAITING_FOR_PLAYERS:c.instance.playSound("Bgm");break;case l.COUNTDOWN:break;case l.GAME_SIMULATION:this._gameStartTime=Date.now();var t={timestamp:this._gameStartTime};this.miloGameSDK.gameStarted(t),console.log("[GameManager] Game started event sent to MiloGameSDK");break;case l.END_GAME:var n=Date.now()-this._gameStartTime,a={duration:n,hasWinningScreen:!1};this.miloGameSDK.gameEnded(a),console.log("[GameManager] Game ended event sent to MiloGameSDK with duration:",n),this.HandleGameOverCallbacks();break;default:console.warn("Unhandled room status: "+e)}},o.HandleGameOverCallbacks=function(){this._handledGameOverCallbacks?console.log("Already handled game over callbacks"):this._handledGameOverCallbacks=!0},o.initializeMiloGameSDK=function(){this.miloGameSDK.init({gameId:"dr-monkey",debug:!0});var e={timestamp:Date.now()};this.miloGameSDK.gameLoaded(e),console.log("[GameManager] Game loaded event sent to MiloGameSDK")},n(a,null,[{key:"Instance",get:function(){return this._instance}}]),a}(r))._instance=null,C=v))||C)||C);a._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_GameMessageType.ts",["cc"],(function(e){var n;return{setters:[function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"8e55c+9OhNGdYfoRpxMb3h0","DrMonkey_GameMessageType",void 0);e("DrMonkeyGameMessageType",function(e){return e.NONE="none",e.SET_STATE="set_state",e.PLAYER_ANSWER="player_answer",e.AI_JUDGEMENT="ai_judgement",e.SCENARIO_UPDATE="scenario_update",e.SUBMIT_SCENARIO="submit_scenario",e.REFETCH_SCENARIO="refetch_scenario",e.CONTINUE_SCENARIO="continue_scenario",e.FATE_HAS_BEEN_SEALED="fate_has_been_sealed",e}({}));n._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_GameOverScreen.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_Menu.ts"],(function(e){var r,n,o,t;return{setters:[function(e){r=e.inheritsLoose},function(e){n=e.cclegacy,o=e._decorator},function(e){t=e.DrMonkeyMenu}],execute:function(){var c;n._RF.push({},"d2dbbE0MKhJuJr/I0vX7bw8","DrMonkey_GameOverScreen",void 0);var u=o.ccclass;o.property,e("DrMonkeyGameOverScreen",u("DrMonkeyGameOverScreen")(c=function(e){function n(){return e.apply(this,arguments)||this}r(n,e);var o=n.prototype;return o.Open=function(){e.prototype.Open.call(this)},o.Close=function(){e.prototype.Close.call(this)},n}(t))||c);n._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_GameState.ts",["cc"],(function(E){var R;return{setters:[function(E){R=E.cclegacy}],execute:function(){R._RF.push({},"d1838dSarZOXr7fW6M9rXt2","DrMonkey_GameState",void 0);E("DrMonkeyGameState",function(E){return E[E.NONE=0]="NONE",E[E.WAITING_FOR_PLAYERS=1]="WAITING_FOR_PLAYERS",E[E.START_ROUND=2]="START_ROUND",E[E.DEATH_SCENARIO=3]="DEATH_SCENARIO",E[E.SHOW_SCENARIO=4]="SHOW_SCENARIO",E[E.PLAYER_ANSWERING=5]="PLAYER_ANSWERING",E[E.AI_JUDGEMENT=6]="AI_JUDGEMENT",E[E.ROUND_RESULTS=7]="ROUND_RESULTS",E[E.ROUND_END=8]="ROUND_END",E[E.GAME_OVER=9]="GAME_OVER",E}({}));R._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_LocalVideo.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var i,o,t,n,r,s,a,l,d;return{setters:[function(e){i=e.applyDecoratedDescriptor,o=e.inheritsLoose,t=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){r=e.cclegacy,s=e._decorator,a=e.VideoPlayer,l=e.Asset,d=e.Component}],execute:function(){var c,u,y,h,v,p,f;r._RF.push({},"65f32S5T7dHOJazpSKjLZDq","DrMonkey_LocalVideo",void 0);var P=s.ccclass,V=s.property;e("DrMonkeyLocalVideo",(c=P("DrMonkeyLocalVideo"),u=V({type:a}),y=V({type:l}),c((p=i((v=function(e){function i(){for(var i,o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return i=e.call.apply(e,[this].concat(r))||this,t(i,"videoPlayer",p,n(i)),t(i,"asset",f,n(i)),i.onVideoEndedCallback=null,i}o(i,e);var r=i.prototype;return r.start=function(){this.asset&&this.configureVideoSource(this.asset.nativeUrl)},r.onEnable=function(){this.setupEventListeners()},r.onDisable=function(){this.removeEventListeners(),this.onVideoEndedCallback=null},r.onDestroy=function(){this.removeEventListeners(),this.onVideoEndedCallback=null},r.setupEventListeners=function(){this.videoPlayer&&this.videoPlayer.node.on(a.EventType.COMPLETED,this.onVideoEnded,this)},r.removeEventListeners=function(){this.videoPlayer&&this.videoPlayer.node&&this.videoPlayer.node.off(a.EventType.COMPLETED,this.onVideoEnded,this)},r.setVideoPlayerLoop=function(e){this.videoPlayer&&(this.videoPlayer.loop=e)},r.onVideoEnded=function(){this.onVideoEndedCallback&&this.onVideoEndedCallback()},r.setVideoEndedCallback=function(e){this.onVideoEndedCallback=e},r.configureVideoSource=function(e){this.videoPlayer&&(this.stopVideo(),this.videoPlayer.remoteURL=e)},r.playVideo=function(){this.videoPlayer&&this.videoPlayer.play()},r.stopVideo=function(){this.videoPlayer&&this.videoPlayer.stop()},r.pauseVideo=function(){this.videoPlayer&&this.videoPlayer.pause()},r.resumeVideo=function(){this.videoPlayer&&this.videoPlayer.play()},r.isPlaying=function(){return!!this.videoPlayer&&this.videoPlayer.isPlaying},i}(d)).prototype,"videoPlayer",[u],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),f=i(v.prototype,"asset",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),h=v))||h));r._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_Menu.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_PBLogger.ts"],(function(e){var n,t,i,o,r,c,a,u,l,s;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){r=e.cclegacy,c=e._decorator,a=e.Node,u=e.CCString,l=e.Component},function(e){s=e.DrMonkeyPBLogger}],execute:function(){var p,y,f,h,d,g,M;r._RF.push({},"0ef79D3HT1Jq6fktUxy9N4k","DrMonkey_Menu",void 0);var D=c.ccclass,k=c.property;e("DrMonkeyMenu",(p=D("DrMonkeyMenu"),y=k({type:a}),f=k({type:u}),p((g=n((d=function(e){function n(){for(var n,t=arguments.length,r=new Array(t),c=0;c<t;c++)r[c]=arguments[c];return n=e.call.apply(e,[this].concat(r))||this,i(n,"content",g,o(n)),i(n,"menuName",M,o(n)),n.isOpened=!1,n}t(n,e);var r=n.prototype;return r.onLoad=function(){null==this.content&&(this.content=this.node.getChildByName("Content"))},r.Open=function(){this.content.active=!0,this.isOpened=!0},r.Close=function(){this.content.active=!1,this.isOpened=!1},r.initialize=function(){s.info("Menu initialize called")},n}(l)).prototype,"content",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=n(d.prototype,"menuName",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),h=d))||h));r._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_MiloLayout.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(t){var e,i,n,a,o,s,r,c,h,T,u,p,_;return{setters:[function(t){e=t.applyDecoratedDescriptor,i=t.inheritsLoose,n=t.initializerDefineProperty,a=t.assertThisInitialized,o=t.createClass},function(t){s=t.cclegacy,r=t._decorator,c=t.Enum,h=t.Size,T=t.Node,u=t.Vec3,p=t.UITransform,_=t.Component}],execute:function(){var l,d,E,g,y,f,O,C,R,L,m,v,N,I,H;s._RF.push({},"d65e7H1dZFOQ7NtJTrzsofD","DrMonkey_MiloLayout",void 0);var b=r.ccclass,A=r.property,M=t("MiloLayoutType",function(t){return t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL",t[t.GRID=2]="GRID",t}({})),w=t("MiloLayoutAlign",function(t){return t[t.LEFT_TOP=0]="LEFT_TOP",t[t.CENTER_TOP=1]="CENTER_TOP",t[t.RIGHT_TOP=2]="RIGHT_TOP",t[t.LEFT_CENTER=3]="LEFT_CENTER",t[t.CENTER=4]="CENTER",t[t.RIGHT_CENTER=5]="RIGHT_CENTER",t[t.LEFT_BOTTOM=6]="LEFT_BOTTOM",t[t.CENTER_BOTTOM=7]="CENTER_BOTTOM",t[t.RIGHT_BOTTOM=8]="RIGHT_BOTTOM",t}({}));t("DrMonkeyMiloLayout",(l=b("DrMonkeyMiloLayout"),d=A({type:c(M)}),E=A({type:c(M)}),g=A({type:c(w)}),y=A({type:c(w)}),f=A({visible:function(){return this._layoutType===M.GRID}}),l((R=e((C=function(t){function e(){for(var e,i=arguments.length,o=new Array(i),s=0;s<i;s++)o[s]=arguments[s];return e=t.call.apply(t,[this].concat(o))||this,n(e,"_layoutType",R,a(e)),n(e,"_alignment",L,a(e)),n(e,"_spacingX",m,a(e)),n(e,"_spacingY",v,a(e)),n(e,"_columns",N,a(e)),n(e,"_padding",I,a(e)),n(e,"_autoResize",H,a(e)),e._activeChildCount=0,e._layoutSize=new h(0,0),e._lastChildActiveState=[],e}i(e,t);var s=e.prototype;return s.onLoad=function(){this.node.on(T.EventType.CHILD_ADDED,this.onChildAdded,this),this.node.on(T.EventType.CHILD_REMOVED,this.onChildRemoved,this)},s.onDestroy=function(){this.node.off(T.EventType.CHILD_ADDED,this.onChildAdded,this),this.node.off(T.EventType.CHILD_REMOVED,this.onChildRemoved,this),this.removeAllChildListeners()},s.onChildRemoved=function(t){this.removeChildListener(t),this.updateLayout()},s.removeAllChildListeners=function(){var t=this;this.node.children.forEach((function(e){t.removeChildListener(e)}))},s.removeChildListener=function(t){t.__miloLayoutActiveHandler&&(t.off(T.EventType.ACTIVE_IN_HIERARCHY_CHANGED,t.__miloLayoutActiveHandler),t.__miloLayoutActiveHandler=null)},s.start=function(){this._lastChildActiveState=this.node.children.map((function(t){return t.active})),this.updateLayout(),this.addChildActiveListeners()},s.addChildActiveListeners=function(){var t=this;this.node.children.forEach((function(e){t.addChildActiveListener(e)}))},s.addChildActiveListener=function(t){var e=this;t.off(T.EventType.ACTIVE_IN_HIERARCHY_CHANGED,this.onChildActiveChanged,this);var i=function(){e.scheduleOnce((function(){e.updateLayout()}),0)};t.__miloLayoutActiveHandler=i,t.on(T.EventType.ACTIVE_IN_HIERARCHY_CHANGED,i)},s.onChildActiveChanged=function(t){},s.onEnable=function(){this.updateLayout()},s.getAlignmentOffset=function(t){var e,i=new u,n=(null==(e=this.node.getComponent(p))?void 0:e.contentSize)||new h(0,0);switch(this._alignment){case w.LEFT_TOP:case w.LEFT_CENTER:case w.LEFT_BOTTOM:i.x=this._padding;break;case w.CENTER_TOP:case w.CENTER:case w.CENTER_BOTTOM:i.x=(n.width-t.width)/2;break;case w.RIGHT_TOP:case w.RIGHT_CENTER:case w.RIGHT_BOTTOM:i.x=n.width-t.width-this._padding}switch(this._alignment){case w.LEFT_TOP:case w.CENTER_TOP:case w.RIGHT_TOP:i.y=-this._padding;break;case w.LEFT_CENTER:case w.CENTER:case w.RIGHT_CENTER:i.y=-(n.height-t.height)/2;break;case w.LEFT_BOTTOM:case w.CENTER_BOTTOM:case w.RIGHT_BOTTOM:i.y=-n.height+t.height+this._padding}return i},s.updateLayout=function(){if(this.node){var t=this.node.children.filter((function(t){return t.active}));if(this._activeChildCount=t.length,0!==this._activeChildCount)switch(this._layoutType){case M.HORIZONTAL:this.updateHorizontalLayout(t);break;case M.VERTICAL:this.updateVerticalLayout(t);break;case M.GRID:this.updateGridLayout(t)}}},s.updateHorizontalLayout=function(t){var e=this,i=2*this._padding,n=0;t.forEach((function(a,o){var s=a.getComponent(p);s&&(i+=s.width,o<t.length-1&&(i+=e._spacingX),n=Math.max(n,s.height))}));var a=new h(i,n+2*this._padding),o=this.getAlignmentOffset(a),s=o.x;if(t.forEach((function(t){var i=t.getComponent(p);if(i){var a=i.height,r=i.width,c=o.y;switch(e._alignment){case w.LEFT_TOP:case w.CENTER_TOP:case w.RIGHT_TOP:c=o.y-e._padding;break;case w.LEFT_CENTER:case w.CENTER:case w.RIGHT_CENTER:c=o.y-(n-a)/2;break;case w.LEFT_BOTTOM:case w.CENTER_BOTTOM:case w.RIGHT_BOTTOM:c=o.y-n+a}t.position=new u(s+r/2,c-a/2,0),s+=r+e._spacingX}})),this._layoutSize=a,this._autoResize){var r=this.node.getComponent(p);r&&r.setContentSize(a)}},s.updateVerticalLayout=function(t){var e=this,i=2*this._padding,n=0;t.forEach((function(a,o){var s=a.getComponent(p);s&&(i+=s.height,o<t.length-1&&(i+=e._spacingY),n=Math.max(n,s.width))}));var a=new h(n+2*this._padding,i),o=this.getAlignmentOffset(a),s=o.y;if(t.forEach((function(t){var i=t.getComponent(p);if(i){var a=i.height,r=i.width,c=o.x;switch(e._alignment){case w.LEFT_TOP:case w.LEFT_CENTER:case w.LEFT_BOTTOM:c=o.x+e._padding;break;case w.CENTER_TOP:case w.CENTER:case w.CENTER_BOTTOM:c=o.x+(n-r)/2+e._padding;break;case w.RIGHT_TOP:case w.RIGHT_CENTER:case w.RIGHT_BOTTOM:c=o.x+n-r+e._padding}t.position=new u(c+r/2,s-a/2,0),s-=a+e._spacingY}})),this._layoutSize=a,this._autoResize){var r=this.node.getComponent(p);r&&r.setContentSize(a)}},s.updateGridLayout=function(t){if(!(this._columns<=0)){var e=Math.ceil(t.length/this._columns),i=0,n=0;t.forEach((function(t){var e=t.getComponent(p);e&&(i=Math.max(i,e.width),n=Math.max(n,e.height))}));for(var a=2*this._padding+i*this._columns+this._spacingX*(this._columns-1),o=2*this._padding+n*e+this._spacingY*(e-1),s=new h(a,o),r=this.getAlignmentOffset(s),c=0;c<e;c++){var T=Math.min(this._columns,t.length-c*this._columns),_=T*i+(T-1)*this._spacingX,l=0;switch(this._alignment){case w.CENTER_TOP:case w.CENTER:case w.CENTER_BOTTOM:l=(this._columns*i+(this._columns-1)*this._spacingX-_)/2;break;case w.RIGHT_TOP:case w.RIGHT_CENTER:case w.RIGHT_BOTTOM:l=this._columns*i+(this._columns-1)*this._spacingX-_}for(var d=0;d<T;d++){var E=c*this._columns+d;if(E>=t.length)break;var g=t[E],y=g.getComponent(p);if(y){var f=y.width,O=y.height,C=r.x+this._padding+d*(i+this._spacingX)+l,R=r.y-this._padding-c*(n+this._spacingY),L=C,m=R;switch(this._alignment){case w.LEFT_TOP:case w.LEFT_CENTER:case w.LEFT_BOTTOM:L=C;break;case w.CENTER_TOP:case w.CENTER:case w.CENTER_BOTTOM:L=C+(i-f)/2;break;case w.RIGHT_TOP:case w.RIGHT_CENTER:case w.RIGHT_BOTTOM:L=C+i-f}switch(this._alignment){case w.LEFT_TOP:case w.CENTER_TOP:case w.RIGHT_TOP:m=R;break;case w.LEFT_CENTER:case w.CENTER:case w.RIGHT_CENTER:m=R-(n-O)/2;break;case w.LEFT_BOTTOM:case w.CENTER_BOTTOM:case w.RIGHT_BOTTOM:m=R-n+O}g.position=new u(L+f/2,m-O/2,0)}}}if(this._layoutSize=s,this._autoResize){var v=this.node.getComponent(p);v&&v.setContentSize(s)}}},s.update=function(t){if(this.node&&this.node.children.length>0){var e=this.node.children.map((function(t){return t.active})),i=!1;if(this._lastChildActiveState.length!==e.length)i=!0;else for(var n=0;n<e.length;n++)if(this._lastChildActiveState[n]!==e[n]){i=!0;break}i&&(this._lastChildActiveState=e,this.updateLayout())}},s.onChildAdded=function(t){this.addChildActiveListener(t),this.updateLayout()},o(e,[{key:"layoutType",get:function(){return this._layoutType},set:function(t){this._layoutType=t,this.updateLayout()}},{key:"alignment",get:function(){return this._alignment},set:function(t){this._alignment=t,this.updateLayout()}},{key:"spacingX",get:function(){return this._spacingX},set:function(t){this._spacingX=t,this.updateLayout()}},{key:"spacingY",get:function(){return this._spacingY},set:function(t){this._spacingY=t,this.updateLayout()}},{key:"columns",get:function(){return this._columns},set:function(t){this._columns=t,this.updateLayout()}},{key:"padding",get:function(){return this._padding},set:function(t){this._padding=t,this.updateLayout()}},{key:"autoResize",get:function(){return this._autoResize},set:function(t){this._autoResize=t,this.updateLayout()}}]),e}(_)).prototype,"_layoutType",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return M.HORIZONTAL}}),e(C.prototype,"layoutType",[E],Object.getOwnPropertyDescriptor(C.prototype,"layoutType"),C.prototype),L=e(C.prototype,"_alignment",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return w.LEFT_TOP}}),e(C.prototype,"alignment",[y],Object.getOwnPropertyDescriptor(C.prototype,"alignment"),C.prototype),m=e(C.prototype,"_spacingX",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),e(C.prototype,"spacingX",[A],Object.getOwnPropertyDescriptor(C.prototype,"spacingX"),C.prototype),v=e(C.prototype,"_spacingY",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),e(C.prototype,"spacingY",[A],Object.getOwnPropertyDescriptor(C.prototype,"spacingY"),C.prototype),N=e(C.prototype,"_columns",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),e(C.prototype,"columns",[f],Object.getOwnPropertyDescriptor(C.prototype,"columns"),C.prototype),I=e(C.prototype,"_padding",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),e(C.prototype,"padding",[A],Object.getOwnPropertyDescriptor(C.prototype,"padding"),C.prototype),H=e(C.prototype,"_autoResize",[A],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),e(C.prototype,"autoResize",[A],Object.getOwnPropertyDescriptor(C.prototype,"autoResize"),C.prototype),O=C))||O));s._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_NetworkConfig.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_PBLogger.ts"],(function(e){var r,t,o,i,n,a,s,u,l;return{setters:[function(e){r=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){n=e.cclegacy,a=e._decorator,s=e.sys,u=e.Component},function(e){l=e.DrMonkeyPBLogger}],execute:function(){var c,f,p,g,m,d,h,y,b,v,P,S,I,w,C;n._RF.push({},"80cbbK8AJ5NPZgppY66OGie","DrMonkey_NetworkConfig",void 0);var N=a.ccclass,L=a.property;e("DrMonkeyNetworkConfig",(c=N("DrMonkeyNetworkConfig"),f=L({tooltip:"Server host address"}),p=L({tooltip:"Server port number"}),g=L({tooltip:"Use SSL for connections"}),m=L({tooltip:"Player identifier"}),d=L({tooltip:"Room identifier"}),h=L({tooltip:"Name of the game"}),c((v=r((b=function(e){function r(){for(var r,t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return r=e.call.apply(e,[this].concat(n))||this,o(r,"serverHost",v,i(r)),o(r,"serverPort",P,i(r)),o(r,"useSSL",S,i(r)),o(r,"userId",I,i(r)),o(r,"roomId",w,i(r)),o(r,"gameName",C,i(r)),r}t(r,e);var n=r.prototype;return n.initNetworkConfig=function(){if(s.isBrowser){var e=new URLSearchParams(window.location.search),r="true"===e.get("debug");l.debug("Initializing network config (debug="+r+")"),r?this.parseQueryParams(e):this.parseInjectedConfig(),l.debug("Final network config:",{serverHost:this.serverHost,serverPort:this.serverPort,useSSL:this.useSSL,userId:this.userId,roomId:this.roomId,gameName:this.gameName})}},n.parseQueryParams=function(e){var r=this;l.debug("Parsing config from query parameters"),this.updateConfigFromQueryParam(e,"userId",(function(e){return r.userId=e})),this.updateConfigFromQueryParam(e,"roomId",(function(e){return r.roomId=e})),this.updateConfigFromQueryParam(e,"apiUrl",(function(e){return r.serverHost=e})),this.updateConfigFromQueryParam(e,"apiPort",(function(e){var t=parseInt(e);isNaN(t)||(r.serverPort=t)})),this.updateConfigFromQueryParam(e,"useSSL",(function(e){return r.useSSL="true"===e}))},n.parseInjectedConfig=function(){l.debug("Parsing config from injected GameConfig");try{var e=window.GameConfig;if(!e)return void l.debug("No injected GameConfig found");var r="string"==typeof e?JSON.parse(e):e;this.applyConfig(r)}catch(e){l.debug("Failed to parse injected GameConfig:",e)}},n.applyConfig=function(e){var r,t,o,i,n;e&&(this.userId=null!=(r=e.userId)?r:this.userId,this.roomId=null!=(t=e.roomId)?t:this.roomId,this.serverHost=null!=(o=e.apiUrl)?o:this.serverHost,this.serverPort=Number(null!=(i=e.apiPort)?i:this.serverPort),this.useSSL=null!=(n=e.useSSL)?n:this.useSSL)},n.updateConfigFromQueryParam=function(e,r,t){var o=e.get(r);null!=o&&t(o)},r}(u)).prototype,"serverHost",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"localhost"}}),P=r(b.prototype,"serverPort",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2567}}),S=r(b.prototype,"useSSL",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),I=r(b.prototype,"userId",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),w=r(b.prototype,"roomId",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"testroom1"}}),C=r(b.prototype,"gameName",[h],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Pictionary"}}),y=b))||y));n._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_NetworkManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./colyseus.mjs_cjs=&original=.js","./DrMonkey_NetworkTypes.ts","./DrMonkey_PlayerTypes.ts","./DrMonkey_PbSaveSystem.ts","./DrMonkey_NetworkConfig.ts","./DrMonkey_PBLogger.ts","./colyseus.js"],(function(n){var t,e,o,i,r,a,s,c,h,u,l,f,g,m,d,p,C,v,_,k,y;return{setters:[function(n){t=n.applyDecoratedDescriptor,e=n.inheritsLoose,o=n.initializerDefineProperty,i=n.assertThisInitialized,r=n.extends,a=n.createClass,s=n.asyncToGenerator,c=n.regeneratorRuntime},function(n){h=n.cclegacy,u=n._decorator,l=n.EventTarget,f=n.CCBoolean,g=n.Component},null,function(n){m=n.DrMonkeyConnectionState,d=n.DrMonkeyNetworkEvents,p=n.DrMonkeyServerMessageType},function(n){C=n.DrMonkeyPlayerType},function(n){v=n.DrMonkeyPbSaveSystem},function(n){_=n.DrMonkeyNetworkConfig},function(n){k=n.DrMonkeyPBLogger},function(n){y=n.default}],execute:function(){var w,D,S,N,E,R,I,M;h._RF.push({},"837a9Fz1TtFDqKc2CMnXFBH","DrMonkey_NetworkManager",void 0);var T=u.ccclass,b=u.property,x={roomId:"testroom1",reconnectionToken:"eyJ"},O=n("ConnectionStateChangeEvent",new l),P=n("ServerRoomStateChangeEvent",new l),z=n("ServerMessageEvent",new l);n("DrMonkeyNetworkManager",(w=T("DrMonkeyNetworkManager"),D=b({type:f,tooltip:"Enable development mode for additional logging"}),S=b({type:_,tooltip:"Network configuration settings"}),w(((M=function(n){function t(){for(var t,e=arguments.length,a=new Array(e),s=0;s<e;s++)a[s]=arguments[s];return t=n.call.apply(n,[this].concat(a))||this,o(t,"isDevMode",R,i(t)),o(t,"networkConfig",I,i(t)),t._client=void 0,t._room=void 0,t._currentConnectionState=m.INITIALIZING,t._reconnectionData=r({},x),t}e(t,n);var h=t.prototype;return h.onLoad=function(){t._instance&&(this.log("NetworkManager instance already exists. Destroying duplicate."),this.node.destroy()),t._instance=this,this.networkConfig.initNetworkConfig(),this.isDevMode||k.setProductionMode(!0)},h.start=function(){this.initializeClient(),k.info("============ Initializing client ========="),k.info("============ Connecting to room ========="),this.connect(this.networkConfig.roomId,this.networkConfig.userId)},h.onDestroy=function(){this.cleanup()},h.cleanup=function(){this._room&&(this.leaveRoom(),this._room=null),this._client&&(this._client=null),this._currentConnectionState=m.INITIALIZING,this._reconnectionData=r({},x),t._instance===this&&(t._instance=null)},h.initializeClient=function(){var n=this.networkConfig.useSSL?"wss":"ws",t="";t=0==this.networkConfig.serverPort?n+"://"+this.networkConfig.serverHost:n+"://"+this.networkConfig.serverHost+":"+this.networkConfig.serverPort,this.log("Initializing client with endpoint: "+t),this._client=new y.Client(t)},h.shouldRejoin=function(){return!this.isDevMode&&(this._reconnectionData=v.LoadData(this.networkConfig.gameName),!!(this._reconnectionData&&this._reconnectionData.roomId&&this._reconnectionData.reconnectionToken)&&this._reconnectionData.roomId===this.networkConfig.roomId)},h.connect=function(){var n=s(c().mark((function n(t,e){var o;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(k.info("============ Connecting to room from connect function ========="),this.updateConnectionState(m.CONNECTING),!this.shouldRejoin()){n.next=7;break}return this.log("Rejoining room",t),n.next=6,this.rejoin();case 6:return n.abrupt("return");case 7:return n.prev=7,o=this.createPlayerData(e),this.log("Joining with options ",{player:o}),n.next=12,this._client.joinById(t,{player:o});case 12:this._room=n.sent,this.initAfterJoin(t),n.next=20;break;case 16:throw n.prev=16,n.t0=n.catch(7),this.handleConnectionError(n.t0),n.t0;case 20:case"end":return n.stop()}}),n,this,[[7,16]])})));return function(t,e){return n.apply(this,arguments)}}(),h.initAfterJoin=function(n){this.updateConnectionState(m.JOINED_ROOM),this.log("Joined room "+n+" with sessionId: "+this._room.sessionId),this.initializeRoomCallbacks(),this.saveReconnectionData()},h.createAndJoinRoom=function(){var n=s(c().mark((function n(t,e){var o;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.log("Creating room",t),this.updateConnectionState(m.CONNECTING),n.prev=2,o=this.createPlayerData(e),n.next=6,this._client.create("PictionaryRoom",{roomId:t,player:o,roomSettings:{maxClients:10}});case 6:this._room=n.sent,this.initAfterJoin(t),n.next=14;break;case 10:throw n.prev=10,n.t0=n.catch(2),this.handleConnectionError(n.t0),n.t0;case 14:case"end":return n.stop()}}),n,this,[[2,10]])})));return function(t,e){return n.apply(this,arguments)}}(),h.createPlayerData=function(n){return{userId:n,name:n,avatar:"randomProfilePicture",type:C.HUMAN}},h.initializeRoomCallbacks=function(){var n=this;console.log("============ Initializing room callbacks ========="),this._room?(this._room.onStateChange((function(n){P.emit(d.SERVER_ROOM_STATE_CHANGE,n)})),this._room.onLeave((function(t){4001===t?n.updateConnectionState(m.KICKED_OUT):n.updateConnectionState(m.DISCONNECTED)})),this._room.onMessage(p.KICKED_OUT,(function(){n.updateConnectionState(m.KICKED_OUT)})),this._room.onMessage("*",(function(n,t){z.emit(d.SERVER_MESSAGE,n,t)}))):this.log("Cannot initialize callbacks: Room is not defined")},h.updateConnectionState=function(n){if(this._currentConnectionState!==n){var t=this._currentConnectionState;this._currentConnectionState=n,this.log("Connection state changed: "+m[t]+" -> "+m[n]),O.emit(d.CONNECTION_STATE_CHANGE,t,n)}},h.reconnect=function(){var n=s(c().mark((function n(t,e,o){var i,r;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(void 0===t&&(t=1),void 0===e&&(e=10),void 0===o&&(o=2e3),this._currentConnectionState===m.DISCONNECTED||this._currentConnectionState===m.RECONNECTING){n.next=6;break}return this.log("Cannot reconnect: Current state is "+m[this._currentConnectionState]),n.abrupt("return");case 6:return this._room&&this._room.state&&(i=this._room.state).roomSettings&&i.roomSettings.maxReconnectionAttempts&&(e=i.roomSettings.maxReconnectionAttempts),this.updateConnectionState(m.RECONNECTING),this.log("Reconnect attempt "+t+"/"+e),n.prev=9,n.next=12,this.delay(o);case 12:if(this._room&&this._room.reconnectionToken){n.next=14;break}throw new Error("Reconnection token not available");case 14:return n.next=16,this._client.reconnect(this._room.reconnectionToken);case 16:r=n.sent,this._room=r,this.saveReconnectionData(),this.initializeRoomCallbacks(),this.updateConnectionState(m.JOINED_ROOM),this.log("Reconnected successfully."),n.next=27;break;case 24:n.prev=24,n.t0=n.catch(9),this.handleReconnectionError(n.t0,t,e,o);case 27:case"end":return n.stop()}}),n,this,[[9,24]])})));return function(t,e,o){return n.apply(this,arguments)}}(),h.rejoin=function(){var n=s(c().mark((function n(t,e,o){var i,r;return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return void 0===t&&(t=1),void 0===e&&(e=10),void 0===o&&(o=2e3),this.log("Rejoin attempt "+t+"/"+e),n.prev=4,n.next=7,this.delay(o);case 7:if(this._reconnectionData&&this._reconnectionData.reconnectionToken){n.next=9;break}throw new Error("Reconnection data not available");case 9:return i=this._reconnectionData.roomId+":"+this._reconnectionData.reconnectionToken,k.info("Using formatted reconnection token: ",i),n.next=13,this._client.reconnect(i);case 13:r=n.sent,this._room=r,this.saveReconnectionData(),this.initializeRoomCallbacks(),this.updateConnectionState(m.JOINED_ROOM),this.log("Rejoined successfully."),n.next=24;break;case 21:n.prev=21,n.t0=n.catch(4),this.handleReconnectionError(n.t0,t,e,o,"reJoin");case 24:case"end":return n.stop()}}),n,this,[[4,21]])})));return function(t,e,o){return n.apply(this,arguments)}}(),h.delay=function(){var n=s(c().mark((function n(t){return c().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",new Promise((function(n){return setTimeout(n,t)})));case 1:case"end":return n.stop()}}),n)})));return function(t){return n.apply(this,arguments)}}(),h.handleConnectionError=function(n){var t=(null==n?void 0:n.message)||"Unknown error";this.log("Error connecting to room:",t),this.updateConnectionState(m.DISCONNECTED)},h.handleReconnectionError=function(n,t,e,o,i){void 0===i&&(i="reconnect");var r=(null==n?void 0:n.message)||"Unknown error";this.log(i+" attempt "+t+" failed:",r),t<e||-1===e?"reconnect"===i?this.reconnect(t+1,e,o):this.rejoin(t+1,e,o):(this.log("Max reconnection attempts reached. Please check your network or contact support."),this.updateConnectionState(m.DISCONNECTED))},h.saveReconnectionData=function(){if(k.info("============ Saving reconnection data ========="),this._room&&this._room.reconnectionToken){var n=this._room.reconnectionToken;n.includes(":")&&(n=n.split(":")[1]),k.info("saving Reconnection token: ",n),this._reconnectionData={roomId:this.networkConfig.roomId,reconnectionToken:n},v.SaveData(this.networkConfig.gameName,this._reconnectionData),k.info("Reconnection data saved")}else this.log("Cannot save reconnection data: Room or reconnection token not available")},h.leaveRoom=function(){var n=this;this._room?(this.log("Leaving room"),this._room.leave(!0).then((function(){return n.log("Left room successfully")})).catch((function(t){return n.log("Error leaving room:",(null==t?void 0:t.message)||"Unknown error")}))):this.log("Cannot leave room: Room is not defined")},h.getMySessionId=function(){return this._room.sessionId},h.sendMessage=function(n,t){this._room?(this.isDevMode&&this.log("Sending message:",n,t),this._room.send(n,t)):this.log("Cannot send message: Room is not defined")},h.log=function(n){if(this.isDevMode){for(var t=arguments.length,e=new Array(t>1?t-1:0),o=1;o<t;o++)e[o-1]=arguments[o];e.length>0?k.info.apply(k,["[NetworkManager] "+n].concat(e)):k.info("[NetworkManager] "+n)}},a(t,[{key:"CurrentRoom",get:function(){return this._room}},{key:"CurrentConnectionState",get:function(){return this._currentConnectionState}}],[{key:"Instance",get:function(){if(!this._instance)throw new Error("NetworkManager instance is not initialized.");return this._instance}}]),t}(g))._instance=null,R=t((E=M).prototype,"isDevMode",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),I=t(E.prototype,"networkConfig",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),N=E))||N));h._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_NetworkTypes.ts",["cc"],(function(E){var N;return{setters:[function(E){N=E.cclegacy}],execute:function(){N._RF.push({},"8f10e5P7RBLvY4KTVlDifSk","DrMonkey_NetworkTypes",void 0);E("DrMonkeyNetworkEvents",function(E){return E[E.SERVER_ROOM_STATE_CHANGE=0]="SERVER_ROOM_STATE_CHANGE",E[E.CONNECTION_STATE_CHANGE=1]="CONNECTION_STATE_CHANGE",E[E.ROOM_STATUS_CHANGE=2]="ROOM_STATUS_CHANGE",E[E.GAME_STATE_CHANGE=3]="GAME_STATE_CHANGE",E[E.SERVER_MESSAGE=4]="SERVER_MESSAGE",E}({})),E("DrMonkeyConnectionState",function(E){return E[E.INITIALIZING=0]="INITIALIZING",E[E.CONNECTING=1]="CONNECTING",E[E.CONNECTED=2]="CONNECTED",E[E.LOBBY=3]="LOBBY",E[E.JOINED_ROOM=4]="JOINED_ROOM",E[E.DISCONNECTED=5]="DISCONNECTED",E[E.RECONNECTING=6]="RECONNECTING",E[E.KICKED_OUT=7]="KICKED_OUT",E}({})),E("DrMonkeyServerMessageType",function(E){return E.NONE="none",E.KICKED_OUT="kicked_out",E.PLAYER_CAMEBACK="player_cameback",E.PLAYER_JOINED="player_joined",E}({}));N._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_PbExtensions.ts",["cc","./DrMonkey_PBLogger.ts"],(function(){var t,n,e,o;return{setters:[function(o){t=o.cclegacy,n=o.Vec3,e=o.Component},function(t){o=t.DrMonkeyPBLogger}],execute:function(){t._RF.push({},"c8e9c8xjURGFraN6OiA8+OF","DrMonkey_PbExtensions",void 0),n.prototype.clampMagnitude=function(t,n){if(!(t>n)){var e=this.length();return e>n?(this.normalize(),this.multiplyScalar(n)):e<t&&(this.normalize(),this.multiplyScalar(t)),this}console.error("min should be less than max")},e.prototype.log=function(){for(var t=this.constructor.name,n=arguments.length,e=new Array(n),r=0;r<n;r++)e[r]=arguments[r];o.info.apply(o,[t+" "].concat(e))},t._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_PBLogger.ts",["cc"],(function(e){var r;return{setters:[function(e){r=e.cclegacy}],execute:function(){r._RF.push({},"d5bed5yJ51Hg7PKbEO3HZp5","DrMonkey_PBLogger",void 0);var n=e("LogLevel",function(e){return e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e}({})),o=e("DrMonkeyPBLogger",function(){function e(){}return e.debug=function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),t=1;t<r;t++)o[t-1]=arguments[t];this.log(n.Debug,e,o)},e.info=function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),t=1;t<r;t++)o[t-1]=arguments[t];this.log(n.Info,e,o)},e.warning=function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),t=1;t<r;t++)o[t-1]=arguments[t];this.log(n.Warning,e,o)},e.error=function(e){for(var r=arguments.length,o=new Array(r>1?r-1:0),t=1;t<r;t++)o[t-1]=arguments[t];this.log(n.Error,e,o)},e.log=function(e,r,o){if(e>=this.currentLevel){var t,i=n[e]+": "+r;if((t=console).log.apply(t,[i].concat(o)),this.isProduction&&window.ReactNativeWebView)try{var c={type:"log",level:n[e],message:i,params:o};window.ReactNativeWebView.postMessage(JSON.stringify(c))}catch(e){console.error("Failed to send log to ReactNativeWebView:",e)}}},e.setLevel=function(e){this.currentLevel=e},e.setProductionMode=function(e){this.isProduction=e},e}());o.currentLevel=n.Debug,o.isProduction=!1,r._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_PbSaveSystem.ts",["cc","./DrMonkey_PBLogger.ts"],(function(e){var t,a,n,o;return{setters:[function(e){t=e.cclegacy,a=e._decorator,n=e.sys},function(e){o=e.DrMonkeyPBLogger}],execute:function(){var r;t._RF.push({},"4909fUlx45MObum/rmfzcxr","DrMonkey_PbSaveSystem",void 0);var c=a.ccclass;e("DrMonkeyPbSaveSystem",c("DrMonkeyPbSaveSystem")(r=function(){function e(){}return e.SaveData=function(e,t){o.info("============ Saving data in pb save system ========="),n.localStorage.setItem(e,JSON.stringify(t))},e.LoadData=function(e){return JSON.parse(n.localStorage.getItem(e))},e.RemoveData=function(e){n.localStorage.removeItem(e)},e.ClearAllData=function(){n.localStorage.clear()},e}())||r);t._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_Player.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_GameState.ts","./DrMonkey_Utils.ts","./DrMonkey_NetworkManager.ts"],(function(e){var r,t,i,n,o,a,l,s,c,p,f,u,y,d,h,I,g;return{setters:[function(e){r=e.applyDecoratedDescriptor,t=e.inheritsLoose,i=e.initializerDefineProperty,n=e.assertThisInitialized},function(e){o=e.cclegacy,a=e._decorator,l=e.CCInteger,s=e.Label,c=e.Sprite,p=e.Node,f=e.assetManager,u=e.Texture2D,y=e.SpriteFrame,d=e.Component},function(e){h=e.DrMonkeyGameState},function(e){I=e.DrMonkeyUtils},function(e){g=e.DrMonkeyNetworkManager}],execute:function(){var m,P,S,N,E,v,D,x,L;o._RF.push({},"672fe3UAndCvoSI908p/UHF","DrMonkey_Player",void 0);var R=a.ccclass,b=a.property,k=e("PlayerState",function(e){return e[e.IDLE=0]="IDLE",e[e.PICKING_SCENARIO=1]="PICKING_SCENARIO",e[e.ANSWERING=2]="ANSWERING",e[e.JUDGING=3]="JUDGING",e}({}));e("DrMonkeyPlayer",(m=R("DrMonkeyPlayer"),P=b({type:l,tooltip:"Player's index in the game"}),S=b({type:s,tooltip:"Label to display player's name"}),N=b({type:c,tooltip:"Sprite for player's profile image"}),m((D=r((v=function(e){function r(){for(var r,t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return(r=e.call.apply(e,[this].concat(o))||this).userId="",r.playerName="",i(r,"index",D,n(r)),i(r,"nameLabel",x,n(r)),i(r,"profileImage",L,n(r)),r.playerState=k.IDLE,r.isLocal=!1,r.isProfileInitialized=!1,r.profileImageUrl="",r}t(r,e);var o=r.prototype;return o.onDisable=function(){this.removeEventListeners()},o.initialize=function(e,r){if(e){console.log("Initializing Player: "+r),this.index=r;var t=e.getPlayerByIndex(this.index);t?(this.userId=t.userId,this.playerName=t.name,this.loadProfile(t),this.checkIfLocalPlayer(t),this.updatePlayerState(e)):console.error("[Player] No profile data found for player index "+this.index)}else console.error("[Player] Failed to initialize: Invalid room state")},o.checkIfLocalPlayer=function(e){this.isLocal=e.sessionId===g.Instance.CurrentRoom.sessionId},o.resetState=function(){this.playerState=k.IDLE},o.loadProfile=function(e){!this.isProfileInitialized&&e&&(this.nameLabel.string=I.truncateName(e.name,12),this.profileImageUrl=e.avatar,this.loadProfileImage(),this.addEventListeners(),this.isProfileInitialized=!0)},o.addEventListeners=function(){this.profileImage&&this.profileImage.node&&this.profileImage.node.on(p.EventType.TOUCH_START,this.openProfile,this)},o.removeEventListeners=function(){this.profileImage&&this.profileImage.node&&this.profileImage.node.off(p.EventType.TOUCH_START,this.openProfile,this)},o.loadProfileImage=function(){var e=this;if(this.profileImageUrl){var r=f.assets.get(this.profileImageUrl);r?this.applyProfileTexture(r):f.loadRemote(this.profileImageUrl,{ext:".png"},(function(r,t){if(r)console.error("[Player] Failed to load profile image: "+r);else try{var i=new u;i.image=t,e.applyProfileTexture(i)}catch(e){console.error("[Player] Error creating sprite frame: "+e)}}))}else console.warn("[Player] No profile image URL provided")},o.applyProfileTexture=function(e){var r=new y;r.texture=e,this.profileImage.spriteFrame=r},o.onServerRoomStateChange=function(e){e?this.updatePlayerState(e):console.error("[Player] Invalid room state")},o.updatePlayerState=function(e){switch(e.currentGameState){case h.PLAYER_ANSWERING:this.playerState=k.ANSWERING;break;case h.DEATH_SCENARIO:this.playerState=e.isMyTurnInScenarioPicking(this.index)?k.PICKING_SCENARIO:k.IDLE;break;case h.AI_JUDGEMENT:this.playerState=e.isMyTurnInJudging(this.index)?k.JUDGING:k.IDLE;break;default:this.playerState=k.IDLE}},o.onReconnection=function(e){if(e){var r=e.getPlayerByIndex(this.index);r?(this.loadProfile(r),this.updatePlayerState(e),this.handleReconnectionByGameState(e,r),console.log("[Player] Player "+this.index+" reconnection complete, state: "+this.playerState)):console.error("[Player] No player data found for index "+this.index+" during reconnection")}else console.error("[Player] Invalid room state for reconnection")},o.handleReconnectionByGameState=function(e,r){switch(e.currentGameState){case h.PLAYER_ANSWERING:r.currentAnswer&&""!==r.currentAnswer&&console.log("[Player] Restoring previous answer for player "+this.index+": "+r.currentAnswer);break;case h.DEATH_SCENARIO:e.isMyTurnInScenarioPicking(this.index)&&console.log("[Player] Restoring scenario picking state for player "+this.index);break;case h.AI_JUDGEMENT:e.isMyTurnInJudging(this.index)&&console.log("[Player] Restoring judging state for player "+this.index)}},o.isMyTurn=function(e){return this.index===e},o.setPlayerNumber=function(e){this.index=e},o.getProfileSpriteFrame=function(){return this.profileImage?this.profileImage.spriteFrame:null},o.openProfile=function(){this.userId?console.log("Opening profile for user: "+this.userId):console.warn("[Player] Cannot open profile: No user ID available")},o.getPlayerState=function(){return this.playerState},o.isLocalPlayer=function(){return this.isLocal},r}(d)).prototype,"index",[P],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),x=r(v.prototype,"nameLabel",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=r(v.prototype,"profileImage",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),E=v))||E));o._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_PlayerAnswerScreen.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_Menu.ts","./DrMonkeyGameHandler.ts","./DrMonkey_GameMessageType.ts","./DrMonkey_GameState.ts","./DrMonkey_Timer.ts","./DrMonkey_GameManager.ts","./DrMonkey_NetworkTypes.ts","./DrMonkey_NetworkManager.ts"],(function(t){var e,n,i,r,o,a,s,u,l,h,c,p,m,y,d,b,f,g;return{setters:[function(t){e=t.applyDecoratedDescriptor,n=t.inheritsLoose,i=t.initializerDefineProperty,r=t.assertThisInitialized},function(t){o=t.cclegacy,a=t._decorator,s=t.Label,u=t.EditBox,l=t.Button},function(t){h=t.DrMonkeyMenu},function(t){c=t.DrMonkeyGameHandler,p=t.GameStateChangeEvent},function(t){m=t.DrMonkeyGameMessageType},function(t){y=t.DrMonkeyGameState},function(t){d=t.DrMonkeyTimer},function(t){b=t.DrMonkeyGameManager},function(t){f=t.DrMonkeyNetworkEvents},function(t){g=t.DrMonkeyNetworkManager}],execute:function(){var E,w,S,C,M,B,T,k,D,v,A,P,_,G,x;o._RF.push({},"cdb0d4bw4dPKYUqwsmTyp/j","DrMonkey_PlayerAnswerScreen",void 0);var N=a.ccclass,L=a.property;t("DrMonkeyPlayerAnswerScreen",(E=N("DrMonkeyPlayerAnswerScreen"),w=L({type:s}),S=L({type:s}),C=L({type:u}),M=L({type:l}),B=L({type:d}),T=L({type:s}),E((v=e((D=function(t){function e(){for(var e,n=arguments.length,o=new Array(n),a=0;a<n;a++)o[a]=arguments[a];return e=t.call.apply(t,[this].concat(o))||this,i(e,"prompt",v,r(e)),i(e,"waitingForOtherPlayers",A,r(e)),i(e,"inputEditBox",P,r(e)),i(e,"submitButton",_,r(e)),e.isSubmitted=!1,i(e,"timer",G,r(e)),i(e,"answerCharCount",x,r(e)),e.totalChars=140,e}n(e,t);var o=e.prototype;return o.onLoad=function(){t.prototype.onLoad.call(this)},o.Open=function(){t.prototype.Open.call(this),this.isSubmitted=!1,this.waitingForOtherPlayers.node.active=!1,this.submitButton.node.active=!0,this.inputEditBox.string="",this.inputEditBox.enabled=!0,this.timer.reset(),this.timer.setStartTime(c.Instance.currentRoomState.roomSettings.answerTimeLimit-3),this.timer.setOnTimerEndCallback(this.onTimerEnd.bind(this)),this.timer.startTimer(),this.updateCharCount(0),b.Instance.miloGameSDK.vibratePreset("medium")},o.start=function(){p.on(f.GAME_STATE_CHANGE,this.onGameStateChange,this),this.submitButton&&this.submitButton.node.on(l.EventType.CLICK,this.onSubmitButtonClick,this),this.inputEditBox&&this.inputEditBox.node.on(u.EventType.TEXT_CHANGED,this.onTextChanged,this)},o.onDestroy=function(){p.off(f.GAME_STATE_CHANGE,this.onGameStateChange,this),this.submitButton&&this.submitButton.node&&this.submitButton.node.off(l.EventType.CLICK,this.onSubmitButtonClick,this),this.inputEditBox&&this.inputEditBox.node&&this.inputEditBox.node.off(u.EventType.TEXT_CHANGED,this.onTextChanged,this)},o.onGameStateChange=function(t){t===y.PLAYER_ANSWERING&&this.displayDeathScenario()},o.displayDeathScenario=function(){var t=c.Instance.currentRoomState.deathScenario;this.prompt.string=t},o.onSubmitButtonClick=function(){var t=this.inputEditBox.string.trim();""!==t?(g.Instance.sendMessage(m.PLAYER_ANSWER,t),console.log("[PlayerAnswerScreen] Submitted answer:",t),this.submitButton.node.active=!1,this.inputEditBox.enabled=!1,this.waitingForOtherPlayers&&(this.waitingForOtherPlayers.node.active=!0),this.isSubmitted=!0):console.warn("[PlayerAnswerScreen] Cannot submit empty answer")},o.onTimerEnd=function(){if(!this.isSubmitted){var t=this.inputEditBox.string.trim();""!==t?(g.Instance.sendMessage(m.PLAYER_ANSWER,t),console.log("[PlayerAnswerScreen] Time's up! Auto-submitted answer:",t)):console.warn("[PlayerAnswerScreen] Time's up! No answer to submit."),this.submitButton.node.active=!1,this.inputEditBox.enabled=!1,this.waitingForOtherPlayers&&(this.waitingForOtherPlayers.node.active=!0),this.isSubmitted=!0}},o.onTextChanged=function(){var t=this.inputEditBox.string.length;this.updateCharCount(t)},o.updateCharCount=function(t){this.answerCharCount.string=t+"/"+this.totalChars},e}(h)).prototype,"prompt",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),A=e(D.prototype,"waitingForOtherPlayers",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=e(D.prototype,"inputEditBox",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_=e(D.prototype,"submitButton",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),G=e(D.prototype,"timer",[B],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),x=e(D.prototype,"answerCharCount",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=D))||k));o._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_PlayerTypes.ts",["cc"],(function(e){var n;return{setters:[function(e){n=e.cclegacy}],execute:function(){n._RF.push({},"28c20+MmmxIqYXVZqdhn7tU","DrMonkey_PlayerTypes",void 0);e("DrMonkeyPlayerType",function(e){return e[e.HUMAN=0]="HUMAN",e[e.BOT=1]="BOT",e[e.SPECTATOR=2]="SPECTATOR",e}({}));n._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_ResultsScreen.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_Menu.ts","./DrMonkeyGameHandler.ts","./DrMonkey_Utils.ts"],(function(e){var t,r,n,o,a,i,l,c,s,u,A,p,S,T,f,y,I,h,d,m,E,R;return{setters:[function(e){t=e.applyDecoratedDescriptor,r=e.inheritsLoose,n=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){a=e.cclegacy,i=e._decorator,l=e.easing,c=e.Node,s=e.Prefab,u=e.SpriteFrame,A=e.instantiate,p=e.Label,S=e.Sprite,T=e.tween,f=e.Vec3,y=e.UIOpacity,I=e.Color,h=e.RichText,d=e.Tween},function(e){m=e.DrMonkeyMenu},function(e){E=e.DrMonkeyGameHandler},function(e){R=e.DrMonkeyUtils}],execute:function(){var _,C,N,g,D,H,M,v,P,b,O,L,w,B,F;a._RF.push({},"0ef4cDl9UhB1ai8zk5eBHc/","DrMonkey_ResultsScreen",void 0);var U=i.ccclass,z=i.property,k={DEATH_STAMP:{INITIAL_ROTATION:10,IMPACT_ROTATION:10,SCALE_IMPACT:1.1,STAMP_DURATION:.25,BOUNCE_DURATION:.1,RESTORE_DURATION:.2,INITIAL_Y_OFFSET:0,INITIAL_SCALE:2.5,DELAY:.5},HEART_BREATHING:{DURATION:1.5,SCALE_MIN:.95,SCALE_MAX:1.05,EASING:l.sineInOut}};e("DrMonkeyResultsScreen",(_=U("DrMonkeyResultsScreen"),C=z(c),N=z(s),g=z(s),D=z({type:u}),H=z({type:u}),M=z({type:u}),_((b=t((P=function(e){function t(){for(var t,r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a))||this,n(t,"playerScoreContainer",b,o(t)),n(t,"playerScorePrefab",O,o(t)),n(t,"heartPrefab",L,o(t)),n(t,"survivedHeartSpriteFrame",w,o(t)),n(t,"skullHeartSpriteFrame",B,o(t)),n(t,"greyDotSpriteFrame",F,o(t)),t.roomState=null,t}r(t,e);var a=t.prototype;return a.Open=function(){e.prototype.Open.call(this),this.setRoomState(E.Instance.getRoomState()),this.updateResults()},a.Close=function(){this.clearAnimations(),this.clearScores(),e.prototype.Close.call(this)},a.onEnable=function(){},a.updateResults=function(){var e=this;this.roomState&&(console.log("[ResultsScreen] Updating results RoomState:",this.roomState),this.clearScores(),this.roomState.playersData.forEach((function(t){return e.createPlayerScoreCard(t)})))},a.createPlayerScoreCard=function(e){var t=A(this.playerScorePrefab);t.parent=this.playerScoreContainer,this.setPlayerScoreCardName(t,e.name),this.createRoundIndicators(t,e),this.setPlayerScoreCardTotalScore(t,e.roundScores)},a.setPlayerScoreCardName=function(e,t){var r,n=null==(r=e.getChildByName("PlayerName"))?void 0:r.getComponent(p);n&&(n.string=R.truncateName(t,10))},a.createRoundIndicators=function(e,t){var r=this,n=e.getChildByName("HeartsContainer");if(n&&this.roomState){t.roundScores.forEach((function(e){r.addRoundIndicator(n,e)}));for(var o=this.roomState.roomSettings.rounds,a=t.roundScores.length;a<o;a++)this.addUpcomingRoundIndicator(n)}},a.addRoundIndicator=function(e,t){var r=A(this.heartPrefab);r.parent=e;var n=r.getComponent(S);if(n){n.spriteFrame=t.survived?this.survivedHeartSpriteFrame:this.skullHeartSpriteFrame;var o=this.isLatestRound(t);t.survived&&o?this.applyBreathingAnimation(r):!t.survived&&o&&this.applyDeathStampAnimation(r)}},a.isLatestRound=function(e){if(!this.roomState)return!1;var t=this.roomState.currentRound;return e.roundNumber===t},a.applyBreathingAnimation=function(e){T(e).to(k.HEART_BREATHING.DURATION/2,{scale:new f(k.HEART_BREATHING.SCALE_MAX,k.HEART_BREATHING.SCALE_MAX,1)},{easing:k.HEART_BREATHING.EASING}).to(k.HEART_BREATHING.DURATION/2,{scale:new f(k.HEART_BREATHING.SCALE_MIN,k.HEART_BREATHING.SCALE_MIN,1)},{easing:k.HEART_BREATHING.EASING}).union().repeatForever().start()},a.applyDeathStampAnimation=function(e){var t=e.scale.clone(),r=e.position.clone();e.angle=k.DEATH_STAMP.INITIAL_ROTATION,e.scale=new f(t.x*k.DEATH_STAMP.INITIAL_SCALE,t.y*k.DEATH_STAMP.INITIAL_SCALE,t.z),e.position=new f(r.x,r.y+k.DEATH_STAMP.INITIAL_Y_OFFSET,r.z);var n=e.parent,o=n?n.position.clone():null,a=e.getComponent(y);a||(a=e.addComponent(y)),a.opacity=255;var i=e.getComponent(S),l=i?i.color.clone():new I(255,0,0,255);i&&(i.color=new I(l.r,l.g,l.b,0)),this.scheduleOnce((function(){T(e).to(k.DEATH_STAMP.STAMP_DURATION,{position:r,scale:t,angle:k.DEATH_STAMP.IMPACT_ROTATION},{easing:"quartIn"}).to(k.DEATH_STAMP.BOUNCE_DURATION,{scale:new f(t.x*k.DEATH_STAMP.SCALE_IMPACT,t.y*k.DEATH_STAMP.SCALE_IMPACT,t.z),angle:k.DEATH_STAMP.IMPACT_ROTATION},{easing:"bounceOut"}).to(k.DEATH_STAMP.RESTORE_DURATION,{scale:t},{easing:"elasticOut"}).start(),i&&T(i).to(k.DEATH_STAMP.STAMP_DURATION-.05,{color:new I(l.r,l.g,l.b,0)}).to(.1,{color:l}).start(),n&&o&&T(n).to(.02,{position:new f(o.x+5,o.y,o.z)}).to(.02,{position:new f(o.x-5,o.y,o.z)}).to(.02,{position:new f(o.x,o.y,o.z)}).start()}),k.DEATH_STAMP.DELAY)},a.addUpcomingRoundIndicator=function(e){var t=A(this.heartPrefab);t.parent=e,t.scale=new f(.5,.5,1);var r=t.getComponent(S);r&&(r.spriteFrame=this.greyDotSpriteFrame)},a.setPlayerScoreCardTotalScore=function(e,t){var r,n=t.reduce((function(e,t){return e+t.score}),0),o=null==(r=e.getChildByName("Score"))?void 0:r.getComponent(h);if(o){var a=n>0?"#00ff00":"#ff0000";o.string="<color="+a+">"+(n>=0?"+":"")+n+"</color>"}},a.clearScores=function(){this.playerScoreContainer&&this.playerScoreContainer.removeAllChildren()},a.setRoomState=function(e){this.roomState=e},a.initialize=function(){e.prototype.initialize.call(this)},a.clearAnimations=function(){this.playerScoreContainer&&this.playerScoreContainer.children.forEach((function(e){var t=e.getChildByName("HeartsContainer");t&&t.children.forEach((function(e){d.stopAllByTarget(e)}))}))},t}(m)).prototype,"playerScoreContainer",[C],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=t(P.prototype,"playerScorePrefab",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(P.prototype,"heartPrefab",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=t(P.prototype,"survivedHeartSpriteFrame",[D],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=t(P.prototype,"skullHeartSpriteFrame",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(P.prototype,"greyDotSpriteFrame",[M],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=P))||v));a._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_RoomState.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_BasePlayerData.ts","./DrMonkey_BaseRoomSettings.ts","./DrMonkey_BaseRoomState.ts","./DrMonkey_GameState.ts"],(function(t){var r,e,n,i,o,u;return{setters:[function(t){r=t.inheritsLoose},function(t){e=t.cclegacy},function(t){n=t.DrMonkeyBasePlayerData},function(t){i=t.DrMonkeyBaseRoomSettings},function(t){o=t.DrMonkeyBaseRoomState},function(t){u=t.DrMonkeyGameState}],execute:function(){e._RF.push({},"9e2e5n+SWlOqpfgrsbjDtOu","DrMonkey_RoomState",void 0);var a=t("PlayerRoundScore",function(){function t(){this.roundNumber=0,this.score=0,this.survived=!0}return t.prototype.copyFrom=function(t){this.roundNumber=t.roundNumber,this.score=t.score,this.survived=t.survived},t}()),s=t("DrMonkeyPlayerData",function(t){function e(){for(var r,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(r=t.call.apply(t,[this].concat(n))||this).currentAnswer="",r.aiJudgement="",r.roundScores=[],r}return r(e,t),e.prototype.copyFrom=function(r){t.prototype.copyFrom.call(this,r),this.currentAnswer=r.currentAnswer,this.aiJudgement=r.aiJudgement,this.roundScores=r.roundScores.map((function(t){var r=new a;return r.copyFrom(t),r}))},e}(n)),c=t("DrMonkeyRoomSettings",function(t){function e(){for(var r,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return(r=t.call.apply(t,[this].concat(n))||this).promptTimeLimit=void 0,r.showScenarioTimeLimit=void 0,r.answerTimeLimit=void 0,r.timePerChar=void 0,r.rounds=void 0,r}return r(e,t),e.prototype.copyFrom=function(r){t.prototype.copyFrom.call(this,r),this.promptTimeLimit=r.promptTimeLimit,this.showScenarioTimeLimit=r.showScenarioTimeLimit,this.answerTimeLimit=r.answerTimeLimit,this.timePerChar=r.timePerChar,this.rounds=r.rounds},e}(i)),m=t("DrMonkeyInputPayload",function(){function t(){this.inputType=void 0,this.inputValue=void 0}return t.prototype.copyFrom=function(t){this.inputType=t.inputType,this.inputValue=t.inputValue},t}());t("DrMonkeyRoomState",function(t){function e(){var r;return(r=t.call(this,new c,[])||this).inputPayload=new m,r.currentGameState=u.NONE,r.previousGameState=u.NONE,r.deathScenario="",r.currentJudgingPlayerNumber=-1,r.currentScenarioPickingPlayerNumber=-1,r.serverTick=0,r.currentRound=1,r}r(e,t);var i=e.prototype;return i.copyFrom=function(r){t.prototype.copyFrom.call(this,r),this.playersData=r.playersData.map((function(t){var r=new s;return r.copyFrom(t),r})),this.spectatorsData=r.spectatorsData.map((function(t){var r=new n;return r.copyFrom(t),r})),this.currentRoomStatus=r.currentRoomStatus,this.previousRoomStatus=r.previousRoomStatus,this.currentGameState=r.currentGameState,this.previousGameState=r.previousGameState,this.roomSettings.copyFrom(r.roomSettings),this.inputPayload.copyFrom(r.inputPayload),this.deathScenario=r.deathScenario,this.currentJudgingPlayerNumber=r.currentJudgingPlayerNumber,this.currentScenarioPickingPlayerNumber=r.currentScenarioPickingPlayerNumber,this.currentRound=r.currentRound,this.serverTick=r.serverTick},i.getPlayerByUserId=function(t){return this.playersData.find((function(r){return r.userId===t}))||null},i.getOnlinePlayersCount=function(){return this.playersData.filter((function(t){return t.isOnline})).length},i.getPlayerByIndex=function(t){return this.playersData.find((function(r){return r.playerNumber===t}))||null},i.getPlayerBySessionId=function(t){return this.playersData.find((function(r){return r.sessionId===t}))||null},i.isMyTurnInScenarioPicking=function(t){return this.currentScenarioPickingPlayerNumber===t},i.isMyTurnInJudging=function(t){return this.currentJudgingPlayerNumber===t},e}(o));e._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_RoomTypes.ts",["cc"],(function(e){var o;return{setters:[function(e){o=e.cclegacy}],execute:function(){o._RF.push({},"a7968k7sxJF146vWwZAkJqg","DrMonkey_RoomTypes",void 0);e("DrMonkeyRoomStatus",function(e){return e[e.NONE=0]="NONE",e[e.WAITING_FOR_PLAYERS=1]="WAITING_FOR_PLAYERS",e[e.COUNTDOWN=2]="COUNTDOWN",e[e.GAME_SIMULATION=3]="GAME_SIMULATION",e[e.END_GAME=4]="END_GAME",e[e.KICKED_OUT=5]="KICKED_OUT",e}({}));o._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_ShowScenarioScreen.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_Menu.ts","./DrMonkeyGameHandler.ts"],(function(e){var n,t,o,i,a,r,c,s,l,u,p,y,b,h;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,o=e.initializerDefineProperty,i=e.assertThisInitialized},function(e){a=e.cclegacy,r=e._decorator,c=e.Label,s=e.Node,l=e.view,u=e.Vec3,p=e.UIOpacity,y=e.tween},function(e){b=e.DrMonkeyMenu},function(e){h=e.DrMonkeyGameHandler}],execute:function(){var g,d,f,R,m,w,L,S,v,O,D;a._RF.push({},"d33bdfKAbZI8Jn8aBY7/nlv","DrMonkey_ShowScenarioScreen",void 0);var I=r.ccclass,M=r.property;e("DrMonkeyShowScenarioScreen",(g=I("DrMonkeyShowScenarioScreen"),d=M(c),f=M(c),R=M(s),m=M(c),g((S=n((L=function(e){function n(){for(var n,t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=e.call.apply(e,[this].concat(a))||this,o(n,"scenarioIncomingLabel",S,i(n)),o(n,"getReadyLabel",v,i(n)),o(n,"scenarioRoot",O,i(n)),o(n,"promptLabel",D,i(n)),n.scenarioRootOpacity=null,n}t(n,e);var a=n.prototype;return a.Open=function(){e.prototype.Open.call(this),this.promptLabel.string=h.Instance.currentRoomState.deathScenario,this.scenarioIncomingLabel.node.active=!0,this.getReadyLabel.node.active=!0;var n=l.getVisibleSize(),t=-n.height/2-500,o=n.height/2+500;this.scenarioIncomingLabel.node.position=new u(0,t,0),this.getReadyLabel.node.position=new u(0,t,0),this.scenarioRoot.scale=new u(.3,.3,1),this.scenarioRootOpacity=this.scenarioRoot.getComponent(p),this.scenarioRootOpacity||(this.scenarioRootOpacity=this.scenarioRoot.addComponent(p)),this.scenarioRootOpacity.opacity=0,this.animateLabels(t,0,o)},a.animateLabels=function(e,n,t){var o=this;y(this.scenarioIncomingLabel.node).to(.7,{position:new u(0,n,0)},{easing:"cubicOut"}).delay(1.2).to(.7,{position:new u(0,t,0)},{easing:"cubicIn"}).call((function(){y(o.getReadyLabel.node).to(.7,{position:new u(0,n,0)},{easing:"cubicOut"}).delay(1.2).to(.7,{position:new u(0,t,0)},{easing:"cubicIn"}).call((function(){o.scenarioRoot.active=!0,y(o.scenarioRoot).to(.7,{scale:new u(1,1,1)},{easing:"cubicOut"}).start(),y(o.scenarioRootOpacity).to(.7,{opacity:255}).start()})).start()})).start()},a.Close=function(){e.prototype.Close.call(this),this.scenarioRoot.active=!1},n}(b)).prototype,"scenarioIncomingLabel",[d],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=n(L.prototype,"getReadyLabel",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),O=n(L.prototype,"scenarioRoot",[R],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),D=n(L.prototype,"promptLabel",[m],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=L))||w));a._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_StartRoundScreen.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_Menu.ts","./DrMonkeyGameHandler.ts"],(function(o){var t,n,e,i,r,s,a,u,c,l,p,d,h,T,R,y;return{setters:[function(o){t=o.applyDecoratedDescriptor,n=o.inheritsLoose,e=o.initializerDefineProperty,i=o.assertThisInitialized},function(o){r=o.cclegacy,s=o._decorator,a=o.easing,u=o.Node,c=o.Label,l=o.Vec3,p=o.UIOpacity,d=o.view,h=o.UITransform,T=o.tween},function(o){R=o.DrMonkeyMenu},function(o){y=o.DrMonkeyGameHandler}],execute:function(){var A,N,S,I,O,f,g;r._RF.push({},"f6d85jESStG7J87As22FAQ0","DrMonkey_StartRoundScreen",void 0);var C=s.ccclass,D=s.property,m={POSITION:{DURATION:.8,EASING:a.cubicOut},OPACITY:{DURATION:.6,EASING:a.cubicIn,START:0,END:255},OFFSET_FACTOR:.75};o("DrMonkeyStartRoundScreen",(A=C("DrMonkeyStartRoundScreen"),N=D(u),S=D(c),A((f=t((O=function(o){function t(){for(var t,n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t=o.call.apply(o,[this].concat(r))||this,e(t,"roundRootNode",f,i(t)),e(t,"roundCountLabel",g,i(t)),t.originalPosition=new l,t.positionTween=null,t.opacityTween=null,t}n(t,o);var r=t.prototype;return r.onLoad=function(){this.roundRootNode.getComponent(p)||this.roundRootNode.addComponent(p)},r.Open=function(){o.prototype.Open.call(this),this.updateRoundCount(),this.originalPosition=this.roundRootNode.position.clone(),this.animateRoundNode()},r.Close=function(){this.stopAllAnimations(),o.prototype.Close.call(this)},r.updateRoundCount=function(){var o=y.Instance.getRoomState().currentRound;this.roundCountLabel.string="Scenario "+o},r.stopAllAnimations=function(){this.positionTween&&this.positionTween.stop(),this.opacityTween&&this.opacityTween.stop()},r.animateRoundNode=function(){this.stopAllAnimations();var o=d.getVisibleSize().width+this.roundRootNode.getComponent(h).width*m.OFFSET_FACTOR;this.roundRootNode.setPosition(o,this.originalPosition.y,this.originalPosition.z);var t=this.roundRootNode.getComponent(p);t.opacity=m.OPACITY.START,this.positionTween=T(this.roundRootNode).to(m.POSITION.DURATION,{position:this.originalPosition},{easing:m.POSITION.EASING}).start(),this.opacityTween=T(t).to(m.OPACITY.DURATION,{opacity:m.OPACITY.END},{easing:m.OPACITY.EASING}).start()},t}(R)).prototype,"roundRootNode",[N],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=t(O.prototype,"roundCountLabel",[S],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),I=O))||I));r._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_Timer.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(i){var t,e,r,l,n,a,o,s,h,m,c,p;return{setters:[function(i){t=i.applyDecoratedDescriptor,e=i.inheritsLoose,r=i.initializerDefineProperty,l=i.assertThisInitialized},function(i){n=i.cclegacy,a=i._decorator,o=i.Label,s=i.Sprite,h=i.Color,m=i.tween,c=i.Vec3,p=i.Component}],execute:function(){var u,T,b,d,f,C,g;n._RF.push({},"46ed0dFwG9HVIxa5Y7HHHH5","DrMonkey_Timer",void 0);var S=a.ccclass,L=a.property;i("DrMonkeyTimer",(u=S("DrMonkeyTimer"),T=L(o),b=L(s),u((C=t((f=function(i){function t(){for(var t,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return t=i.call.apply(i,[this].concat(n))||this,r(t,"timeUiLabel",C,l(t)),r(t,"timerFillSprite",g,l(t)),t.elapsedTime=0,t.maxTime=0,t.isRunning=!1,t.onTimerEndCallback=null,t.isInCriticalTime=!1,t.originalColor=new h(255,255,255,255),t.originalSpriteColor=new h(255,255,255,255),t.criticalColor=new h(255,0,0,255),t.heartbeatTween=null,t}e(t,i);var n=t.prototype;return n.start=function(){this.timeUiLabel&&(this.originalColor=this.timeUiLabel.color.clone()),this.timerFillSprite&&(this.originalSpriteColor=this.timerFillSprite.color.clone())},n.update=function(i){this.isRunning&&(this.elapsedTime-=i,this.elapsedTime<=0&&(this.elapsedTime=0,this.stopTimer(),this.onTimerEndCallback&&this.onTimerEndCallback()),this.updateTimeLabel(),this.updateFillSprite(),this.checkCriticalTime())},n.startTimer=function(){this.isRunning||(this.isRunning=!0)},n.stopTimer=function(){this.isRunning&&(this.isRunning=!1,this.stopHeartbeatAnimation(),this.isInCriticalTime=!1,this.timeUiLabel&&(this.timeUiLabel.color=this.originalColor),this.timerFillSprite&&(this.timerFillSprite.color=this.originalSpriteColor))},n.reset=function(){this.elapsedTime=0,this.stopHeartbeatAnimation(),this.isInCriticalTime=!1,this.timeUiLabel&&(this.timeUiLabel.color=this.originalColor),this.timerFillSprite&&(this.timerFillSprite.color=this.originalSpriteColor),this.updateTimeLabel()},n.setStartTime=function(i){console.log("[Timer] Setting start time to:",i),this.elapsedTime=i,this.maxTime=i,this.updateTimeLabel(),this.updateFillSprite()},n.setOnTimerEndCallback=function(i){this.onTimerEndCallback=i},n.updateTimeLabel=function(){var i=Math.floor(this.elapsedTime);this.timeUiLabel.string=""+i},n.updateFillSprite=function(){if(this.timerFillSprite){var i=this.maxTime>0?this.elapsedTime/this.maxTime:0;this.timerFillSprite.fillRange=i}},n.formatTime=function(i){return i<10?"0"+i:""+i},n.formatMilliseconds=function(i){return i<10?"00"+i:i<100?"0"+i:""+i},n.checkCriticalTime=function(){this.elapsedTime<=10&&!this.isInCriticalTime?(this.isInCriticalTime=!0,this.timeUiLabel.color=this.criticalColor,this.timerFillSprite&&(this.timerFillSprite.color=this.criticalColor),this.startHeartbeatAnimation()):this.elapsedTime>10&&this.isInCriticalTime&&(this.isInCriticalTime=!1,this.timeUiLabel.color=this.originalColor,this.timerFillSprite&&(this.timerFillSprite.color=this.originalSpriteColor),this.stopHeartbeatAnimation())},n.startHeartbeatAnimation=function(){this.stopHeartbeatAnimation(),this.heartbeatTween=m(this.timeUiLabel.node).repeatForever(m(this.timeUiLabel.node).to(.3,{scale:new c(1.2,1.2,1)}).to(.3,{scale:new c(1,1,1)}).delay(.6)).start()},n.stopHeartbeatAnimation=function(){this.heartbeatTween&&(this.heartbeatTween.stop(),this.heartbeatTween=null),this.timeUiLabel&&this.timeUiLabel.node&&(this.timeUiLabel.node.scale=new c(1,1,1))},t}(p)).prototype,"timeUiLabel",[T],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),g=t(f.prototype,"timerFillSprite",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=f))||d));n._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_UIManager.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_Menu.ts","./DrMonkey_GameState.ts","./DrMonkey_GameMessageType.ts","./DrMonkey_GameManager.ts","./DrMonkeyGameHandler.ts","./DrMonkey_NetworkManager.ts","./DrMonkey_NetworkTypes.ts","./DrMonkey_RoomTypes.ts"],(function(e){var n,t,a,o,s,r,i,l,u,c,h,S,g,M,d,f,m,C,p,A,E,y;return{setters:[function(e){n=e.applyDecoratedDescriptor,t=e.inheritsLoose,a=e.initializerDefineProperty,o=e.assertThisInitialized},function(e){s=e.cclegacy,r=e._decorator,i=e.Camera,l=e.Node,u=e.Color,c=e.Sprite,h=e.tween,S=e.Component},function(e){g=e.DrMonkeyMenu},function(e){M=e.DrMonkeyGameState},function(e){d=e.DrMonkeyGameMessageType},function(e){f=e.RoomStatusChangeEvent},function(e){m=e.GameStateChangeEvent},function(e){C=e.ConnectionStateChangeEvent,p=e.ServerMessageEvent},function(e){A=e.DrMonkeyNetworkEvents,E=e.DrMonkeyConnectionState},function(e){y=e.DrMonkeyRoomStatus}],execute:function(){var N,O,_,G,w,R,D,k,I,T;s._RF.push({},"d0730UuwPBGhqdkqs1njq/g","DrMonkey_UIManager",void 0);var v=r.ccclass,U=r.property;e("DrMonkeyUIManager",(N=v("DrMonkeyUIManager"),O=U({type:i}),_=U({type:[g]}),G=U({type:l}),N(((T=function(e){function n(){for(var n,t=arguments.length,s=new Array(t),r=0;r<t;r++)s[r]=arguments[r];return n=e.call.apply(e,[this].concat(s))||this,a(n,"uiCamera",D,o(n)),a(n,"menus",k,o(n)),a(n,"flashNode",I,o(n)),n.showMuteButton=!0,n.showResultScreen=!0,n.showFAQ=!0,n}t(n,e);var s=n.prototype;return s.onLoad=function(){n.instance=this,C.on(A.CONNECTION_STATE_CHANGE,this.onConnectionStateChange,this),f.on(A.ROOM_STATUS_CHANGE,this.onRoomStatusChange,this),p.on(A.SERVER_MESSAGE,this.onServerMessage,this),m.on(A.GAME_STATE_CHANGE,this.onGameStateChange,this)},s.onDestroy=function(){C.off(A.CONNECTION_STATE_CHANGE,this.onConnectionStateChange,this),f.off(A.ROOM_STATUS_CHANGE,this.onRoomStatusChange,this),p.off(A.SERVER_MESSAGE,this.onServerMessage,this),m.off(A.GAME_STATE_CHANGE,this.onGameStateChange,this)},s.start=function(){},s.onCameraOrthoSizeChange=function(e){console.log("[UIManager] Camera ortho size changed: ",e),this.uiCamera.orthoHeight=e},s.OpenHowToPlay=function(){this.OpenMenu("HowToPlay")},s.OpenMenu=function(e){for(var n=0;n<this.menus.length;n++)this.menus[n].menuName==e&&this.menus[n].Open()},s.CloseMenu=function(e){for(var n=0;n<this.menus.length;n++)this.menus[n].menuName==e&&this.menus[n].Close()},s.GetMenu=function(e){for(var n=0;n<this.menus.length;n++)if(this.menus[n].menuName==e)return this.menus[n];return null},s.CloseAllMenus=function(){for(var e=0;e<this.menus.length;e++)this.menus[e].Close()},s.onConnectionStateChange=function(e,n){switch(console.log("[UIManager] Connection state changed: ",n),n){case E.CONNECTING:this.CloseAllMenus(),this.OpenMenu("InGameMenu")}},s.onGameStateChange=function(e){switch(e){case M.START_ROUND:this.handleStartRoundState();break;case M.DEATH_SCENARIO:this.handleDeathScenarioState();break;case M.SHOW_SCENARIO:console.log("[UIManager] Showing scenario state"),this.handleShowScenarioState();break;case M.PLAYER_ANSWERING:this.handlePlayerAnswerState();break;case M.AI_JUDGEMENT:this.handleAiJudgementState();break;case M.ROUND_RESULTS:this.handleRoundResultsState();break;case M.GAME_OVER:this.handleGameOverState()}},s.handleStartRoundState=function(){console.log("[UIManager] Handling start round state"),this.CloseAllMenus(),this.OpenMenu("StartRoundScreen")},s.handleDeathScenarioState=function(){console.log("[UIManager] Handling death scenario state"),this.CloseAllMenus(),this.OpenMenu("DeathScenarioScreen")},s.handleShowScenarioState=function(){console.log("[UIManager] Handling show scenario state"),this.CloseAllMenus(),this.OpenMenu("ShowScenarioScreen")},s.handlePlayerAnswerState=function(){console.log("[UIManager] Handling player answer state"),this.CloseMenu("ShowScenarioScreen"),this.OpenMenu("PlayerAnswerScreen")},s.handleAiJudgementState=function(){console.log("[UIManager] Handling ai judgement state"),this.CloseMenu("PlayerAnswerScreen"),this.OpenMenu("AiJudgementScreen")},s.handleRoundResultsState=function(){console.log("[UIManager] Handling round results state"),this.CloseAllMenus(),this.OpenMenu("ResultsScreen")},s.handleGameOverState=function(){console.log("[UIManager] Handling game over state"),this.CloseAllMenus(),this.OpenMenu("GameOverScreen")},s.onServerMessage=function(e,n){switch(e){case d.AI_JUDGEMENT:var t=this.GetMenu("AiJudgementScreen"),a="object"==typeof n?n:JSON.parse(n);t.setAiJudgement(a);break;case d.FATE_HAS_BEEN_SEALED:this.GetMenu("AiJudgementScreen").setFateSealed();break;case d.SCENARIO_UPDATE:this.GetMenu("DeathScenarioScreen").updateScenarioLabel()}},s.onRoomStatusChange=function(e,n){var t=this;switch(console.log("[UIManager] Room status changed: ",n),n){case y.WAITING_FOR_PLAYERS:console.log("Opening waiting screen"),this.OpenMenu("WaitingScreen");break;case y.COUNTDOWN:console.log("Opening countdown screen"),this.CloseAllMenus(),this.OpenMenu("CountDownScreen");break;case y.GAME_SIMULATION:this.scheduleOnce((function(){t.CloseMenu("CountdownScreen"),t.OpenMenu("InGameMenu")}),1);break;case y.END_GAME:console.log("[UIManager] End Game State handling in UI Manager"),this.CloseAllMenus(),console.log("[UIManager] Opening end game menu"),this.OpenMenu("EndGameMenu");break;default:console.warn("[UIManager] Unhandled RoomStatus: "+n)}},s.playFlashEffect=function(e){var n=this;void 0===e&&(e=new u(197,8,8)),this.flashNode.active=!0;var t=this.flashNode.getComponent(c);t?(t.color=new u(e.r,e.g,e.b,0),h(t).to(.2,{color:new u(e.r,e.g,e.b,255)}).delay(.05).to(.3,{color:new u(e.r,e.g,e.b,0)}).call((function(){n.flashNode.active=!1})).start()):console.error("No Sprite component found on flashNode")},n}(S)).instance=null,D=n((R=T).prototype,"uiCamera",[O],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),k=n(R.prototype,"menus",[_],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=n(R.prototype,"flashNode",[G],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),w=R))||w));s._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_Utils.ts",["cc"],(function(t){var r;return{setters:[function(t){r=t.cclegacy}],execute:function(){r._RF.push({},"22b9bHcFltOfq6ReZrEN7Rd","DrMonkey_Utils",void 0);t("DrMonkeyUtils",function(){function t(){}return t.roundNumber=function(t,r){void 0===r&&(r=2);var e=Math.pow(10,r);return Math.round((t+Number.EPSILON)*e)/e},t.truncateName=function(t,r){if(void 0===r&&(r=10),!t)return"";var e=t.split(" ")[0],n=e.charAt(0).toUpperCase()+e.slice(1);return n.length<=r?n:n.slice(0,r)+".."},t}());r._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkey_WaitingScreen.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_Menu.ts"],(function(e){var n,r,t,c;return{setters:[function(e){n=e.inheritsLoose},function(e){r=e.cclegacy,t=e._decorator},function(e){c=e.DrMonkeyMenu}],execute:function(){var i;r._RF.push({},"ea277B0GwJBwIk71c4YDI3Q","DrMonkey_WaitingScreen",void 0);var o=t.ccclass;t.property,e("DrMonkeyWaitingScreen",o("DrMonkeyWaitingScreen")(i=function(e){function r(){return e.apply(this,arguments)||this}return n(r,e),r}(c))||i);r._RF.pop()}}}));

System.register("chunks:///_virtual/DrMonkeyGameHandler.ts",["./rollupPluginModLoBabelHelpers.js","cc","./DrMonkey_Timer.ts","./DrMonkey_RoomState.ts","./DrMonkey_GameMessageType.ts","./DrMonkey_GameState.ts","./DrMonkey_Player.ts","./DrMonkey_PBLogger.ts","./DrMonkey_NetworkManager.ts","./DrMonkey_NetworkTypes.ts","./DrMonkey_RoomTypes.ts"],(function(e){var t,n,r,o,a,i,s,c,l,u,m,h,f,y,S,d,E,p,G,R,g,T,C,N,_,M,D,v;return{setters:[function(e){t=e.applyDecoratedDescriptor,n=e.inheritsLoose,r=e.initializerDefineProperty,o=e.assertThisInitialized,a=e.createClass},function(e){i=e.cclegacy,s=e._decorator,c=e.EventTarget,l=e.Prefab,u=e.Node,m=e.game,h=e.Game,f=e.instantiate,y=e.Tween,S=e.Component},function(e){d=e.DrMonkeyTimer},function(e){E=e.DrMonkeyRoomState},function(e){p=e.DrMonkeyGameMessageType},function(e){G=e.DrMonkeyGameState},function(e){R=e.DrMonkeyPlayer},function(e){g=e.DrMonkeyPBLogger},function(e){T=e.ConnectionStateChangeEvent,C=e.ServerRoomStateChangeEvent,N=e.ServerMessageEvent,_=e.DrMonkeyNetworkManager},function(e){M=e.DrMonkeyNetworkEvents,D=e.DrMonkeyConnectionState},function(e){v=e.DrMonkeyRoomStatus}],execute:function(){var A,P,k,w,b,H,I,O,z,L,V,F,U;i._RF.push({},"f5ad9rc0z5Hu7pz4fTpvQ8r","DrMonkeyGameHandler",void 0);var W=s.ccclass,B=s.property,J=s.executionOrder,Y=e("GameStateChangeEvent",new c);e("DrMonkeyGameHandler",(A=W("DrMonkeyGameHandler"),P=J(-1),k=B({type:l,tooltip:"Prefab for player instances"}),w=B({type:u,tooltip:"Container node for player instances"}),b=B({type:d,tooltip:"Reference to game timer component"}),H=B({type:[R],visible:!1}),A(I=P(((U=function(e){function t(){for(var t,n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return t=e.call.apply(e,[this].concat(a))||this,r(t,"playerPrefab",z,o(t)),r(t,"playersContainer",L,o(t)),r(t,"timer",V,o(t)),r(t,"players",F,o(t)),t.currentRoomState=null,t.localPlayerNumber=-1,t.hasReconnected=!1,t}n(t,e);var i=t.prototype;return i.onLoad=function(){t._instance&&this.node.destroy(),t._instance=this,this.validateRequiredComponents(),this.registerNetworkEvents(),this.registerGameEvents(),this.handleBrowserClose()},i.onDestroy=function(){this.unregisterNetworkEvents(),this.unregisterGameEvents(),window.removeEventListener("beforeunload",this.onGameClose.bind(this)),t._instance===this&&(t._instance=null)},i.validateRequiredComponents=function(){this.playerPrefab||g.error("Player prefab not assigned to DrMonkeyGameHandler"),this.playersContainer||g.error("Players container not assigned to DrMonkeyGameHandler"),this.timer||g.error("Timer component not assigned to DrMonkeyGameHandler")},i.initialize=function(e){g.info("DrMonkeyGameHandler initialized with room settings",e)},i.registerNetworkEvents=function(){T.on(M.CONNECTION_STATE_CHANGE,this.onConnectionStateChange,this),C.on(M.SERVER_ROOM_STATE_CHANGE,this.onServerRoomStateChange,this),N.on(M.SERVER_MESSAGE,this.onServerMessage,this)},i.unregisterNetworkEvents=function(){T.off(M.CONNECTION_STATE_CHANGE,this.onConnectionStateChange,this),C.off(M.SERVER_ROOM_STATE_CHANGE,this.onServerRoomStateChange,this),N.off(M.SERVER_MESSAGE,this.onServerMessage,this)},i.registerGameEvents=function(){m.on(h.EVENT_HIDE,this.onGameHide,this),m.on(h.EVENT_SHOW,this.onGameShow,this),m.on(h.EVENT_RESTART,this.onGameRestart,this),m.on(h.EVENT_CLOSE,this.onGameClose,this)},i.unregisterGameEvents=function(){m.off(h.EVENT_HIDE,this.onGameHide,this),m.off(h.EVENT_SHOW,this.onGameShow,this),m.off(h.EVENT_RESTART,this.onGameRestart,this),m.off(h.EVENT_CLOSE,this.onGameClose,this)},i.handleBrowserClose=function(){window.addEventListener("beforeunload",this.onGameClose.bind(this))},i.onServerMessage=function(e,t){g.info("Server message received:",e,t),this.log("Unhandled server message type:",e)},i.onServerRoomStateChange=function(e){this.currentRoomState?(this.currentRoomState.copyFrom(e),this.currentRoomState.currentRoomStatus!==v.END_GAME?this.hasReconnected?this.handleReconnection(this.currentRoomState):(this.handleRoomStateUpdate(this.currentRoomState),this.sendRoomStateToAllPlayers(this.currentRoomState)):this.handleEndGameState()):this.initializeRoomState(e)},i.initializeRoomState=function(e){e?(this.currentRoomState=new E,this.currentRoomState.copyFrom(e),this.initializePlayers(this.currentRoomState),this.currentRoomState.currentGameState!==G.NONE&&this.currentRoomState.currentGameState!==G.WAITING_FOR_PLAYERS&&(g.info("Joined game in progress with state:",this.currentRoomState.currentGameState),Y.emit(M.GAME_STATE_CHANGE,this.currentRoomState.currentGameState),this.handleJoiningInProgressGame(this.currentRoomState))):g.error("Attempted to initialize with null room state")},i.handleJoiningInProgressGame=function(e){e.currentGameState!==G.PLAYER_ANSWERING&&e.currentGameState!==G.DEATH_SCENARIO||(this.timer.reset(),this.timer.startTimer()),this.sendReconnectionStateToAllPlayers(e)},i.handleEndGameState=function(){console.log("Game Over - State Change:",this.currentRoomState)},i.handleReconnection=function(e){g.info("Reconnection detected - Syncing game state:",e.currentGameState),e.currentGameState===G.PLAYER_ANSWERING||e.currentGameState===G.DEATH_SCENARIO?(this.timer.reset(),this.timer.startTimer()):(this.timer.reset(),this.timer.stopTimer()),this.sendReconnectionStateToAllPlayers(e),Y.emit(M.GAME_STATE_CHANGE,e.currentGameState),this.hasReconnected=!1},i.handleRoomStateUpdate=function(e){g.info("[DrMonkeyGameHandler] ==== Game State Change ==== :",e.currentGameState);var t=e.inputPayload.inputType;t===p.SET_STATE?this.handleSetState(e):t===p.SCENARIO_UPDATE&&this.handleScenarioUpdate(e)},i.handleSetState=function(e){g.info("Handling SET STATE"),this.timer.reset(),this.timer.stopTimer(),console.log("[DrMonkeyGameHandler] ==== Game State Change ==== :",e.currentGameState),Y.emit(M.GAME_STATE_CHANGE,e.currentGameState)},i.handleScenarioUpdate=function(e){g.info("Handling SCENARIO UPDATE")},i.initializePlayers=function(e){var t=this;this.log("Initializing "+e.playersData.length+" players"),this.assignMyPlayerNumber(e),e.playersData.forEach((function(n,r){t.createPlayer(r).initialize(e,r)}))},i.sendChatMessageToServer=function(e){},i.onConnectionStateChange=function(e,t){t===D.DISCONNECTED?this.onGameDisconnect():e===D.RECONNECTING&&t===D.JOINED_ROOM&&(this.hasReconnected=!0,this.onGameReconnect())},i.sendRoomStateToAllPlayers=function(e){},i.sendReconnectionStateToAllPlayers=function(e){g.info("Syncing reconnection state to all players"),this.players.forEach((function(t){t&&t.onReconnection&&t.onReconnection(e)})),e.currentGameState===G.PLAYER_ANSWERING&&g.info("Restoring player answer state after reconnection"),e.currentGameState===G.SHOW_SCENARIO&&g.info("Restoring scenario display after reconnection")},i.createPlayer=function(e){if(!this.playerPrefab||!this.playersContainer)throw g.error("Cannot create player: playerPrefab or playersContainer is null"),new Error("Cannot create player: missing required components");var t=f(this.playerPrefab);t.setParent(this.playersContainer);var n=t.getComponent(R);if(!n)throw g.error("Player component not found on instantiated player prefab"),new Error("Player component not found on instantiated player prefab");return this.players.push(n),n},i.getPlayer=function(e){if(e)return this.players.find((function(t){return t.userId===e}));g.warning("Attempted to get player with empty ID")},i.getLocalPlayerNumber=function(){return this.localPlayerNumber},i.getRoomState=function(){return this.currentRoomState},i.isMyTurn=function(){return!1},i.assignMyPlayerNumber=function(e){var t=this;e.playersData.forEach((function(e,n){e.sessionId===_.Instance.CurrentRoom.sessionId&&(t.localPlayerNumber=n)}))},i.allPlayersFinished=function(){return!1},i.anyPlayerFinished=function(){return!1},i.getPlayerName=function(e){var t;return(null==(t=this.players.find((function(t){return t.userId===e})))?void 0:t.playerName)||e},i.onGameHide=function(){g.info("Game hidden"),y.stopAll()},i.onGameShow=function(){g.info("Game shown")},i.onGameRestart=function(){g.info("Game restarted")},i.onGameClose=function(){g.info("Game closed")},i.onGameDisconnect=function(){g.info("Game disconnected")},i.onGameReconnect=function(){g.info("Game reconnected")},i.log=function(e,t,n){void 0===n&&(n="info");var r="[DrMonkeyGameHandler] "+e;switch(n){case"error":g.error(r,t);break;case"warn":g.warning(r,t);break;case"debug":g.debug(r,t);break;default:g.info(r,t)}},a(t,null,[{key:"Instance",get:function(){if(!this._instance)throw g.error("DrMonkeyGameHandler instance not initialized"),new Error("DrMonkeyGameHandler instance not initialized");return this._instance}}]),t}(S))._instance=null,z=t((O=U).prototype,"playerPrefab",[k],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),L=t(O.prototype,"playersContainer",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),V=t(O.prototype,"timer",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),F=t(O.prototype,"players",[H],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),I=O))||I)||I));i._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/drmonkey_game', 'chunks:///_virtual/drmonkey_game'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});