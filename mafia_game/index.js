System.register("chunks:///mafia_game.js",["./rollupPluginModLoBabelHelpers-5eee144e.js","cc","./colyseus.mjs_cjs=&original=-36827661.js"],(function(){var t,e,n,i,o,r,a,s,l,c,u,h,p,d,f,m,g,y,v,S,C,T,b,R,E,_,I,w,A,N,O,P,L,M,D,k,G,F,z,H,V,B,W,U,x,Y,K,J,j;return{setters:[function(l){t=l._,e=l.a,n=l.b,i=l.c,o=l.h,r=l.d,a=l.f,s=l.g},function(t){l=t.cclegacy,c=t._decorator,u=t.sys,h=t.Component,p=t.EventTarget,d=t.CCBoolean,f=t.UITransform,m=t.Camera,g=t.screen,y=t.view,v=t.math,S=t.director,C=t.Director,T=t.Widget,b=t.Enum,R=t.Size,E=t.Node,_=t.Vec3,I=t.Label,w=t.Sprite,A=t.assetManager,N=t.SpriteFrame,O=t.Texture2D,P=t.CCInteger,L=t.Button,M=t.Prefab,D=t.Color,k=t.instantiate,G=t.tween,F=t.game,z=t.Game,H=t.Tween,V=t.CCString,B=t.AudioClip,W=t.CCFloat,U=t.AudioSource,x=t.Layout,Y=t.UIOpacity,K=t.Animation},function(t){J=t._,j=t.M}],execute:function(){l._RF.push({},"1f240GvJhZCS7g77Mtiwwuo","Mafia_PBLogger",void 0);var X,Z,Q,q,$,tt,et,nt,it,ot,rt,at,st,lt,ct,ut,ht,pt=function(t){return t[t.Debug=0]="Debug",t[t.Info=1]="Info",t[t.Warning=2]="Warning",t[t.Error=3]="Error",t}({}),dt=function(){function t(){}return t.debug=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.log(pt.Debug,t,n)},t.info=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.log(pt.Info,t,n)},t.warning=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.log(pt.Warning,t,n)},t.error=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this.log(pt.Error,t,n)},t.log=function(t,e,n){if(t>=this.currentLevel){var i,o=pt[t]+": "+e;if((i=console).log.apply(i,[o].concat(n)),this.isProduction&&window.ReactNativeWebView)try{var r={type:"log",level:pt[t],message:o,params:n};window.ReactNativeWebView&&window.ReactNativeWebView.postMessage(JSON.stringify(r))}catch(t){console.error("Failed to send log to ReactNativeWebView:",t)}}},t.setLevel=function(t){this.currentLevel=t},t.setProductionMode=function(t){this.isProduction=t},t}();dt.currentLevel=pt.Debug,dt.isProduction=!1,l._RF.pop(),l._RF.push({},"75bbeEbPABFnrzgARe30U1N","Mafia_NetworkConfig",void 0);var ft=c.ccclass,mt=c.property,gt=(X=ft("MafiaNetworkConfig"),Z=mt({tooltip:"Server host address"}),Q=mt({tooltip:"Server port number"}),q=mt({tooltip:"Use SSL for connections"}),$=mt({tooltip:"Player identifier"}),tt=mt({tooltip:"Room identifier"}),et=mt({tooltip:"Name of the game"}),nt=mt({tooltip:"Whether the data was assigned from query parameters"}),X((rt=t((ot=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"serverHost",rt,i(e)),n(e,"serverPort",at,i(e)),n(e,"useSSL",st,i(e)),n(e,"userId",lt,i(e)),n(e,"roomId",ct,i(e)),n(e,"gameName",ut,i(e)),n(e,"assignedFromQueryParams",ht,i(e)),e}e(o,t);var r=o.prototype;return r.parseQueryParams=function(){var t=this;if(dt.debug("parseQueryParams"),u.isBrowser){var e=new URLSearchParams(window.location.search);dt.debug("queryParams",e),this.updateConfigFromQueryParam(e,"userId",(function(e){dt.debug("userId",e),t.userId=e,t.assignedFromQueryParams=!0})),this.updateConfigFromQueryParam(e,"roomId",(function(e){dt.debug("roomId",e),t.roomId=e})),this.updateConfigFromQueryParam(e,"apiUrl",(function(e){t.serverHost=e})),this.updateConfigFromQueryParam(e,"apiPort",(function(e){var n=parseInt(e);isNaN(n)||(t.serverPort=n)})),this.updateConfigFromQueryParam(e,"useSSL",(function(e){t.useSSL="true"===e}))}},r.updateConfigFromQueryParam=function(t,e,n){var i=t.get(e);null!=i&&n(i)},o}(h)).prototype,"serverHost",[Z],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"localhost"}}),at=t(ot.prototype,"serverPort",[Q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2567}}),st=t(ot.prototype,"useSSL",[q],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),lt=t(ot.prototype,"userId",[$],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),ct=t(ot.prototype,"roomId",[tt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"testroom1"}}),ut=t(ot.prototype,"gameName",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Pictionary"}}),ht=t(ot.prototype,"assignedFromQueryParams",[nt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),it=ot))||it);l._RF.pop(),l._RF.push({},"917450yHbdDfoiHLt9WC9RD","Mafia_NetworkTypes",void 0);var yt=function(t){return t[t.SERVER_ROOM_STATE_CHANGE=0]="SERVER_ROOM_STATE_CHANGE",t[t.CONNECTION_STATE_CHANGE=1]="CONNECTION_STATE_CHANGE",t[t.ROOM_STATUS_CHANGE=2]="ROOM_STATUS_CHANGE",t[t.GAME_STATE_CHANGE=3]="GAME_STATE_CHANGE",t[t.SERVER_MESSAGE=4]="SERVER_MESSAGE",t}({}),vt=function(t){return t[t.INITIALIZING=0]="INITIALIZING",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.LOBBY=3]="LOBBY",t[t.JOINED_ROOM=4]="JOINED_ROOM",t[t.DISCONNECTED=5]="DISCONNECTED",t[t.RECONNECTING=6]="RECONNECTING",t[t.KICKED_OUT=7]="KICKED_OUT",t}({}),St=function(t){return t.NONE="none",t.KICKED_OUT="kicked_out",t.PLAYER_CAMEBACK="player_cameback",t.PLAYER_JOINED="player_joined",t}({});l._RF.pop(),l._RF.push({},"4d199WiL2xLT6KTu/5loLPp","Mafia_PlayerTypes",void 0);var Ct,Tt=function(t){return t[t.HUMAN=0]="HUMAN",t[t.BOT=1]="BOT",t[t.SPECTATOR=2]="SPECTATOR",t}({});l._RF.pop(),l._RF.push({},"d2fa7MJJdNKspLZrCg4jToe","Mafia_PbSaveSystem",void 0);var bt,Rt,Et,_t,It,wt,At,Nt,Ot=(0,c.ccclass)("MafiaPbSaveSystem")(Ct=function(){function t(){}return t.SaveData=function(t,e){dt.info("============ Saving data in pb save system ========="),u.localStorage.setItem(t,JSON.stringify(e))},t.LoadData=function(t){return JSON.parse(u.localStorage.getItem(t))},t.RemoveData=function(t){u.localStorage.removeItem(t)},t.ClearAllData=function(){u.localStorage.clear()},t}())||Ct;l._RF.pop(),l._RF.push({},"3be38Y+E+RBhLFuL1FxpRfp","Mafia_NetworkManager",void 0);var Pt,Lt,Mt,Dt,kt,Gt,Ft,zt,Ht,Vt,Bt,Wt,Ut=c.ccclass,xt=c.property,Yt={roomId:"testroom1",reconnectionToken:"eyJ"},Kt=new p,Jt=new p,jt=new p,Xt=(bt=Ut("MafiaNetworkManager"),Rt=xt({type:d,tooltip:"Enable development mode for additional logging"}),Et=xt({type:gt,tooltip:"Network configuration settings"}),bt(((Nt=function(t){function l(){for(var e,r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return e=t.call.apply(t,[this].concat(a))||this,n(e,"isDevMode",wt,i(e)),n(e,"networkConfig",At,i(e)),e._client=void 0,e._room=void 0,e._currentConnectionState=vt.INITIALIZING,e._reconnectionData=o({},Yt),e}e(l,t);var c=l.prototype;return c.onLoad=function(){if(l._instance)return this.log("Mafia NetworkManager instance already exists. Destroying duplicate."),void this.node.destroy();l._instance=this,this.networkConfig.parseQueryParams(),this.isDevMode||dt.setProductionMode(!0)},c.start=function(){this.initializeClient(),dt.info("============ Initializing client ========="),this.networkConfig.assignedFromQueryParams&&(dt.info("============ Connecting to room ========="),this.connect(this.networkConfig.roomId,this.networkConfig.userId))},c.initializeClient=function(){var t=this.networkConfig.useSSL?"wss":"ws",e="";e=0==this.networkConfig.serverPort?t+"://"+this.networkConfig.serverHost:t+"://"+this.networkConfig.serverHost+":"+this.networkConfig.serverPort,this.log("Initializing client with endpoint: "+e),this._client=new J.Client(e)},c.shouldRejoin=function(){return!this.isDevMode&&(this._reconnectionData=Ot.LoadData(this.networkConfig.gameName),!!(this._reconnectionData&&this._reconnectionData.roomId&&this._reconnectionData.reconnectionToken)&&this._reconnectionData.roomId===this.networkConfig.roomId)},c.connect=function(){var t=a(s().mark((function t(e,n){var i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(dt.info("============ Connecting to room from connect function ========="),this.updateConnectionState(vt.CONNECTING),!this.shouldRejoin()){t.next=7;break}return this.log("Rejoining room",e),t.next=6,this.rejoin();case 6:return t.abrupt("return");case 7:return t.prev=7,i=this.createPlayerData(n),this.log("Joining with options ",{player:i}),t.next=12,this._client.joinById(e,{player:i});case 12:this._room=t.sent,this.initAfterJoin(e),t.next=20;break;case 16:throw t.prev=16,t.t0=t.catch(7),this.handleConnectionError(t.t0),t.t0;case 20:case"end":return t.stop()}}),t,this,[[7,16]])})));return function(e,n){return t.apply(this,arguments)}}(),c.initAfterJoin=function(t){this.updateConnectionState(vt.JOINED_ROOM),this.log("Joined room "+t+" with sessionId: "+this._room.sessionId),this.initializeRoomCallbacks(),this.saveReconnectionData()},c.createAndJoinRoom=function(){var t=a(s().mark((function t(e,n){var i;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.log("Creating room",e),this.updateConnectionState(vt.CONNECTING),t.prev=2,i=this.createPlayerData(n),t.next=6,this._client.create("PictionaryRoom",{roomId:e,player:i,roomSettings:{maxClients:10}});case 6:this._room=t.sent,this.initAfterJoin(e),t.next=14;break;case 10:throw t.prev=10,t.t0=t.catch(2),this.handleConnectionError(t.t0),t.t0;case 14:case"end":return t.stop()}}),t,this,[[2,10]])})));return function(e,n){return t.apply(this,arguments)}}(),c.createPlayerData=function(t){return{userId:t,name:t,avatar:"randomProfilePicture",type:Tt.HUMAN}},c.initializeRoomCallbacks=function(){var t=this;console.log("============ Initializing room callbacks ========="),this._room?(this._room.onStateChange((function(t){Jt.emit(yt.SERVER_ROOM_STATE_CHANGE,t)})),this._room.onLeave((function(e){4001===e?t.updateConnectionState(vt.KICKED_OUT):t.updateConnectionState(vt.DISCONNECTED)})),this._room.onMessage(St.KICKED_OUT,(function(){t.updateConnectionState(vt.KICKED_OUT)})),this._room.onMessage("*",(function(t,e){jt.emit(yt.SERVER_MESSAGE,t,e)}))):this.log("Cannot initialize callbacks: Room is not defined")},c.updateConnectionState=function(t){if(this._currentConnectionState!==t){var e=this._currentConnectionState;this._currentConnectionState=t,this.log("Connection state changed: "+vt[e]+" -> "+vt[t]),Kt.emit(yt.CONNECTION_STATE_CHANGE,e,t)}},c.reconnect=function(){var t=a(s().mark((function t(e,n,i){var o,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===e&&(e=1),void 0===n&&(n=10),void 0===i&&(i=2e3),this._currentConnectionState===vt.DISCONNECTED||this._currentConnectionState===vt.RECONNECTING){t.next=6;break}return this.log("Cannot reconnect: Current state is "+vt[this._currentConnectionState]),t.abrupt("return");case 6:return this._room&&this._room.state&&(o=this._room.state).roomSettings&&o.roomSettings.maxReconnectionAttempts&&(n=o.roomSettings.maxReconnectionAttempts),this.updateConnectionState(vt.RECONNECTING),this.log("Reconnect attempt "+e+"/"+n),t.prev=9,t.next=12,this.delay(i);case 12:if(this._room&&this._room.reconnectionToken){t.next=14;break}throw new Error("Reconnection token not available");case 14:return t.next=16,this._client.reconnect(this._room.reconnectionToken);case 16:r=t.sent,this._room=r,this.saveReconnectionData(),this.initializeRoomCallbacks(),this.updateConnectionState(vt.JOINED_ROOM),this.log("Reconnected successfully."),t.next=27;break;case 24:t.prev=24,t.t0=t.catch(9),this.handleReconnectionError(t.t0,e,n,i);case 27:case"end":return t.stop()}}),t,this,[[9,24]])})));return function(e,n,i){return t.apply(this,arguments)}}(),c.rejoin=function(){var t=a(s().mark((function t(e,n,i){var o,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===e&&(e=1),void 0===n&&(n=10),void 0===i&&(i=2e3),this.log("Rejoin attempt "+e+"/"+n),t.prev=4,t.next=7,this.delay(i);case 7:if(this._reconnectionData&&this._reconnectionData.reconnectionToken){t.next=9;break}throw new Error("Reconnection data not available");case 9:return o=this._reconnectionData.roomId+":"+this._reconnectionData.reconnectionToken,dt.info("Using formatted reconnection token: ",o),t.next=13,this._client.reconnect(o);case 13:r=t.sent,this._room=r,this.saveReconnectionData(),this.initializeRoomCallbacks(),this.updateConnectionState(vt.JOINED_ROOM),this.log("Rejoined successfully."),t.next=24;break;case 21:t.prev=21,t.t0=t.catch(4),this.handleReconnectionError(t.t0,e,n,i,"reJoin");case 24:case"end":return t.stop()}}),t,this,[[4,21]])})));return function(e,n,i){return t.apply(this,arguments)}}(),c.delay=function(){var t=a(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t){return setTimeout(t,e)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),c.handleConnectionError=function(t){var e=(null==t?void 0:t.message)||"Unknown error";this.log("Error connecting to room:",e),this.updateConnectionState(vt.DISCONNECTED)},c.handleReconnectionError=function(t,e,n,i,o){void 0===o&&(o="reconnect");var r=(null==t?void 0:t.message)||"Unknown error";this.log(o+" attempt "+e+" failed:",r),e<n||-1===n?"reconnect"===o?this.reconnect(e+1,n,i):this.rejoin(e+1,n,i):(this.log("Max reconnection attempts reached. Please check your network or contact support."),this.updateConnectionState(vt.DISCONNECTED))},c.saveReconnectionData=function(){if(dt.info("============ Saving reconnection data ========="),this._room&&this._room.reconnectionToken){var t=this._room.reconnectionToken;t.includes(":")&&(t=t.split(":")[1]),dt.info("saving Reconnection token: ",t),this._reconnectionData={roomId:this.networkConfig.roomId,reconnectionToken:t},Ot.SaveData(this.networkConfig.gameName,this._reconnectionData),dt.info("Reconnection data saved")}else this.log("Cannot save reconnection data: Room or reconnection token not available")},c.leaveRoom=function(){var t=this;this._room?(this.log("Leaving room"),this._room.leave(!0).then((function(){return t.log("Left room successfully")})).catch((function(e){return t.log("Error leaving room:",(null==e?void 0:e.message)||"Unknown error")}))):this.log("Cannot leave room: Room is not defined")},c.getMySessionId=function(){return this._room.sessionId},c.sendMessage=function(t,e){this._room?(this.isDevMode&&this.log("Sending message:",t,e),this._room.send(t,e)):this.log("Cannot send message: Room is not defined")},c.log=function(t){if(this.isDevMode){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];n.length>0?dt.info.apply(dt,["[NetworkManager] "+t].concat(n)):dt.info("[NetworkManager] "+t)}},r(l,[{key:"CurrentRoom",get:function(){return this._room}},{key:"CurrentConnectionState",get:function(){return this._currentConnectionState}}],[{key:"Instance",get:function(){if(!this._instance)throw new Error("NetworkManager instance is not initialized.");return this._instance}}]),l}(h))._instance=null,wt=t((It=Nt).prototype,"isDevMode",[Rt],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),At=t(It.prototype,"networkConfig",[Et],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_t=It))||_t);l._RF.pop(),l._RF.push({},"150f90QrSRP7bztAHTo8GP7","Mafia_CameraManger",void 0);var Zt=c.ccclass,Qt=c.property;(0,c.executionOrder)(-1);var qt,$t,te,ee,ne,ie=(Pt=Zt("MafiaCameraManger"),Lt=Qt({type:f}),Pt(((Wt=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"canvasUITransform",kt,i(e)),n(e,"designHeight",Gt,i(e)),n(e,"designWidth",Ft,i(e)),n(e,"defaultOrthoHeight",zt,i(e)),n(e,"minOrthoHeight",Ht,i(e)),n(e,"maxOrthoHeight",Vt,i(e)),n(e,"safeAreaPadding",Bt,i(e)),e.designAspectRatio=void 0,e.currentAspectRatio=void 0,e.camera=null,e.windowWidth=1080,e.windowHeight=1920,e}e(o,t);var r=o.prototype;return r.onLoad=function(){o.instance=this,this.designAspectRatio=this.designWidth/this.designHeight,this.camera=this.node.getComponent(m)},r.start=function(){var t=this;this.updateScreenSize(),this.adaptCameraToScreen(),window.addEventListener("resize",(function(){t.updateScreenSize(),t.adaptCameraToScreen()}))},r.update=function(t){},r.updateScreenSize=function(){this.windowWidth=g.windowSize.width||window.innerWidth,this.windowHeight=g.windowSize.height||window.innerHeight,this.currentAspectRatio=this.windowWidth/this.windowHeight,console.log("Window Size: "+this.windowWidth+"x"+this.windowHeight+", Aspect Ratio: "+this.currentAspectRatio.toFixed(2))},r.adaptCameraToScreen=function(){if(this.camera){var t=0,e=0,n=0,i=0;if(u.os===u.OS.IOS||u.os===u.OS.ANDROID){var o=y.getVisibleSize(),r=y.getVisibleOrigin();o&&(t=r.y,e=this.windowHeight-(r.y+o.height),n=r.x,i=this.windowWidth-(r.x+o.width))}console.log("safeAreaTop",t),console.log("safeAreaBottom",e),console.log("safeAreaLeft",n),console.log("safeAreaRight",i);var a=this.windowHeight-t-e-2*this.safeAreaPadding,s=this.windowWidth-n-i-2*this.safeAreaPadding,l=s/a;console.log("windowWidth",this.windowWidth),console.log("windowHeight",this.windowHeight),console.log("Effective Size: "+s+"x"+a+", Aspect Ratio: "+l.toFixed(2));var c=this.currentAspectRatio>=1,h=this.defaultOrthoHeight;if(c)console.log("=== Landscape Mode ==="),h=this.defaultOrthoHeight*(1/this.currentAspectRatio)*1.5;else{console.log("=== Portrait Mode ===");var p=.6/Math.min(this.currentAspectRatio,.6);h=this.defaultOrthoHeight*p}h=v.clamp(h,this.minOrthoHeight,this.maxOrthoHeight),this.camera.orthoHeight=h,console.log("Camera Ortho Height: "+h.toFixed(2))}},r.getWidth=function(){return 2*this.camera.orthoHeight*this.currentAspectRatio},r.getCurrentOrthoHeight=function(){return this.camera.orthoHeight},r.refreshCameraAdaptation=function(){this.updateScreenSize(),this.adaptCameraToScreen()},o}(h)).instance=null,kt=t((Dt=Wt).prototype,"canvasUITransform",[Lt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Gt=t(Dt.prototype,"designHeight",[Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1920}}),Ft=t(Dt.prototype,"designWidth",[Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1080}}),zt=t(Dt.prototype,"defaultOrthoHeight",[Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 820}}),Ht=t(Dt.prototype,"minOrthoHeight",[Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 750}}),Vt=t(Dt.prototype,"maxOrthoHeight",[Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1080}}),Bt=t(Dt.prototype,"safeAreaPadding",[Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),Mt=Dt))||Mt);l._RF.pop(),l._RF.push({},"57e95MMlQtJ1o1ktV5cFv8p","Mafia_FitToScreen",void 0);var oe,re,ae,se,le,ce,ue,he,pe,de,fe,me,ge,ye,ve,Se=c.ccclass,Ce=c.property;qt=Se("MafiaFitToScreen"),$t=Ce({type:d}),qt((ne=t((ee=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"updateWidgetsRecursively",ne,i(e)),e}e(o,t);var r=o.prototype;return r.onEnable=function(){var t=this;S.once(C.EVENT_AFTER_UPDATE,(function(){t.refresh()}))},r.setUiTransformToScreenSize=function(){var t=this.node.getComponent(f),e=ie.instance.getCurrentOrthoHeight()/ie.instance.defaultOrthoHeight,n=g.windowSize.width||window.innerWidth,i=g.windowSize.height||window.innerHeight,o=ie.instance.designHeight*e,r=o*n/i;console.log("windowWidth",n,"windowHeight",i),t.setContentSize(r,o)},r.refresh=function(){this.setUiTransformToScreenSize(),this.updateWidgetsRecursively&&this.updateWidgetsInHierarchy()},r.updateWidgetsInHierarchy=function(){this.updateWidgetAndDescendants(this.node)},r.updateWidgetAndDescendants=function(t){var e=this,n=t.getComponent(T);n&&this.node.uuid!=t.uuid&&n.updateAlignment(),t.children.forEach((function(t){e.updateWidgetAndDescendants(t)}))},o}(h)).prototype,"updateWidgetsRecursively",[$t],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),te=ee));l._RF.pop(),l._RF.push({},"e36ff/Ql1lCXIUDONHBv7XU","Mafia_MiloLayout",void 0);var Te=c.ccclass,be=c.property,Re=function(t){return t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL",t[t.GRID=2]="GRID",t}({}),Ee=function(t){return t[t.LEFT_TOP=0]="LEFT_TOP",t[t.CENTER_TOP=1]="CENTER_TOP",t[t.RIGHT_TOP=2]="RIGHT_TOP",t[t.LEFT_CENTER=3]="LEFT_CENTER",t[t.CENTER=4]="CENTER",t[t.RIGHT_CENTER=5]="RIGHT_CENTER",t[t.LEFT_BOTTOM=6]="LEFT_BOTTOM",t[t.CENTER_BOTTOM=7]="CENTER_BOTTOM",t[t.RIGHT_BOTTOM=8]="RIGHT_BOTTOM",t}({});oe=Te("MafiaMiloLayout"),re=be({type:b(Re)}),ae=be({type:b(Re)}),se=be({type:b(Ee)}),le=be({type:b(Ee)}),ce=be({visible:function(){return this._layoutType===Re.GRID}}),oe((pe=t((he=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"_layoutType",pe,i(e)),n(e,"_alignment",de,i(e)),n(e,"_spacingX",fe,i(e)),n(e,"_spacingY",me,i(e)),n(e,"_columns",ge,i(e)),n(e,"_padding",ye,i(e)),n(e,"_autoResize",ve,i(e)),e._activeChildCount=0,e._layoutSize=new R(0,0),e._lastChildActiveState=[],e}e(o,t);var a=o.prototype;return a.onLoad=function(){this.node.on(E.EventType.CHILD_ADDED,this.onChildAdded,this),this.node.on(E.EventType.CHILD_REMOVED,this.onChildRemoved,this)},a.onDestroy=function(){this.node.off(E.EventType.CHILD_ADDED,this.onChildAdded,this),this.node.off(E.EventType.CHILD_REMOVED,this.onChildRemoved,this),this.removeAllChildListeners()},a.onChildRemoved=function(t){this.removeChildListener(t),this.updateLayout()},a.removeAllChildListeners=function(){var t=this;this.node.children.forEach((function(e){t.removeChildListener(e)}))},a.removeChildListener=function(t){t.__miloLayoutActiveHandler&&(t.off(E.EventType.ACTIVE_IN_HIERARCHY_CHANGED,t.__miloLayoutActiveHandler),t.__miloLayoutActiveHandler=null)},a.start=function(){this._lastChildActiveState=this.node.children.map((function(t){return t.active})),this.updateLayout(),this.addChildActiveListeners()},a.addChildActiveListeners=function(){var t=this;this.node.children.forEach((function(e){t.addChildActiveListener(e)}))},a.addChildActiveListener=function(t){var e=this;t.off(E.EventType.ACTIVE_IN_HIERARCHY_CHANGED,this.onChildActiveChanged,this);var n=function(){e.scheduleOnce((function(){e.updateLayout()}),0)};t.__miloLayoutActiveHandler=n,t.on(E.EventType.ACTIVE_IN_HIERARCHY_CHANGED,n)},a.onChildActiveChanged=function(t){},a.onEnable=function(){this.updateLayout()},a.getAlignmentOffset=function(t){var e,n=new _,i=(null==(e=this.node.getComponent(f))?void 0:e.contentSize)||new R(0,0);switch(console.log("getAlignmentOffset",t,i),this._alignment){case Ee.LEFT_TOP:case Ee.LEFT_CENTER:case Ee.LEFT_BOTTOM:n.x=this._padding;break;case Ee.CENTER_TOP:case Ee.CENTER:case Ee.CENTER_BOTTOM:n.x=(i.width-t.width)/2;break;case Ee.RIGHT_TOP:case Ee.RIGHT_CENTER:case Ee.RIGHT_BOTTOM:n.x=i.width-t.width-this._padding}switch(this._alignment){case Ee.LEFT_TOP:case Ee.CENTER_TOP:case Ee.RIGHT_TOP:n.y=-this._padding;break;case Ee.LEFT_CENTER:case Ee.CENTER:case Ee.RIGHT_CENTER:n.y=-(i.height-t.height)/2;break;case Ee.LEFT_BOTTOM:case Ee.CENTER_BOTTOM:case Ee.RIGHT_BOTTOM:n.y=-i.height+t.height+this._padding}return n},a.updateLayout=function(){if(this.node){var t=this.node.children.filter((function(t){return t.active}));if(this._activeChildCount=t.length,0!==this._activeChildCount)switch(this._layoutType){case Re.HORIZONTAL:this.updateHorizontalLayout(t);break;case Re.VERTICAL:this.updateVerticalLayout(t);break;case Re.GRID:this.updateGridLayout(t)}}},a.updateHorizontalLayout=function(t){var e=this,n=2*this._padding,i=0;t.forEach((function(o,r){var a=o.getComponent(f);a&&(n+=a.width,r<t.length-1&&(n+=e._spacingX),i=Math.max(i,a.height))}));var o=new R(n,i+2*this._padding),r=this.getAlignmentOffset(o),a=r.x;if(t.forEach((function(t){var n=t.getComponent(f);if(n){var o=n.height,s=n.width,l=r.y;switch(e._alignment){case Ee.LEFT_TOP:case Ee.CENTER_TOP:case Ee.RIGHT_TOP:l=r.y-e._padding;break;case Ee.LEFT_CENTER:case Ee.CENTER:case Ee.RIGHT_CENTER:l=r.y-(i-o)/2;break;case Ee.LEFT_BOTTOM:case Ee.CENTER_BOTTOM:case Ee.RIGHT_BOTTOM:l=r.y-i+o}t.position=new _(a+s/2,l-o/2,0),a+=s+e._spacingX}})),this._layoutSize=o,this._autoResize){var s=this.node.getComponent(f);s&&s.setContentSize(o)}},a.updateVerticalLayout=function(t){var e=this,n=2*this._padding,i=0;t.forEach((function(o,r){var a=o.getComponent(f);a&&(n+=a.height,r<t.length-1&&(n+=e._spacingY),i=Math.max(i,a.width))}));var o=new R(i+2*this._padding,n),r=this.getAlignmentOffset(o),a=r.y;if(t.forEach((function(t){var n=t.getComponent(f);if(n){var o=n.height,s=n.width,l=r.x;switch(e._alignment){case Ee.LEFT_TOP:case Ee.LEFT_CENTER:case Ee.LEFT_BOTTOM:l=r.x+e._padding;break;case Ee.CENTER_TOP:case Ee.CENTER:case Ee.CENTER_BOTTOM:l=r.x+(i-s)/2+e._padding;break;case Ee.RIGHT_TOP:case Ee.RIGHT_CENTER:case Ee.RIGHT_BOTTOM:l=r.x+i-s+e._padding}t.position=new _(l+s/2,a-o/2,0),a-=o+e._spacingY}})),this._layoutSize=o,this._autoResize){var s=this.node.getComponent(f);s&&s.setContentSize(o)}},a.updateGridLayout=function(t){if(!(this._columns<=0)){var e=Math.ceil(t.length/this._columns),n=0,i=0;t.forEach((function(t){var e=t.getComponent(f);e&&(n=Math.max(n,e.width),i=Math.max(i,e.height))}));var o=2*this._padding+n*this._columns+this._spacingX*(this._columns-1),r=2*this._padding+i*e+this._spacingY*(e-1),a=new R(o,r),s=this.getAlignmentOffset(a);console.log("[MiloLayout] Total size: ",a),console.log("[MiloLayout] Start pos: ",s);for(var l=0;l<e;l++){var c=Math.min(this._columns,t.length-l*this._columns),u=c*n+(c-1)*this._spacingX,h=0;switch(this._alignment){case Ee.CENTER_TOP:case Ee.CENTER:case Ee.CENTER_BOTTOM:h=(this._columns*n+(this._columns-1)*this._spacingX-u)/2;break;case Ee.RIGHT_TOP:case Ee.RIGHT_CENTER:case Ee.RIGHT_BOTTOM:h=this._columns*n+(this._columns-1)*this._spacingX-u}for(var p=0;p<c;p++){var d=l*this._columns+p;if(d>=t.length)break;var m=t[d],g=m.getComponent(f);if(g){var y=g.width,v=g.height,S=s.x+this._padding+p*(n+this._spacingX)+h,C=s.y-this._padding-l*(i+this._spacingY),T=S,b=C;switch(this._alignment){case Ee.LEFT_TOP:case Ee.LEFT_CENTER:case Ee.LEFT_BOTTOM:T=S;break;case Ee.CENTER_TOP:case Ee.CENTER:case Ee.CENTER_BOTTOM:T=S+(n-y)/2;break;case Ee.RIGHT_TOP:case Ee.RIGHT_CENTER:case Ee.RIGHT_BOTTOM:T=S+n-y}switch(this._alignment){case Ee.LEFT_TOP:case Ee.CENTER_TOP:case Ee.RIGHT_TOP:b=C;break;case Ee.LEFT_CENTER:case Ee.CENTER:case Ee.RIGHT_CENTER:b=C-(i-v)/2;break;case Ee.LEFT_BOTTOM:case Ee.CENTER_BOTTOM:case Ee.RIGHT_BOTTOM:b=C-i+v}m.position=new _(T+y/2,b-v/2,0)}}}if(this._layoutSize=a,this._autoResize){var E=this.node.getComponent(f);E&&E.setContentSize(a)}}},a.update=function(t){if(this.node&&this.node.children.length>0){var e=this.node.children.map((function(t){return t.active})),n=!1;if(this._lastChildActiveState.length!==e.length)n=!0;else for(var i=0;i<e.length;i++)if(this._lastChildActiveState[i]!==e[i]){n=!0;break}n&&(this._lastChildActiveState=e,this.updateLayout())}},a.onChildAdded=function(t){this.addChildActiveListener(t),this.updateLayout()},r(o,[{key:"layoutType",get:function(){return this._layoutType},set:function(t){this._layoutType=t,this.updateLayout()}},{key:"alignment",get:function(){return this._alignment},set:function(t){this._alignment=t,this.updateLayout()}},{key:"spacingX",get:function(){return this._spacingX},set:function(t){this._spacingX=t,this.updateLayout()}},{key:"spacingY",get:function(){return this._spacingY},set:function(t){this._spacingY=t,this.updateLayout()}},{key:"columns",get:function(){return this._columns},set:function(t){this._columns=t,this.updateLayout()}},{key:"padding",get:function(){return this._padding},set:function(t){this._padding=t,this.updateLayout()}},{key:"autoResize",get:function(){return this._autoResize},set:function(t){this._autoResize=t,this.updateLayout()}}]),o}(h)).prototype,"_layoutType",[re],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Re.HORIZONTAL}}),t(he.prototype,"layoutType",[ae],Object.getOwnPropertyDescriptor(he.prototype,"layoutType"),he.prototype),de=t(he.prototype,"_alignment",[se],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ee.LEFT_TOP}}),t(he.prototype,"alignment",[le],Object.getOwnPropertyDescriptor(he.prototype,"alignment"),he.prototype),fe=t(he.prototype,"_spacingX",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),t(he.prototype,"spacingX",[be],Object.getOwnPropertyDescriptor(he.prototype,"spacingX"),he.prototype),me=t(he.prototype,"_spacingY",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),t(he.prototype,"spacingY",[be],Object.getOwnPropertyDescriptor(he.prototype,"spacingY"),he.prototype),ge=t(he.prototype,"_columns",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),t(he.prototype,"columns",[ce],Object.getOwnPropertyDescriptor(he.prototype,"columns"),he.prototype),ye=t(he.prototype,"_padding",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),t(he.prototype,"padding",[be],Object.getOwnPropertyDescriptor(he.prototype,"padding"),he.prototype),ve=t(he.prototype,"_autoResize",[be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),t(he.prototype,"autoResize",[be],Object.getOwnPropertyDescriptor(he.prototype,"autoResize"),he.prototype),ue=he));l._RF.pop(),l._RF.push({},"148f4rScJ9CCpYq02Y6pLaL","Mafia_PbExtensions",void 0),_.prototype.clampMagnitude=function(t,e){if(!(t>e)){var n=this.length();return n>e?(this.normalize(),this.multiplyScalar(e)):n<t&&(this.normalize(),this.multiplyScalar(t)),this}console.error("min should be less than max")},h.prototype.log=function(){for(var t=this.constructor.name,e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];dt.info.apply(dt,[t+" "].concat(n))},l._RF.pop(),l._RF.push({},"e9fc6hX28NAMo5e+sZM6ukk","Mafia_Utils",void 0),l._RF.pop(),l._RF.push({},"8b000DlStVJ5rYkCs5GQBAQ","Mafia_BasePlayerData",void 0);var _e=function(){function t(){this.userId=void 0,this.name=void 0,this.avatar=void 0,this.sessionId=void 0,this.playerNumber=void 0,this.type=void 0,this.isOnline=void 0,this.isConnected=void 0,this.isReplacedByBot=void 0,this.isKickedOut=void 0,this.isReady=void 0,this.score=void 0}return t.prototype.copyFrom=function(t){this.userId=t.userId,this.name=t.name,this.avatar=t.avatar,this.sessionId=t.sessionId,this.playerNumber=t.playerNumber,this.type=t.type,this.isOnline=t.isOnline,this.isConnected=t.isConnected,this.isReplacedByBot=t.isReplacedByBot,this.isKickedOut=t.isKickedOut,this.isReady=t.isReady,this.score=t.score},t}();l._RF.pop(),l._RF.push({},"deb605Z3CxFvIWP3DgiTvl4","Mafia_BaseRoomSettings",void 0);var Ie=function(){function t(){this.maxPlayers=void 0,this.minPlayers=void 0,this.maxClients=void 0,this.countdownTimeInSeconds=void 0,this.allowLateJoin=void 0,this.maxReconnectionAttempts=void 0,this.reconnectionAttemptInterval=void 0,this.reconnectionTime=void 0,this.gameFPS=void 0,this.serverFPS=void 0,this.patchRate=void 0}return t.prototype.copyFrom=function(t){this.maxPlayers=t.maxPlayers,this.minPlayers=t.minPlayers,this.maxClients=t.maxClients,this.countdownTimeInSeconds=t.countdownTimeInSeconds,this.allowLateJoin=t.allowLateJoin,this.reconnectionTime=t.reconnectionTime,this.gameFPS=t.gameFPS,this.serverFPS=t.serverFPS,this.patchRate=t.patchRate},t}();l._RF.pop(),l._RF.push({},"a3a72gjPcRAvIYOfAxJummA","Mafia_RoomTypes",void 0);var we=function(t){return t[t.NONE=0]="NONE",t[t.WAITING_FOR_PLAYERS=1]="WAITING_FOR_PLAYERS",t[t.COUNTDOWN=2]="COUNTDOWN",t[t.GAME_SIMULATION=3]="GAME_SIMULATION",t[t.END_GAME=4]="END_GAME",t[t.KICKED_OUT=5]="KICKED_OUT",t}({});l._RF.pop(),l._RF.push({},"127b1osQO9JAak5yTMMaFTV","Mafia_BaseRoomState",void 0);var Ae,Ne,Oe,Pe,Le,Me,De,ke=function(){function t(t,e){this.currentRoomStatus=we.WAITING_FOR_PLAYERS,this.previousRoomStatus=we.NONE,this.roomSettings=void 0,this.playersData=void 0,this.spectatorsData=void 0,this.roomSettings=t,this.playersData=e,this.spectatorsData=[]}return t.prototype.copyFrom=function(t){this.currentRoomStatus=t.currentRoomStatus,this.previousRoomStatus=t.previousRoomStatus,this.roomSettings.copyFrom(t.roomSettings)},t}();l._RF.pop(),l._RF.push({},"21004HVzaNBZ7tMvv7xOesz","Mafia_Timer",void 0);var Ge=c.ccclass,Fe=c.property,ze=(Ae=Ge("MafiaTimer"),Ne=Fe(I),Oe=Fe(w),Ae((Me=t((Le=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"timeUiLabel",Me,i(e)),n(e,"timerFillSprite",De,i(e)),e.elapsedTime=0,e.maxTime=0,e.isRunning=!1,e.onTimerEndCallback=null,e}e(o,t);var r=o.prototype;return r.update=function(t){this.isRunning&&(this.elapsedTime-=t,this.elapsedTime<=0&&(this.elapsedTime=0,this.stopTimer(),this.onTimerEndCallback&&this.onTimerEndCallback()),this.updateTimeLabel(),this.updateFillSprite())},r.startTimer=function(){this.isRunning||(this.isRunning=!0)},r.stopTimer=function(){this.isRunning&&(this.isRunning=!1)},r.reset=function(){this.elapsedTime=0,this.updateTimeLabel()},r.setStartTime=function(t){console.log("[Timer] Setting start time to:",t),this.elapsedTime=t,this.maxTime=t,this.updateTimeLabel(),this.updateFillSprite()},r.setOnTimerEndCallback=function(t){this.onTimerEndCallback=t},r.updateTimeLabel=function(){var t=Math.floor(this.elapsedTime);this.timeUiLabel.string=""+t},r.updateFillSprite=function(){if(this.timerFillSprite){var t=this.maxTime>0?this.elapsedTime/this.maxTime:0;this.timerFillSprite.fillRange=t}},r.formatTime=function(t){return t<10?"0"+t:""+t},r.formatMilliseconds=function(t){return t<10?"00"+t:t<100?"0"+t:""+t},o}(h)).prototype,"timeUiLabel",[Ne],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),De=t(Le.prototype,"timerFillSprite",[Oe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pe=Le))||Pe);l._RF.pop(),l._RF.push({},"fdf73+b1OpLfpEGWvKuAZY9","Mafia_GameMessageType",void 0);var He=function(t){return t.NONE="none",t.SET_STATE="set_state",t.PLAYER_SELECT_CATEGORY="player_select_category",t.PLAYER_DONE_DESCRIBING="player_done_describing",t.PLAYER_VOTE="player_vote",t}({});l._RF.pop(),l._RF.push({},"f3fd4TufRZHtKazYC085JyL","Mafia_GameState",void 0);var Ve,Be,We,Ue,xe,Ye,Ke,Je,je,Xe=function(t){return t[t.NONE=0]="NONE",t[t.WAITING_FOR_PLAYERS=1]="WAITING_FOR_PLAYERS",t[t.START_ROUND=2]="START_ROUND",t[t.CATEGORY_SELECTION=3]="CATEGORY_SELECTION",t[t.PREPARATION=4]="PREPARATION",t[t.WORD_DESCRIPTION=5]="WORD_DESCRIPTION",t[t.VOTING=6]="VOTING",t[t.VOTING_RESULTS=7]="VOTING_RESULTS",t[t.END_ROUND=8]="END_ROUND",t[t.GAME_OVER=9]="GAME_OVER",t}({});l._RF.pop(),l._RF.push({},"f0449qYRJRD2qYGuhFrYnAx","Mafia_PlayerAvatar",void 0);var Ze,Qe,qe,$e,tn,en,nn,on,rn,an,sn,ln,cn,un,hn,pn,dn,fn,mn,gn,yn,vn,Sn,Cn,Tn,bn,Rn,En,_n,In,wn,An,Nn,On,Pn,Ln,Mn,Dn=c.ccclass,kn=c.property,Gn=(Ve=Dn("MafiaPlayerAvatar"),Be=kn({type:w,tooltip:"Player Avatar"}),We=kn({type:w,tooltip:"Player Avatar Outline"}),Ue=kn({type:E,tooltip:"Skull"}),Ve((Ke=t((Ye=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"playerAvatar",Ke,i(e)),n(e,"outline",Je,i(e)),n(e,"skull",je,i(e)),e.enableOnClick=!1,e.userId="",e}e(o,t);var r=o.prototype;return r.initialize=function(t,e){this.enableOnClick=t,this.userId=e},r.onEnable=function(){this.registerTouchEvents()},r.onDisable=function(){this.unregisterTouchEvents()},r.start=function(){},r.update=function(t){},r.registerTouchEvents=function(){this.playerAvatar.node.on(E.EventType.TOUCH_START,this.handleTouchStart,this)},r.unregisterTouchEvents=function(){this.playerAvatar.node.off(E.EventType.TOUCH_START,this.handleTouchStart,this)},r.handleTouchStart=function(){this.enableOnClick},r.setOutline=function(t){this.outline.enabled=t},r.setAvatarFromUrl=function(t){var e=this.getFromCache(t);e?this.createSpriteFrameFromTexture(e):this.loadRemoteImage(t)},r.setAvatarFromSpriteFrame=function(t){this.playerAvatar.spriteFrame=t},r.getFromCache=function(t){return A.assets.get(t)||null},r.createSpriteFrameFromTexture=function(t){var e=new N;e.texture=t,this.playerAvatar.spriteFrame=e},r.loadRemoteImage=function(t){var e=this;A.loadRemote(t,{ext:".png"},(function(n,i){if(n)return console.error("[Player] Failed to load profile image: "+JSON.stringify(n)),void(window.ReactNativeWebView&&window.ReactNativeWebView.postMessage(JSON.stringify({message:"player_avatar_load_failed",data:{userId:e.userId,url:t,errorName:n.name,errorMessage:n.message,errorStack:n.stack}})));try{var o=new N,r=new O;r.image=i,o.texture=r,e.playerAvatar.spriteFrame=o}catch(n){console.error("[Player] Error creating sprite frame: "+n),window.ReactNativeWebView&&window.ReactNativeWebView.postMessage(JSON.stringify({message:"player_sprite_frame_creation_failed",data:{userId:e.userId,url:t,error:n}}))}}))},r.ShowSkull=function(t){this.skull.active=t},o}(h)).prototype,"playerAvatar",[Be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Je=t(Ye.prototype,"outline",[We],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),je=t(Ye.prototype,"skull",[Ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xe=Ye))||xe);l._RF.pop(),l._RF.push({},"40162PXqm9DSbxUCrdBOLNu","Mafia_Player",void 0);var Fn=c.ccclass,zn=c.property,Hn=function(t){return t[t.UNINITIALIZED=0]="UNINITIALIZED",t[t.IDLE=1]="IDLE",t[t.CATEGORY_SELECTION=2]="CATEGORY_SELECTION",t[t.DESCRIBING=3]="DESCRIBING",t[t.VOTING=4]="VOTING",t[t.END_GAME=5]="END_GAME",t}({}),Vn=(Ze=Fn("MafiaPlayer"),Qe=zn({type:P,tooltip:"Player's index in the game"}),qe=zn({type:I,tooltip:"Label to display player's name"}),$e=zn({type:Gn,tooltip:"Player Avatar"}),tn=zn({type:w,tooltip:"Sprite for player's description timer"}),en=zn({type:L,tooltip:"Button to vote for a player"}),nn=zn({type:L,tooltip:"Button to display that player is selected for vote"}),on=zn({type:E,tooltip:"Container for votes"}),rn=zn({type:E,tooltip:"Container for votes"}),an=zn({type:M,tooltip:"Player Avatar Prefab"}),sn=zn({type:E,tooltip:"Sprite for player speaking animation"}),ln=zn({type:E}),cn=zn({type:E,tooltip:"Sprite for player speaking animation"}),un=zn({type:E}),hn=zn({type:E,tooltip:"Sprite for player Tie status"}),pn=zn({type:E}),dn=zn({type:E}),fn=zn({type:E}),Ze((yn=t((gn=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))||this).userId="",e.playerName="",n(e,"index",yn,i(e)),n(e,"nameLabel",vn,i(e)),n(e,"playerAvatar",Sn,i(e)),n(e,"descriptionTimerSprite",Cn,i(e)),n(e,"voteButton",Tn,i(e)),n(e,"votedButton",bn,i(e)),n(e,"votesContainerLeft",Rn,i(e)),n(e,"votesContainerRight",En,i(e)),n(e,"playerAvatarPrefab",_n,i(e)),n(e,"micSpriteLeft",In,i(e)),n(e,"micLeftFill",wn,i(e)),n(e,"micSpriteRight",An,i(e)),n(e,"micRightFill",Nn,i(e)),n(e,"tieSprite",On,i(e)),n(e,"skull",Pn,i(e)),n(e,"addSymbol",Ln,i(e)),n(e,"avatar",Mn,i(e)),e.playerState=Hn.UNINITIALIZED,e.isLocal=!1,e.isInitialized=!1,e.isProfileInitialized=!1,e.roomSettings=null,e.profileImageUrl="",e.timer=0,e.rank=0,e.hasGuessedAnswer=!1,e.isDead=!1,e.voters=[],e.oddColor=new D(15,43,77,255),e.evenColor=new D(0,0,0,0),e.correctGuessColor=new D(0,255,0,125),e.currentPlayerColor=new D(255,215,0,125),e.localPlayerColor=new D(255,215,0,255),e.micSprite=null,e.micFill=null,e.votesContainer=null,e}e(o,t);var r=o.prototype;return r.onEnable=function(){this.updateBgColor()},r.onDisable=function(){},r.update=function(t){this.playerState===Hn.DESCRIBING&&this.updateTimer(t)},r.IsDead=function(){return this.isDead},r.initialize=function(t,e,n){if(this.validateRoomState(t)){this.index=e,this.addSymbol.active=!1,this.avatar.active=!0,console.log("[Player] Initializing Player: "+this.index);var i=t.getPlayerByIndex(e);i?(n?(this.micSprite=this.micSpriteLeft,this.micFill=this.micLeftFill,this.votesContainer=this.votesContainerLeft):(this.micSprite=this.micSpriteRight,this.micFill=this.micRightFill,this.votesContainer=this.votesContainerRight),this.micSprite.active=!1,this.votesContainer.active=!1,this.loadProfile(i),this.setupPlayerData(i,t),this.updatePlayerState(t),this.sendReactNativeMessage({message:"player_initialized",data:i})):console.error("[Player] No profile data found for player index "+this.index)}},r.setupPlayerData=function(t,e){this.userId=t.userId,this.playerName=t.name,this.roomSettings=e.roomSettings,this.setScore(t.score),t.sessionId===Xt.Instance.CurrentRoom.sessionId&&(this.isLocal=!0,this.nameLabel.string="You",this.highlightLocalPlayer()),this.nameLabel.node.active=!0,this.isInitialized=!0,this.playerState=Hn.IDLE},r.loadProfile=function(t){!this.isProfileInitialized&&t&&(console.log("[Player] Loading profile for player: "+t.name),this.nameLabel.string=Io.Instance.TruncateName(t.name),this.profileImageUrl=t.avatar,this.playerAvatar.initialize(!0,t.userId),this.loadProfileImage(),this.isProfileInitialized=!0,this.isDead=t.isDead,t.isDead?this.skull.active=!0:this.skull.active=!1)},r.loadProfileImage=function(){this.profileImageUrl?this.playerAvatar.setAvatarFromUrl(this.profileImageUrl):console.warn("[Player] No profile image URL provided")},r.onServerRoomStateChange=function(t){this.validateRoomState(t)&&(this.updatePlayerData(t),this.updatePlayerState(t))},r.updatePlayerData=function(t){var e=t.getPlayerByIndex(this.index);e&&this.setScore(e.score)},r.updatePlayerState=function(t){if(this.playerState!==Hn.UNINITIALIZED)switch(this.handleDeadStatus(t),t.currentGameState){case Xe.WORD_DESCRIPTION:this.handleWordDescriptionState(t);break;case Xe.VOTING:this.handleVotingState(t);break;default:this.setStateIdle()}},r.handleWordDescriptionState=function(t){if(this.votesContainer.active=!1,this.handleTieStatus(t),t.describingPlayerId===this.userId){this.isLocal&&this.unmuteMic(),this.playerState=Hn.DESCRIBING,this.micSprite.active=!0,this.startMicFillAnimation(),Io.Instance.miloSDK.vibratePreset("heavy");var e=t.getPlayerByUserId(this.userId);e&&(this.setTimer(e.descriptionTimer),console.log("[Player] Player "+this.userId+" description timer: "+this.timer))}else this.setStateIdle()},r.handleVotingState=function(t){this.handleTieStatus(t),this.setTimer(0),this.setStateIdle();var e=this.getLocalPlayerData(t);if(e){var n=this.shouldShowVoteButton(t,e),i=this.shouldShowVotedButton(t,e);this.voteButton.node.active=n,this.votedButton.node.active=i,e.votedSpyUserId&&this.updateVotesDisplay(t)}},r.handleDeadStatus=function(t){var e=t.getPlayerByUserId(this.userId);this.isDead=e.isDead,e.isDead?this.skull.active=!0:this.skull.active=!1},r.handleTieStatus=function(t){var e=this;t.tieBreakRound>0&&t.tiedPlayerIds.some((function(t){return t===e.userId}))?this.tieSprite.active=!0:this.tieSprite.active=!1},r.shouldShowVoteButton=function(t,e){var n=this;return console.log("should show vote button",this.isDead),this.userId!==e.userId&&(!e.isDead&&!e.votedSpyUserId&&(!this.isDead&&!(t.tieBreakRound>0&&!t.tiedPlayerIds.some((function(t){return t===n.userId})))))},r.shouldShowVotedButton=function(t,e){return!this.shouldShowVoteButton(t,e)&&e.votedSpyUserId===this.userId},r.setStateIdle=function(){this.playerState=Hn.IDLE,this.voteButton.node.active=!1,this.votedButton.node.active=!1,this.nameLabel.node.active=!0,this.micSprite.active=!1,this.votesContainer.active=!1,this.isLocal&&this.muteMic(),this.setTimer(0),this.clearVotesContainer()},r.resetState=function(){this.hasGuessedAnswer=!1,this.setStateIdle(),this.updateBgColor()},r.onVoteButtonClick=function(){var t={userId:this.userId};try{Xt.Instance.sendMessage(He.PLAYER_VOTE,t),this.voteButton.node.active=!1}catch(t){console.error("[Player] Failed to send vote message: "+t)}},r.updateVotesDisplay=function(t){var e=this;this.votesContainer.active=!0;var n=t.playersData.filter((function(t){return t.votedSpyUserId===e.userId})),i=this.voters.map((function(t){return t.userId})),o=i.filter((function(t){return!n.some((function(e){return e.userId===t}))})),r=n.filter((function(t){return!i.some((function(e){return e===t.userId}))}));this.removeVoters(o),this.addVoters(r)},r.removeVoters=function(t){var e=this;t.forEach((function(t){var n=e.voters.findIndex((function(e){return e.userId===t}));-1!==n&&(e.voters[n].node.destroy(),e.voters.splice(n,1))}))},r.addVoters=function(t){var e=this;t.forEach((function(t){var n=k(e.playerAvatarPrefab),i=n.getComponent(Gn);n.getComponent(f).setContentSize(new R(50,50)),i.initialize(!1,t.userId);var o=Io.Instance.players.find((function(e){return e.userId===t.userId}));o&&i.setAvatarFromSpriteFrame(o.playerAvatar.playerAvatar.spriteFrame),e.votesContainer.addChild(n),e.voters.push(i)}))},r.clearVotesContainer=function(){this.votesContainer.children.forEach((function(t){t.destroy()})),this.voters=[]},r.updateTimer=function(t){var e=Math.max(0,this.timer-t);this.setTimer(e)},r.setTimer=function(t){if(this.timer=t,this.roomSettings&&this.descriptionTimerSprite){this.descriptionTimerSprite.fillRange=this.timer/this.roomSettings.descriptionTimeLimit;var e=this.descriptionTimerSprite.fillRange>.3?Io.Instance.villagersColor:Io.Instance.spyColor;this.descriptionTimerSprite.color=e}},r.onReconnection=function(t){if(this.validateRoomState(t)){var e=t.getPlayerByIndex(this.index);e&&(this.loadProfile(e),this.setScore(e.score)),this.updatePlayerState(t),this.updateBgColor()}},r.onSetState=function(t){this.updatePlayerState(t)},r.handleTurnSpecificMessages=function(t){if(t.inputPayload.inputType!==He.NONE)switch(t.inputPayload.inputType){case He.SET_STATE:this.onSetState(t)}},r.handleWordsList=function(t){console.log("[Player] Received words list",t.inputPayload)},r.startMicFillAnimation=function(){if(this.micFill){var t=this.micFill.getComponent(w);t?(this.stopMicFillAnimation(),this.createMicFillFluctuationTween(t)):console.warn("[Player] MicFill sprite component not found")}else console.warn("[Player] MicFill node not found")},r.stopMicFillAnimation=function(){if(this.micFill){var t=this.micFill.getComponent(w);t&&(G(t).stop(),t.fillRange=0)}},r.createMicFillFluctuationTween=function(t){G(t).to(.3,{fillRange:.9},{easing:"sineInOut"}).to(.3,{fillRange:.1},{easing:"sineInOut"}).union().repeatForever().start()},r.getLocalPlayerData=function(t){var e=Xt.Instance.CurrentRoom.sessionId;return null==t?void 0:t.playersData.find((function(t){return t.sessionId===e}))},r.validateRoomState=function(t){return!!t||(console.error("[Player] Invalid room state"),!1)},r.muteMic=function(){this.sendReactNativeMessage({event:"muteMic",data:!0})},r.unmuteMic=function(){this.sendReactNativeMessage({event:"muteMic",data:!1})},r.sendReactNativeMessage=function(t){window.ReactNativeWebView&&(console.log("Sending message to React Native:",t),window.ReactNativeWebView&&window.ReactNativeWebView.postMessage(JSON.stringify(t)))},r.setScore=function(t){},r.setRank=function(t){this.rank=t,this.updateBgColor()},r.setGuessedAnswer=function(t){this.hasGuessedAnswer=t,this.updateBgColor()},r.highlightLocalPlayer=function(){this.nameLabel&&(this.nameLabel.color=this.localPlayerColor)},r.updateBgColor=function(){},r.setPlayerNumber=function(t){this.index=t},r.openProfile=function(){this.userId?console.log("Opening profile for user: "+this.userId):console.warn("[Player] Cannot open profile: No user ID available")},o}(h)).prototype,"index",[Qe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),vn=t(gn.prototype,"nameLabel",[qe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Sn=t(gn.prototype,"playerAvatar",[$e],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Cn=t(gn.prototype,"descriptionTimerSprite",[tn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Tn=t(gn.prototype,"voteButton",[en],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),bn=t(gn.prototype,"votedButton",[nn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Rn=t(gn.prototype,"votesContainerLeft",[on],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),En=t(gn.prototype,"votesContainerRight",[rn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_n=t(gn.prototype,"playerAvatarPrefab",[an],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),In=t(gn.prototype,"micSpriteLeft",[sn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wn=t(gn.prototype,"micLeftFill",[ln],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),An=t(gn.prototype,"micSpriteRight",[cn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Nn=t(gn.prototype,"micRightFill",[un],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),On=t(gn.prototype,"tieSprite",[hn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pn=t(gn.prototype,"skull",[pn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ln=t(gn.prototype,"addSymbol",[dn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Mn=t(gn.prototype,"avatar",[fn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mn=gn))||mn);l._RF.pop(),l._RF.push({},"80979N80XBKYK0mMy1KuHAh","Mafia_RoomState",void 0);var Bn,Wn,Un=function(){function t(){this.roundNumber=0,this.score=0,this.survived=!0}return t.prototype.copyFrom=function(t){this.roundNumber=t.roundNumber,this.score=t.score,this.survived=t.survived},t}(),xn=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).isDead=!1,e.votedSpyUserId="",e.selectedCategory="",e.describingWord="",e.descriptionTimer=0,e.roundScores=[],e}return e(n,t),n.prototype.copyFrom=function(e){t.prototype.copyFrom.call(this,e),this.isDead=e.isDead,this.votedSpyUserId=e.votedSpyUserId,this.selectedCategory=e.selectedCategory,this.describingWord=e.describingWord,this.descriptionTimer=e.descriptionTimer,this.roundScores=e.roundScores.map((function(t){var e=new Un;return e.copyFrom(t),e}))},n}(_e),Yn=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this).maxRounds=void 0,e.startRoundTimeLimit=void 0,e.categorySelectionTimeLimit=void 0,e.preparationTimeLimit=void 0,e.descriptionTimeLimit=void 0,e.votingTimeLimit=void 0,e.votingResultsTimeLimit=void 0,e.endRoundTimeLimit=void 0,e.rounds=void 0,e}return e(n,t),n.prototype.copyFrom=function(e){t.prototype.copyFrom.call(this,e),this.maxRounds=e.maxRounds,this.startRoundTimeLimit=e.startRoundTimeLimit,this.categorySelectionTimeLimit=e.categorySelectionTimeLimit,this.preparationTimeLimit=e.preparationTimeLimit,this.descriptionTimeLimit=e.descriptionTimeLimit,this.votingTimeLimit=e.votingTimeLimit,this.votingResultsTimeLimit=e.votingResultsTimeLimit,this.endRoundTimeLimit=e.endRoundTimeLimit,this.rounds=e.rounds},n}(Ie),Kn=function(){function t(){this.inputType=void 0,this.inputValue=void 0}return t.prototype.copyFrom=function(t){this.inputType=t.inputType,this.inputValue=t.inputValue},t}(),Jn=function(t){function n(){var e;return(e=t.call(this,new Yn,[])||this).inputPayload=new Kn,e.currentGameState=Xe.NONE,e.previousGameState=Xe.NONE,e.describingPlayerId="",e.category="",e.tiedPlayerIds=[],e.tieBreakRound=0,e.serverTick=0,e.currentRound=1,e.currentSpyUserId="",e}e(n,t);var i=n.prototype;return i.copyFrom=function(e){t.prototype.copyFrom.call(this,e),this.playersData=e.playersData.map((function(t){var e=new xn;return e.copyFrom(t),e})),this.spectatorsData=e.spectatorsData.map((function(t){var e=new _e;return e.copyFrom(t),e})),this.currentRoomStatus=e.currentRoomStatus,this.previousRoomStatus=e.previousRoomStatus,this.currentGameState=e.currentGameState,this.previousGameState=e.previousGameState,this.roomSettings.copyFrom(e.roomSettings),this.inputPayload.copyFrom(e.inputPayload),this.category=e.category,this.describingPlayerId=e.describingPlayerId,this.tiedPlayerIds=e.tiedPlayerIds.map((function(t){return t})),this.tieBreakRound=e.tieBreakRound,this.serverTick=e.serverTick,this.currentRound=e.currentRound,this.currentSpyUserId=e.currentSpyUserId},i.getPlayerByUserId=function(t){return this.playersData.find((function(e){return e.userId===t}))||null},i.getOnlinePlayersCount=function(){return this.playersData.filter((function(t){return t.isOnline})).length},i.getPlayerByIndex=function(t){return this.playersData.find((function(e){return e.playerNumber===t}))||null},i.getPlayerBySessionId=function(t){return this.playersData.find((function(e){return e.sessionId===t}))||null},n}(ke);l._RF.pop(),l._RF.push({},"20a0fJJBhpNX7tW3UyzQ2UF","Mafia_GameManager",void 0);var jn,Xn,Zn,Qn,qn,$n,ti,ei,ni,ii,oi,ri,ai,si,li,ci=c.ccclass,ui=c.executionOrder,hi=new p,pi=ci("MafiaGameManager")(Bn=ui(-2)(((Wn=function(t){function n(){for(var e,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))||this)._roomStatus=we.NONE,e._won=!1,e._handledGameOverCallbacks=!1,e._serverStateCopy=null,e.miloSDK=new j,e.gameStartTime=0,e}e(n,t);var i=n.prototype;return i.onLoad=function(){n._instance?this.node.destroy():(n._instance=this,this.miloSDK.init({gameId:"mafia-game",debug:!0}),this.sendGameLoaded(),this.registerEvents())},i.onDestroy=function(){this.unregisterEvents(),n._instance===this&&(n._instance=null)},i.sendGameLoaded=function(){var t={timestamp:Date.now()};this.miloSDK.gameLoaded(t)},i.sendGameStarted=function(){this.gameStartTime=Date.now();var t={timestamp:this.gameStartTime};this.miloSDK.gameStarted(t)},i.sendGameEnded=function(){var t=this,e=Date.now(),n={duration:this.gameStartTime>0?e-this.gameStartTime:0,hasWinningScreen:!1};setTimeout((function(){t.miloSDK.gameEnded(n)}),2e3)},i.registerEvents=function(){Kt.on(yt.CONNECTION_STATE_CHANGE,this.onConnectionStateChange,this),Jt.on(yt.SERVER_ROOM_STATE_CHANGE,this.onServerRoomStateChange,this)},i.unregisterEvents=function(){Kt.off(yt.CONNECTION_STATE_CHANGE,this.onConnectionStateChange,this),Jt.off(yt.SERVER_ROOM_STATE_CHANGE,this.onServerRoomStateChange,this)},i.onConnectionStateChange=function(t,e){switch(e){case vt.DISCONNECTED:this._roomStatus!==we.END_GAME&&Xt.Instance.reconnect();break;case vt.KICKED_OUT:}},i.onServerRoomStateChange=function(t){this.log("ServerRoomStateChange Message: "+t.currentRoomStatus),this.log(!this._serverStateCopy),this._serverStateCopy||(this._serverStateCopy=new Jn,this._serverStateCopy.copyFrom(t)),t.currentRoomStatus===we.END_GAME&&(console.log("Game Over"),this.handleWon(t)),this.log("Setting room status to: ",t.currentRoomStatus),this.setRoomStatus(t.currentRoomStatus)},i.resetServerState=function(t){this._serverStateCopy||(this._serverStateCopy=new Jn),this._serverStateCopy.copyFrom(t)},i.handleWon=function(t){},i.setRoomStatus=function(t){if(this._roomStatus!==t){console.log("[GameManager] ==== Room Status Change ==== :",t);var e=this._roomStatus;this._roomStatus=t,this.OnRemoteGameStateChange(t),console.log("[GameManager] Emitting room status change event"),hi.emit(yt.ROOM_STATUS_CHANGE,e,t)}},i.GetMyPlayerData=function(){var t,e=Xt.Instance.CurrentRoom.sessionId;return null==(t=this._serverStateCopy)?void 0:t.playersData.find((function(t){return t.sessionId===e}))},i.GetWinnerPlayerData=function(){return null},i.OnRemoteGameStateChange=function(t){switch(console.log("RemoteGameStateChange Message: "+t),t){case we.NONE:case we.WAITING_FOR_PLAYERS:case we.COUNTDOWN:break;case we.GAME_SIMULATION:this.sendGameStarted();break;case we.END_GAME:this.sendGameEnded(),this.HandleGameOverCallbacks();break;default:console.warn("Unhandled room status: "+t)}},i.HandleGameOverCallbacks=function(){this._handledGameOverCallbacks?console.log("Already handled game over callbacks"):this._handledGameOverCallbacks=!0},r(n,null,[{key:"Instance",get:function(){return this._instance}}]),n}(h))._instance=null,Bn=Wn))||Bn)||Bn;l._RF.pop(),l._RF.push({},"37a7fs7sUBLAKsvnT++Ytdq","Mafia_Clock",void 0);var di,fi,mi,gi,yi,vi,Si,Ci,Ti,bi,Ri,Ei,_i,Ii=c.ccclass,wi=c.property,Ai=(jn=Ii("MafiaClock"),Xn=wi({type:E,tooltip:"Clock display"}),Zn=wi({type:I,tooltip:"Timer label with button"}),Qn=wi({type:I}),qn=wi({type:E}),$n=wi({type:E}),ti=wi({type:I}),jn((ii=t((ni=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"clockContainer",ii,i(e)),n(e,"timerLabel",oi,i(e)),n(e,"infoLabel",ri,i(e)),n(e,"button",ai,i(e)),n(e,"clock",si,i(e)),n(e,"speakingLabel",li,i(e)),e.timer=0,e.localPlayerId="",e.isClockAnimating=!1,e.initialClockContainerPosition=new _(0,0,0),e.initialClockContainerAngle=0,e.clockAnimationTween=null,e}e(o,t);var r=o.prototype;return r.initialize=function(t){this.localPlayerId=pi.Instance.GetMyPlayerData().userId,this.initialClockContainerPosition=this.clockContainer.position.clone(),this.initialClockContainerAngle=this.clockContainer.angle},r.update=function(t){this.timer<=0||(this.updateTimer(t),this.updateTimerDisplay())},r.updateTimer=function(t){this.timer=Math.max(0,this.timer-t)},r.updateTimerDisplay=function(){var t=Math.floor(this.timer)+"s";this.timerLabel.string=t;var e=this.timer>5?Io.Instance.villagersColor:Io.Instance.spyColor;if(this.timerLabel.color=e,this.timer<=3&&this.timer>0){var n=Io.Instance.getRoomState();n&&(n.currentGameState===Xe.WORD_DESCRIPTION||n.currentGameState===Xe.VOTING)&&this.animateLowTimeClock(this.clock)}},r.animateLowTimeClock=function(t){var e=this;if(!this.isClockAnimating){this.isClockAnimating=!0;var n=this.initialClockContainerPosition.clone(),i=this.initialClockContainerAngle;this.clockAnimationTween=G(t).to(.2,{position:new _(n.x,n.y+20,n.z)}).to(.1,{angle:i+15}).to(.1,{angle:i-15}).to(.1,{angle:i+15}).to(.1,{angle:i-15}).to(.1,{angle:i+15}).to(.1,{angle:i-15}).to(.1,{angle:i+15}).to(.1,{angle:i-15}).to(.1,{angle:i+15}).to(.1,{angle:i-15}).to(.1,{angle:i+15}).to(.1,{angle:i-15}).to(.1,{angle:i+15}).to(.1,{angle:i-15}).to(.1,{angle:i+15}).to(.1,{angle:i-15}).to(.1,{angle:i+15}).to(.1,{angle:i-15}).to(.1,{angle:i+15}).to(.1,{angle:i-15}).to(.1,{angle:i+15}).to(.1,{angle:i-15}).to(.1,{angle:i+15}).to(.1,{angle:i-15}).to(.1,{angle:i+15}).to(.1,{angle:i-15}).to(.2,{position:n,angle:i}).call((function(){e.isClockAnimating=!1})).start()}},r.setTimer=function(t){this.timer=t,this.updateTimerDisplay()},r.onServerRoomStateChange=function(t){switch(t.currentGameState){case Xe.WORD_DESCRIPTION:this.handleWordDescriptionState(t);break;case Xe.VOTING:this.handleVotingState(t);break;default:this.hideAllClocks()}},r.handleWordDescriptionState=function(t){var e=t.describingPlayerId===this.localPlayerId;if(this.setTimer(t.roomSettings.descriptionTimeLimit),this.infoLabel.string="Your turn to Speak",e)this.showActivePlayerClock(),this.button.active=!0;else{this.hideAllClocks(),this.speakingLabel.node.active=!0;var n=t.getPlayerByUserId(t.describingPlayerId),i=this.truncateName(n.name);n&&(this.speakingLabel.string=i+" is Speaking")}},r.handleVotingState=function(t){this.setTimer(t.roomSettings.votingTimeLimit),this.showActivePlayerClock(),this.infoLabel.string="Time to Vote",this.button.active=!1},r.showActivePlayerClock=function(){this.resetClockAnimation(),this.clockContainer.active=!0,this.speakingLabel.node.active=!1},r.hideAllClocks=function(){this.clockContainer.active=!1,this.speakingLabel.node.active=!1,this.resetClockAnimation()},r.resetClockAnimation=function(){this.clockAnimationTween&&this.clockAnimationTween.stop(),this.clock.angle=this.initialClockContainerAngle,this.clock.position=this.initialClockContainerPosition.clone(),this.isClockAnimating=!1},r.onButtonClick=function(){Xt.Instance.sendMessage(He.PLAYER_DONE_DESCRIBING,"")},r.truncateName=function(t){var e=t.split(" ")[0];return e.length>8?e.substring(0,8)+"...":e},o}(h)).prototype,"clockContainer",[Xn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),oi=t(ni.prototype,"timerLabel",[Zn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ri=t(ni.prototype,"infoLabel",[Qn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ai=t(ni.prototype,"button",[qn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),si=t(ni.prototype,"clock",[$n],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),li=t(ni.prototype,"speakingLabel",[ti],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ei=ni))||ei);l._RF.pop(),l._RF.push({},"07b70sAjVpJwaiP6JfloUn9","Mafia_TopInfo",void 0);var Ni,Oi,Pi,Li,Mi,Di,ki,Gi,Fi,zi,Hi,Vi,Bi,Wi,Ui,xi,Yi,Ki,Ji,ji=c.ccclass,Xi=c.property,Zi=(di=ji("MafiaTopInfo"),fi=Xi({type:I,tooltip:"Label for the top info"}),mi=Xi({type:E,tooltip:"Villager info node"}),gi=Xi({type:E,tooltip:"Spy info node"}),yi=Xi({type:I,tooltip:"Villager word description"}),vi=Xi({type:I,tooltip:"Spy word description"}),di((Ti=t((Ci=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"gameStateLabel",Ti,i(e)),n(e,"villagerInfoNode",bi,i(e)),n(e,"spyInfoNode",Ri,i(e)),n(e,"villagerWordDescription",Ei,i(e)),n(e,"spyWordDescription",_i,i(e)),e.localPlayerId="",e}e(o,t);var r=o.prototype;return r.start=function(){},r.update=function(t){},r.initialize=function(t){this.localPlayerId=pi.Instance.GetMyPlayerData().userId},r.onServerRoomStateChange=function(t){this.updateGameStateLabel(t.currentGameState),t.currentGameState===Xe.WORD_DESCRIPTION&&this.updateRoleInfo(t)},r.updateGameStateLabel=function(t){var e,n=((e={})[Xe.WORD_DESCRIPTION]="Describe",e[Xe.VOTING]="Voting",e[Xe.GAME_OVER]="Game Over",e);this.gameStateLabel.string=n[t]||"Describe"},r.updateRoleInfo=function(t){var e=t.currentSpyUserId===this.localPlayerId;this.villagerInfoNode.active=!e,this.spyInfoNode.active=e;var n=this.getPlayerFromState(t,this.localPlayerId),i=e?this.spyWordDescription:this.villagerWordDescription;n&&i&&(i.string="Word: "+n.describingWord)},r.getPlayerFromState=function(t,e){return t.playersData.find((function(t){return t.userId===e}))},o}(h)).prototype,"gameStateLabel",[fi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),bi=t(Ci.prototype,"villagerInfoNode",[mi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ri=t(Ci.prototype,"spyInfoNode",[gi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ei=t(Ci.prototype,"villagerWordDescription",[yi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_i=t(Ci.prototype,"spyWordDescription",[vi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Si=Ci))||Si);l._RF.pop(),l._RF.push({},"87cedknW3FJRbtrrFF3SX9G","MafiaGameHandler",void 0);var Qi,qi,$i,to,eo,no,io,oo,ro,ao,so,lo,co,uo,ho,po,fo,mo,go,yo,vo,So,Co,To=c.ccclass,bo=c.property,Ro=c.executionOrder,Eo="[MafiaGameHandler]",_o=new p,Io=(Ni=To("MafiaGameHandler"),Oi=Ro(-1),Pi=bo({type:E,tooltip:"Container node for player instances"}),Li=bo({type:Zi,tooltip:"Reference to top info component"}),Mi=bo({type:Ai,tooltip:"Reference to game timer component"}),Di=bo({type:ze,tooltip:"Reference to game timer component"}),ki=bo({type:D,tooltip:"Color for the spy"}),Gi=bo({type:D,tooltip:"Color for the villagers"}),Fi=bo({type:[Vn]}),Ni(zi=Oi(((Ji=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"playersContainer",Vi,i(e)),n(e,"topInfo",Bi,i(e)),n(e,"clock",Wi,i(e)),n(e,"timer",Ui,i(e)),n(e,"spyColor",xi,i(e)),n(e,"villagersColor",Yi,i(e)),n(e,"players",Ki,i(e)),e.miloSDK=new j,e.currentRoomState=null,e.roomSettings=null,e.myPlayerNumber=-1,e.hasReconnected=!1,e.localPlayerId="",e}e(o,t);var a=o.prototype;return a.onLoad=function(){o._instance?this.node.destroy():(o._instance=this,this.validateRequiredComponents(),this.registerEventListeners())},a.onDestroy=function(){this.unregisterEventListeners(),o._instance===this&&(o._instance=null)},a.initialize=function(t){this.roomSettings=t,this.logInfo("Initialized with room settings",t)},a.validateRequiredComponents=function(){0===this.players.length&&this.logError("No players UI assigned"),this.playersContainer||this.logError("Players container not assigned"),this.timer||this.logError("Timer component not assigned")},a.registerEventListeners=function(){this.registerNetworkEvents(),this.registerGameEvents(),this.registerOnBrowserClose()},a.unregisterEventListeners=function(){this.unregisterNetworkEvents(),this.unregisterGameEvents(),this.unregisterOnBrowserClose()},a.registerNetworkEvents=function(){Kt.on(yt.CONNECTION_STATE_CHANGE,this.onConnectionStateChange,this),Jt.on(yt.SERVER_ROOM_STATE_CHANGE,this.onServerRoomStateChange,this),jt.on(yt.SERVER_MESSAGE,this.onServerMessage,this)},a.unregisterNetworkEvents=function(){Kt.off(yt.CONNECTION_STATE_CHANGE,this.onConnectionStateChange,this),Jt.off(yt.SERVER_ROOM_STATE_CHANGE,this.onServerRoomStateChange,this),jt.off(yt.SERVER_MESSAGE,this.onServerMessage,this)},a.registerGameEvents=function(){F.on(z.EVENT_HIDE,this.onGameHide,this),F.on(z.EVENT_SHOW,this.onGameShow,this),F.on(z.EVENT_RESTART,this.onGameRestart,this),F.on(z.EVENT_CLOSE,this.onGameClose,this)},a.unregisterGameEvents=function(){F.off(z.EVENT_HIDE,this.onGameHide,this),F.off(z.EVENT_SHOW,this.onGameShow,this),F.off(z.EVENT_RESTART,this.onGameRestart,this),F.off(z.EVENT_CLOSE,this.onGameClose,this)},a.registerOnBrowserClose=function(){window.addEventListener("beforeunload",this.onGameClose.bind(this))},a.unregisterOnBrowserClose=function(){window.removeEventListener("beforeunload",this.onGameClose.bind(this))},a.onServerMessage=function(t,e){this.logInfo("Server message received:",{type:t,message:e}),this.logInfo("Unhandled server message type:",t)},a.onServerRoomStateChange=function(t){this.currentRoomState?(this.currentRoomState.copyFrom(t),this.currentRoomState.currentRoomStatus!==we.END_GAME?this.hasReconnected?this.handleReconnection(this.currentRoomState):(this.handleRoomStateUpdate(this.currentRoomState),this.notifyComponentsOfStateChange(this.currentRoomState)):this.handleEndGameState()):this.initializeRoomState(t)},a.onConnectionStateChange=function(t,e){e===vt.DISCONNECTED?this.onGameDisconnect():t===vt.RECONNECTING&&e===vt.JOINED_ROOM&&(this.hasReconnected=!0,this.onGameReconnect())},a.onGameHide=function(){this.logInfo("Game hidden"),H.stopAll()},a.onGameShow=function(){this.logInfo("Game shown")},a.onGameRestart=function(){this.logInfo("Game restarted")},a.onGameClose=function(){this.logInfo("Game closed")},a.onGameDisconnect=function(){this.logInfo("Game disconnected")},a.onGameReconnect=function(){this.logInfo("Game reconnected")},a.initializeRoomState=function(t){t?(this.currentRoomState=new Jn,this.currentRoomState.copyFrom(t),this.initializeGameComponents(this.currentRoomState),this.currentRoomState.currentGameState!==Xe.NONE&&(this.logInfo("Joined game in progress with state:",this.currentRoomState.currentGameState),this.sendReconnectionStateToAllPlayers(this.currentRoomState))):this.logError("Attempted to initialize with null room state")},a.initializeGameComponents=function(t){this.assignMyPlayerNumber(t),this.initializePlayers(t),this.initializeTopInfo(t),this.initializeClock(t)},a.handleEndGameState=function(){this.logInfo("Game Over - State Change:",this.currentRoomState)},a.handleReconnection=function(t){this.logInfo("Reconnection State Change:",t),this.sendReconnectionStateToAllPlayers(t),this.hasReconnected=!1},a.handleRoomStateUpdate=function(t){this.logInfo("Game State Change:",t.currentGameState),t.inputPayload.inputType===He.SET_STATE&&this.handleSetState(t)},a.handleSetState=function(t){this.logInfo("Handling SET STATE"),this.timer.reset(),this.timer.stopTimer(),this.logInfo("Game State Change:",t.currentGameState),_o.emit(yt.GAME_STATE_CHANGE,t.currentGameState)},a.notifyComponentsOfStateChange=function(t){this.sendRoomStateToAllPlayers(t),this.sendRoomStateToTopInfo(t),this.sendRoomStateToClock(t)},a.initializePlayers=function(t){var e=this;this.logInfo("Initializing "+t.playersData.length+" players");var n=t.playersData.findIndex((function(t){return t.sessionId===Xt.Instance.CurrentRoom.sessionId})),i=0;-1!==n&&(this.players[i].initialize(t,n,!0),i++);t.playersData.forEach((function(o,r){r!==n&&(e.players[i].initialize(t,r,i%2==0),i++)}))},a.updatePlayerScores=function(){var t=this;this.currentRoomState&&[].concat(this.currentRoomState.playersData).sort((function(t,e){return e.score-t.score})).forEach((function(e,n){var i=t.players.find((function(t){return t.userId===e.userId}));i&&i.node&&(i.setScore(e.score),i.setRank(n+1),i.node.setSiblingIndex(n))}))},a.getPlayer=function(t){if(t)return this.players.find((function(e){return e.userId===t}));this.logWarning("Attempted to get player with empty ID")},a.assignMyPlayerNumber=function(t){var e=this;t.playersData.forEach((function(t,n){t.sessionId===Xt.Instance.CurrentRoom.sessionId&&(e.myPlayerNumber=n,e.localPlayerId=t.userId)}))},a.getPlayerName=function(t){var e;return(null==(e=this.players.find((function(e){return e.userId===t})))?void 0:e.playerName)||t},a.initializeTopInfo=function(t){this.topInfo.initialize(t)},a.initializeClock=function(t){this.clock.initialize(t)},a.sendRoomStateToAllPlayers=function(t){this.players.forEach((function(e){e.onServerRoomStateChange(t)}))},a.sendRoomStateToTopInfo=function(t){this.topInfo.onServerRoomStateChange(t)},a.sendRoomStateToClock=function(t){this.clock.onServerRoomStateChange(t)},a.sendReconnectionStateToAllPlayers=function(t){this.logInfo("Reconnection state sent to all players"),this.players.forEach((function(e){e.onReconnection(t)}))},a.getRoomState=function(){return this.currentRoomState},a.isMyTurn=function(){return!1},a.allPlayersFinished=function(){return!1},a.anyPlayerFinished=function(){return!1},a.sendChatMessageToServer=function(t){},a.logInfo=function(t,e){dt.info(Eo+" "+t,e)},a.logError=function(t,e){dt.error(Eo+" "+t,e)},a.logWarning=function(t,e){dt.warning(Eo+" "+t,e)},a.logDebug=function(t,e){dt.debug(Eo+" "+t,e)},a.log=function(t,e,n){void 0===n&&(n="info");var i=Eo+" "+t;switch(n){case"error":dt.error(i,e);break;case"warn":dt.warning(i,e);break;case"debug":dt.debug(i,e);break;default:dt.info(i,e)}},a.TruncateName=function(t,e){return void 0===e&&(e=8),t?t.length>e?t.substring(0,e)+"..":t:""},r(o,null,[{key:"Instance",get:function(){if(!this._instance)throw dt.error(Eo+" instance not initialized"),new Error("MafiaGameHandler instance not initialized");return this._instance}}]),o}(h))._instance=null,Vi=t((Hi=Ji).prototype,"playersContainer",[Pi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Bi=t(Hi.prototype,"topInfo",[Li],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Wi=t(Hi.prototype,"clock",[Mi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ui=t(Hi.prototype,"timer",[Di],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xi=t(Hi.prototype,"spyColor",[ki],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new D(255,0,0,255)}}),Yi=t(Hi.prototype,"villagersColor",[Gi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new D(0,0,255,255)}}),Ki=t(Hi.prototype,"players",[Fi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),zi=Hi))||zi)||zi);l._RF.pop(),l._RF.push({},"583b9vAPVFLKIWeORwwOp7K","Mafia_AudioManager",void 0);var wo,Ao,No,Oo,Po,Lo,Mo,Do=c.ccclass,ko=c.property,Go=(Qi=Do("MafiaAudioClipData"),qi=ko({type:V}),$i=ko({type:B}),to=ko({type:W}),eo=ko({type:W}),no=ko({type:d}),Qi((ro=t((oo=function(){function t(){n(this,"name",ro,this),n(this,"audioClips",ao,this),n(this,"delayBetweenClips",so,this),n(this,"volume",lo,this),n(this,"loop",co,this),this.isLoopPlaying=void 0,this.lastPlayedTime=0,this.clipIndex=0}var e=t.prototype;return e.GetClip=function(){var t=this.audioClips[this.clipIndex];if(this.clipIndex=(this.clipIndex+1)%this.audioClips.length,this.CanPlay())return this.lastPlayedTime=Date.now(),t},e.CanPlay=function(){return Date.now()-this.lastPlayedTime>1e3*this.delayBetweenClips},t}()).prototype,"name",[qi],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ao=t(oo.prototype,"audioClips",[$i],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),so=t(oo.prototype,"delayBetweenClips",[to],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),lo=t(oo.prototype,"volume",[eo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),co=t(oo.prototype,"loop",[no],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),io=oo))||io),Fo=(uo=Do("MafiaAudioManager"),ho=ko({type:Go}),po=ko({type:U}),fo=ko({type:M}),uo(((Co=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"audioClipData",yo,i(e)),n(e,"backgroundAudioSource",vo,i(e)),e.localStorageAudioEnabledKey="SNLAudioEnabled",n(e,"audioSourcePrefab",So,i(e)),e.audioSources=[],e._isAudioEnabled="true",e}e(o,t);var a=o.prototype;return a.onLoad=function(){o.instance=this,this.ReadAudioEnabledFromLocalStorage()},a.start=function(){this.SetAudioEnabled(this.IsAudioEnabled)},a.playSound=function(t){if("false"!=this.IsAudioEnabled){var e=this.audioClipData.find((function(e){return e.name==t}));if(null!=e){var n=e.GetClip();if(n){if(e.isLoopPlaying)return;var i=this.getEmptyAudioSource();i.loop=e.loop,e.isLoopPlaying=e.loop,i.volume=e.volume,i.clip=n,e.loop?i.play():i.playOneShot(n)}else console.warn("Audio Clip is in use ",t)}}},a.stopSound=function(t){var e=this.audioClipData.find((function(e){return e.name==t}));e?this.audioSources.forEach((function(t){t.clip==e.audioClips[e.clipIndex]&&(e.isLoopPlaying=!1,t.stop())})):console.warn("Audio Clip not found for ",t)},a.stopAllSounds=function(){this.audioSources.forEach((function(t){t.stop()})),this.audioClipData.forEach((function(t){t.isLoopPlaying=!1}))},a.ToggleAudio=function(){"true"==this.IsAudioEnabled?this.SetAudioEnabled("false"):this.SetAudioEnabled("true")},a.SetAudioEnabled=function(t){this._isAudioEnabled=t,this.UpdateBackgroundMusic(),this.WriteAudioEnabledToLocalStorage()},a.WriteAudioEnabledToLocalStorage=function(){u.localStorage.setItem(this.localStorageAudioEnabledKey,this.IsAudioEnabled)},a.ReadAudioEnabledFromLocalStorage=function(){var t=u.localStorage.getItem(this.localStorageAudioEnabledKey);this._isAudioEnabled=null==t?"true":t},a.UpdateBackgroundMusic=function(){var t,e;"true"==this.IsAudioEnabled?null==(t=this.backgroundAudioSource)||t.play():null==(e=this.backgroundAudioSource)||e.stop()},a.printAllPlayingAudioSources=function(){this.audioSources.forEach((function(t){t.playing&&console.log("Playing audio source: ",t.playing,t.clip.name,t.uuid)}))},a.getEmptyAudioSource=function(){var t=this.audioSources.find((function(t){return!t.playing}));return null==t&&(t=this.createAudioSource()),t},a.createAudioSource=function(){var t=k(this.audioSourcePrefab).getComponent(U);return t.node.setParent(this.node),this.audioSources.push(t),console.log("==== Created new audio source: ",this.audioSources.length),t},r(o,[{key:"IsAudioEnabled",get:function(){return this._isAudioEnabled}}]),o}(h)).instance=null,yo=t((go=Co).prototype,"audioClipData",[ho],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),vo=t(go.prototype,"backgroundAudioSource",[po],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),So=t(go.prototype,"audioSourcePrefab",[fo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mo=go))||mo);l._RF.pop(),l._RF.push({},"8c5d0A4WHpGsL9G+FTlKBPq","Mafia_Menu",void 0);var zo,Ho,Vo,Bo,Wo,Uo=c.ccclass,xo=c.property,Yo=(wo=Uo("MafiaMenu"),Ao=xo({type:E}),No=xo({type:V}),wo((Lo=t((Po=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"content",Lo,i(e)),n(e,"menuName",Mo,i(e)),e.isOpened=!1,e}e(o,t);var r=o.prototype;return r.onLoad=function(){null==this.content&&(this.content=this.node.getChildByName("Content"))},r.Open=function(){this.content.active=!0,this.isOpened=!0},r.Close=function(){this.content.active=!1,this.isOpened=!1},r.initialize=function(){dt.info("Menu initialize called")},o}(h)).prototype,"content",[Ao],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Mo=t(Po.prototype,"menuName",[No],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Oo=Po))||Oo);l._RF.pop(),l._RF.push({},"3dc1dnlbAFCt5Kw25yShK3d","Mafia_CountDownScreen",void 0);var Ko,Jo,jo,Xo,Zo,Qo,qo,$o,tr,er,nr,ir,or,rr,ar,sr,lr,cr,ur,hr,pr,dr=c.ccclass,fr=c.property;zo=dr("MafiaCountdownScreen"),Ho=fr({type:I}),zo((Wo=t((Bo=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(e=t.call.apply(t,[this].concat(r))||this)._countdownTween=null,n(e,"countdownText",Wo,i(e)),e}e(o,t);var r=o.prototype;return r.onLoad=function(){t.prototype.onLoad.call(this)},r.onDestroy=function(){},r.Open=function(){t.prototype.Open.call(this),this.initialization()},r.Close=function(){t.prototype.Close.call(this),null!=this._countdownTween&&this._countdownTween.stop()},r.initCountdownTween=function(){var t=this;this.countdownText.node.active=!0,this._countdownTween=G(this.countdownText.node);for(var e=function(e){t._countdownTween.call((function(){t.countdownText.string=e.toString(),t.countdownText.node.scale=_.ONE.clone().multiplyScalar(2)})).to(.4,{scale:_.ONE.clone().multiplyScalar(1)},{easing:"sineIn"}).delay(.6).start()},n=3;n>=1;n--)e(n);this._countdownTween.call((function(){t.deactivateScreen()}))},r.deactivateScreen=function(){this.countdownText.string="",this.countdownText.node.active=!1},r.initialization=function(){this.initCountdownTween(),this._countdownTween.start()},o}(Yo)).prototype,"countdownText",[Ho],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Vo=Bo));l._RF.pop(),l._RF.push({},"623bfmdNW1Ds6bkt4iZR28n","Mafia_EndRoundScreen",void 0);var mr,gr,yr,vr,Sr,Cr,Tr,br,Rr,Er,_r,Ir,wr,Ar,Nr,Or,Pr,Lr,Mr,Dr=c.ccclass,kr=c.property,Gr="[EndRoundScreen]";Ko=Dr("MafiaEndRoundScreen"),Jo=kr({type:w,tooltip:"Background"}),jo=kr({type:I,tooltip:"Heading"}),Xo=kr({type:x,tooltip:"Players Layout"}),Zo=kr({type:Gn,tooltip:"Spy Avatar"}),Qo=kr({type:I,tooltip:"Spy Name"}),qo=kr({type:E,tooltip:"Villagers Container"}),$o=kr({type:M,tooltip:"Avatar with name"}),tr=kr({type:I,tooltip:"Spy Word"}),er=kr({type:I,tooltip:"Villagers Word"}),Ko((or=t((ir=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"headingBackground",or,i(e)),n(e,"heading",rr,i(e)),n(e,"playersLayout",ar,i(e)),n(e,"spyAvatar",sr,i(e)),n(e,"spyName",lr,i(e)),n(e,"villagersContainer",cr,i(e)),n(e,"avatarWithName",ur,i(e)),n(e,"spyWord",hr,i(e)),n(e,"villagersWord",pr,i(e)),e.villagers=[],e}e(o,t);var r=o.prototype;return r.Open=function(){t.prototype.Open.call(this),this.setupScreen()},r.Close=function(){t.prototype.Close.call(this)},r.setupScreen=function(){var t=Io.Instance.getRoomState();if(t){var e=t.playersData.find((function(e){return e.userId===t.currentSpyUserId}));if(e){var n=!e.isDead;this.updateScreenHeader(n),this.updateSpyDisplay(),this.updateVillagersDisplay(),this.updateWords()}else console.error(Gr+" Cannot find spy player with ID: "+t.currentSpyUserId)}else console.error(Gr+" Cannot setup screen: Room state is null")},r.updateScreenHeader=function(t){var e=Io.Instance;this.heading.string=t?"Villagers Failed":"Spies Failed",this.headingBackground.color=t?e.spyColor:e.villagersColor,this.playersLayout.verticalDirection=t?1:0},r.updateSpyDisplay=function(){var t=Io.Instance,e=t.getRoomState();if(e){var n=e.playersData.find((function(t){return t.userId===e.currentSpyUserId}));if(n){var i=t.getPlayer(n.userId);i&&(this.spyAvatar.setAvatarFromSpriteFrame(i.playerAvatar.playerAvatar.spriteFrame),this.spyName.string=i.playerName,this.spyAvatar.ShowSkull(n.isDead))}}},r.updateVillagersDisplay=function(){var t=Io.Instance.getRoomState();if(t){var e=t.currentSpyUserId,n=t.playersData.filter((function(t){return t.userId!==e})),i=this.villagers.map((function(t){return t.userId}));this.removeOldVillagers(i,n),this.addNewVillagers(i,n)}},r.removeOldVillagers=function(t,e){var n=this;this.villagers.filter((function(t){return!e.some((function(e){return e.userId===t.userId}))})).forEach((function(t){var e=n.villagers.indexOf(t);-1!==e&&(n.villagers.splice(e,1),t.node.destroy())}))},r.addNewVillagers=function(t,e){var n=this;e.filter((function(e){return!t.some((function(t){return t===e.userId}))})).forEach((function(t){n.createVillagerDisplay(t)}))},r.createVillagerDisplay=function(t){var e,n=Io.Instance,i=n.getPlayer(t.userId);if(i){var o=k(this.avatarWithName),r=o.getComponent(Gn),a=null==(e=o.getChildByName("Name"))?void 0:e.getComponent(I);if(!r||!a)return console.error(Gr+" Failed to get components from villager prefab"),void o.destroy();r.setAvatarFromSpriteFrame(i.playerAvatar.playerAvatar.spriteFrame),a.string=n.TruncateName(i.playerName),r.initialize(!1,t.userId),this.villagers.push(r),this.villagersContainer.addChild(o),r.ShowSkull(t.isDead)}},r.updateWords=function(){var t=Io.Instance.getRoomState();if(t){var e=t.playersData.find((function(e){return e.userId===t.currentSpyUserId})),n=t.playersData.find((function(e){return e.userId!==t.currentSpyUserId}));e&&n&&(this.spyWord.string=e.describingWord,this.villagersWord.string=n.describingWord)}},o}(Yo)).prototype,"headingBackground",[Jo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),rr=t(ir.prototype,"heading",[jo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ar=t(ir.prototype,"playersLayout",[Xo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),sr=t(ir.prototype,"spyAvatar",[Zo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),lr=t(ir.prototype,"spyName",[Qo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),cr=t(ir.prototype,"villagersContainer",[qo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ur=t(ir.prototype,"avatarWithName",[$o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),hr=t(ir.prototype,"spyWord",[tr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pr=t(ir.prototype,"villagersWord",[er],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),nr=ir));l._RF.pop(),l._RF.push({},"4952cIc/PlMopoNID/uP+1K","Mafia_PreparationScreen",void 0);var Fr,zr,Hr,Vr,Br,Wr=c.ccclass,Ur=c.property,xr="[PreparationScreen]";mr=Wr("MafiaPreparationScreen"),gr=Ur({type:E,tooltip:"Container for the word display"}),yr=Ur({type:E,tooltip:"Container for instructions"}),vr=Ur({type:I,tooltip:"Word label"}),Sr=Ur({type:w,tooltip:"Background for word"}),Cr=Ur({type:I,tooltip:"Role label"}),Tr=Ur({type:W,tooltip:"Time to display the word"}),br=Ur({type:D,tooltip:"Color for villager UI"}),Rr=Ur({type:D,tooltip:"Color for spy UI"}),mr((Ir=t((_r=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"wordContainer",Ir,i(e)),n(e,"instructionContainer",wr,i(e)),n(e,"word",Ar,i(e)),n(e,"wordBgSprite",Nr,i(e)),n(e,"youAreLabel",Or,i(e)),n(e,"wordTimeLimit",Pr,i(e)),n(e,"villagerColor",Lr,i(e)),n(e,"spyColor",Mr,i(e)),e.VILLAGER_TEXT="You are a Villager!",e.SPY_TEXT="You are the Spy!",e}e(o,t);var r=o.prototype;return r.Open=function(){t.prototype.Open.call(this),this.setupScreen()},r.setupScreen=function(){this.updateRoleDisplay(),this.showWordThenInstructions()},r.updateRoleDisplay=function(){var t=Io.Instance.getRoomState();if(t){var e=Xt.Instance.getMySessionId(),n=t.getPlayerBySessionId(e);if(n){var i=n.userId===t.currentSpyUserId;this.word.string=n.describingWord,i?(console.log(xr+" Playing SpyWord sound"),Fo.instance.playSound("SpyWord"),this.applySpyStyles()):this.applyVillagerStyles()}else console.error(xr+" Cannot find player data for session ID: "+e)}else console.error(xr+" Cannot setup screen: Room state is null")},r.applySpyStyles=function(){this.wordBgSprite.color=this.spyColor,this.youAreLabel.string=this.SPY_TEXT,this.word.color=this.spyColor},r.applyVillagerStyles=function(){this.wordBgSprite.color=this.villagerColor,this.youAreLabel.string=this.VILLAGER_TEXT,this.word.color=this.villagerColor},r.showWordThenInstructions=function(){this.instructionContainer.active=!1,this.wordContainer.active=!0,this.animateWordContainer(),this.scheduleOnce(this.transitionToInstructions,this.wordTimeLimit)},r.animateWordContainer=function(){this.wordContainer.scale=new _(1.2,1.2,1);var t=this.wordContainer.getComponent(Y);t||(t=this.wordContainer.addComponent(Y)),t.opacity=0,G(this.wordContainer).to(.2,{scale:new _(1,1,1)}).start(),G(t).to(.2,{opacity:255}).start()},r.transitionToInstructions=function(){this.wordContainer.active=!1,this.instructionContainer.active=!0,this.animateInstructionsContainer()},r.animateInstructionsContainer=function(){this.instructionContainer.scale=new _(1.2,1.2,1);var t=this.instructionContainer.getComponent(Y);t||(t=this.instructionContainer.addComponent(Y)),t.opacity=0,G(this.instructionContainer).to(.2,{scale:new _(1,1,1)}).start(),G(t).to(.2,{opacity:255}).start()},o}(Yo)).prototype,"wordContainer",[gr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wr=t(_r.prototype,"instructionContainer",[yr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ar=t(_r.prototype,"word",[vr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Nr=t(_r.prototype,"wordBgSprite",[Sr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Or=t(_r.prototype,"youAreLabel",[Cr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pr=t(_r.prototype,"wordTimeLimit",[Tr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 5}}),Lr=t(_r.prototype,"villagerColor",[br],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new D(0,0,0,1)}}),Mr=t(_r.prototype,"spyColor",[Rr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new D(0,0,0,1)}}),Er=_r));l._RF.pop(),l._RF.push({},"28432gn1jZNmoVOMCSvOamH","Mafia_StartRoundScreen",void 0);var Yr,Kr,Jr,jr,Xr,Zr,Qr,qr,$r,ta,ea=c.ccclass,na=c.property;Fr=ea("MafiaStartRoundScreen"),zr=na({type:I,tooltip:"Label displaying the current round number"}),Fr((Br=t((Vr=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"roundCountLabel",Br,i(e)),e.roundTween=null,e.INITIAL_SCALE=2,e.FINAL_SCALE=1,e.ANIMATION_DURATION=.4,e}e(o,t);var r=o.prototype;return r.Open=function(){t.prototype.Open.call(this),this.updateRoundCount()},r.Close=function(){this.stopActiveTween(),t.prototype.Close.call(this)},r.updateRoundCount=function(){var t=Io.Instance.getRoomState();if(t){var e=t.currentRound;this.stopActiveTween(),this.resetLabelScale(),this.updateLabelText(e),this.animateLabel()}else console.error("[StartRoundScreen] Cannot update round count: Room state is null")},r.stopActiveTween=function(){this.roundTween&&(this.roundTween.stop(),this.roundTween=null)},r.resetLabelScale=function(){var t=new _(this.INITIAL_SCALE,this.INITIAL_SCALE,1);this.roundCountLabel.node.setScale(t)},r.updateLabelText=function(t){this.roundCountLabel.string="Round "+t},r.animateLabel=function(){var t=new _(this.FINAL_SCALE,this.FINAL_SCALE,1);this.roundTween=G(this.roundCountLabel.node).to(this.ANIMATION_DURATION,{scale:t},{easing:"sineIn"}).delay(1).start()},o}(Yo)).prototype,"roundCountLabel",[zr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Hr=Vr));l._RF.pop(),l._RF.push({},"a805dDOrVBG5KVSZZ4CAGEg","Mafia_UIManager",void 0);var ia,oa,ra,aa,sa,la,ca,ua,ha,pa,da,fa,ma,ga,ya,va,Sa,Ca,Ta,ba,Ra,Ea,_a,Ia,wa,Aa,Na,Oa=c.ccclass,Pa=c.property,La=(Yr=Oa("MafiaUIManager"),Kr=Pa({type:m}),Jr=Pa({type:[Yo]}),jr=Pa({type:E}),Yr(((ta=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"uiCamera",Qr,i(e)),n(e,"menus",qr,i(e)),n(e,"flashNode",$r,i(e)),e.showMuteButton=!0,e.showResultScreen=!0,e.showFAQ=!0,e}e(o,t);var r=o.prototype;return r.onLoad=function(){o.instance=this,Kt.on(yt.CONNECTION_STATE_CHANGE,this.onConnectionStateChange,this),hi.on(yt.ROOM_STATUS_CHANGE,this.onRoomStatusChange,this),jt.on(yt.SERVER_MESSAGE,this.onServerMessage,this),_o.on(yt.GAME_STATE_CHANGE,this.onGameStateChange,this)},r.onDestroy=function(){Kt.off(yt.CONNECTION_STATE_CHANGE,this.onConnectionStateChange,this),hi.off(yt.ROOM_STATUS_CHANGE,this.onRoomStatusChange,this),jt.off(yt.SERVER_MESSAGE,this.onServerMessage,this),_o.off(yt.GAME_STATE_CHANGE,this.onGameStateChange,this)},r.start=function(){this.OpenMenu("InGameMenu")},r.onCameraOrthoSizeChange=function(t){console.log("[UIManager] Camera ortho size changed: ",t),this.uiCamera.orthoHeight=t},r.OpenHowToPlay=function(){this.OpenMenu("HowToPlay")},r.OpenMenu=function(t){for(var e=0;e<this.menus.length;e++)this.menus[e].menuName==t&&this.menus[e].Open()},r.CloseMenu=function(t){for(var e=0;e<this.menus.length;e++)this.menus[e].menuName==t&&this.menus[e].Close()},r.GetMenu=function(t){for(var e=0;e<this.menus.length;e++)if(this.menus[e].menuName==t)return this.menus[e];return null},r.CloseAllMenus=function(){for(var t=0;t<this.menus.length;t++)this.menus[t].Close()},r.onConnectionStateChange=function(t,e){switch(console.log("[UIManager] Connection state changed: ",e),e){case vt.CONNECTING:this.CloseAllMenus(),this.OpenMenu("InGameMenu")}},r.onGameStateChange=function(t){switch(t){case Xe.START_ROUND:this.handleStartRoundState();break;case Xe.CATEGORY_SELECTION:this.handleCategorySelectionState();break;case Xe.PREPARATION:this.handlePreparationState();break;case Xe.WORD_DESCRIPTION:this.handleWordDescriptionState();break;case Xe.VOTING:this.handleVotingState();break;case Xe.VOTING_RESULTS:this.handleVotingResultsState();break;case Xe.END_ROUND:this.handleEndRoundState()}},r.handleStartRoundState=function(){console.log("[UIManager] Handling start round state"),this.CloseAllMenus(),this.OpenMenu("StartRoundScreen")},r.handleEndRoundState=function(){console.log("[UIManager] Handling end round state"),this.CloseAllMenus(),this.OpenMenu("EndRoundScreen")},r.handleCategorySelectionState=function(){console.log("[UIManager] Handling category selection state"),this.CloseAllMenus(),this.OpenMenu("CategorySelectionScreen")},r.handlePreparationState=function(){console.log("[UIManager] Handling preparation state"),this.CloseMenu("CategorySelectionScreen"),this.OpenMenu("PreparationScreen")},r.handleWordDescriptionState=function(){console.log("[UIManager] Handling word description state"),this.CloseMenu("PreparationScreen"),this.CloseMenu("VotingResultsScreen"),this.OpenMenu("WordDescriptionScreen")},r.handleVotingState=function(){console.log("[UIManager] Handling voting state"),this.CloseMenu("WordDescriptionScreen"),this.OpenMenu("VotingScreen")},r.handleVotingResultsState=function(){console.log("[UIManager] Handling voting results state"),this.CloseMenu("VotingScreen"),this.OpenMenu("VotingResultsScreen")},r.onServerMessage=function(t,e){},r.onRoomStatusChange=function(t,e){var n=this;switch(console.log("[UIManager] Room status changed: ",e),e){case we.WAITING_FOR_PLAYERS:console.log("Opening waiting screen"),this.OpenMenu("WaitingScreen");break;case we.COUNTDOWN:console.log("Opening countdown screen"),this.CloseAllMenus(),this.OpenMenu("CountDownScreen");break;case we.GAME_SIMULATION:this.scheduleOnce((function(){n.CloseMenu("CountdownScreen"),n.OpenMenu("InGameMenu")}),1);break;case we.END_GAME:break;default:console.warn("[UIManager] Unhandled RoomStatus: "+e)}},r.playFlashEffect=function(t){var e=this;void 0===t&&(t=new D(197,8,8)),this.flashNode.active=!0;var n=this.flashNode.getComponent(w);n?(n.color=new D(t.r,t.g,t.b,0),G(n).to(.2,{color:new D(t.r,t.g,t.b,255)}).delay(.05).to(.3,{color:new D(t.r,t.g,t.b,0)}).call((function(){e.flashNode.active=!1})).start()):console.error("No Sprite component found on flashNode")},o}(h)).instance=null,Qr=t((Zr=ta).prototype,"uiCamera",[Kr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qr=t(Zr.prototype,"menus",[Jr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),$r=t(Zr.prototype,"flashNode",[jr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xr=Zr))||Xr);l._RF.pop(),l._RF.push({},"87d25szwANAQpYk8OoLCrSo","Mafia_VotingResultsScreen",void 0);var Ma,Da,ka,Ga,Fa,za=c.ccclass,Ha=c.property,Va="[VotingResultsScreen]";ia=za("MafiaVotingResultsScreen"),oa=Ha({type:w,tooltip:"Background"}),ra=Ha({type:M,tooltip:"Voting Results Item Prefab"}),aa=Ha({type:Gn,tooltip:"Voted Player Avatar"}),sa=Ha({type:I,tooltip:"Voted Player Name"}),la=Ha({type:I,tooltip:"Player Role"}),ca=Ha({type:I,tooltip:"Heading"}),ua=Ha({type:E,tooltip:"Tie Sprite"}),ha=Ha({type:E}),pa=Ha({type:E}),da=Ha({type:w}),fa=Ha({type:w}),ma=Ha({type:K}),ia((va=t((ya=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"background",va,i(e)),n(e,"votingResultsItemPrefab",Sa,i(e)),n(e,"votedPlayerAvatar",Ca,i(e)),n(e,"votedPlayerName",Ta,i(e)),n(e,"playerRole",ba,i(e)),n(e,"votedHeading",Ra,i(e)),n(e,"tieSprite",Ea,i(e)),n(e,"votedContainer",_a,i(e)),n(e,"skullContainer",Ia,i(e)),n(e,"skullBG",wa,i(e)),n(e,"skull",Aa,i(e)),n(e,"tieAnimation",Na,i(e)),e.VOTE_RESULT_DISPLAY_TIME=2,e.VOTER_AVATAR_SIZE=new R(70,70),e}e(o,t);var r=o.prototype;return r.Open=function(){t.prototype.Open.call(this),this.setupScreen()},r.setupScreen=function(){var t=Io.Instance,e=t.getRoomState();if(e){if(e.tieBreakRound>0)return Fo.instance.playSound("Tie"),this.tieSprite.active=!0,this.tieAnimation.play(),void(this.votedContainer.active=!1);this.tieSprite.active=!1,this.votedContainer.active=!0;var n=this.getMostVotedPlayerId(),i=t.getPlayer(n);i?this.showEliminationResult(i.playerName,n):console.error(Va+" Cannot find player with ID: "+n)}else console.error(Va+" Cannot setup screen: Room state is null")},r.animateSkull=function(){var t=a(s().mark((function t(){var e,n,i=this;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.skullContainer.active=!0,(e=this.skullBG.getComponent(Y))||(e=this.skullBG.addComponent(Y)),e.opacity=0,this.skull.node.scale=new _(4,4,1),(n=this.skull.getComponent(Y))||(n=this.skull.addComponent(Y)),n.opacity=0,t.next=10,new Promise((function(t){i.scheduleOnce((function(){t(null)}),.5)}));case 10:G(e).to(.2,{opacity:125}).start(),this.scheduleOnce((function(){G(i.skull.node).to(.15,{scale:new _(.9,.9,1)}).to(.1,{scale:new _(1,1,1)}).start(),G(n).to(.15,{opacity:255}).start()}),.1);case 12:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}(),r.animateVotedContainer=function(){this.votedContainer.scale=new _(1.2,1.2,1);var t=this.votedContainer.getComponent(Y);t||(t=this.votedContainer.addComponent(Y)),t.opacity=0,G(this.votedContainer).to(.2,{scale:new _(1,1,1)}).start(),G(t).to(.2,{opacity:255}).start()},r.showEliminationResult=function(t,e){var n=Io.Instance.getRoomState(),i=Xt.Instance.getMySessionId(),o=n.getPlayerBySessionId(i);if(n){var r=Io.Instance.getPlayer(e);r&&(this.votedPlayerAvatar.setAvatarFromSpriteFrame(r.playerAvatar.playerAvatar.spriteFrame),this.votedPlayerName.string=r.playerName,this.votedPlayerName.color=D.BLACK),this.votedContainer.active=!0,this.tieSprite.active=!1,this.animateVotedContainer(),this.votedHeading.string=t+" got out!",this.votedPlayerName.color=D.WHITE,n.currentSpyUserId===e?(this.applySpyStyles(),o&&o.userId!==e&&La.instance.playFlashEffect(new D(0,255,0,255)),Fo.instance.playSound("Yaay")):(this.applyVillagerStyles(),o&&o.userId!==e&&La.instance.playFlashEffect(new D(255,0,0,255)),Fo.instance.playSound("OhNo")),this.animateSkull()}},r.applySpyStyles=function(){var t=Io.Instance;this.playerRole.color=t.spyColor,this.background.color=t.spyColor,this.playerRole.string="Spy"},r.applyVillagerStyles=function(){var t=Io.Instance;this.playerRole.color=t.villagersColor,this.background.color=t.villagersColor,this.playerRole.string="Villager"},r.getMostVotedPlayerId=function(){var t=Io.Instance.getRoomState();if(!t||!t.playersData||0===t.playersData.length)return console.error(Va+" Invalid room state data"),"";var e=this.countVotes(t.playersData),n="",i=0;return Object.keys(e).forEach((function(t){var o=e[t];o>i&&(i=o,n=t)})),n},r.countVotes=function(t){var e={};return t.forEach((function(t){t.votedSpyUserId&&(e[t.votedSpyUserId]=(e[t.votedSpyUserId]||0)+1)})),e},o}(Yo)).prototype,"background",[oa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Sa=t(ya.prototype,"votingResultsItemPrefab",[ra],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ca=t(ya.prototype,"votedPlayerAvatar",[aa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ta=t(ya.prototype,"votedPlayerName",[sa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ba=t(ya.prototype,"playerRole",[la],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ra=t(ya.prototype,"votedHeading",[ca],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ea=t(ya.prototype,"tieSprite",[ua],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_a=t(ya.prototype,"votedContainer",[ha],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ia=t(ya.prototype,"skullContainer",[pa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wa=t(ya.prototype,"skullBG",[da],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Aa=t(ya.prototype,"skull",[fa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Na=t(ya.prototype,"tieAnimation",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ga=ya));l._RF.pop(),l._RF.push({},"5c988B1YEtKMrDLkvStEf29","Mafia_VotingScreen",void 0);var Ba,Wa=c.ccclass,Ua=c.property;Ma=Wa("MafiaVotingScreen"),Da=Ua({type:E}),Ma((Fa=t((Ga=function(t){function o(){for(var e,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return e=t.call.apply(t,[this].concat(r))||this,n(e,"infoContainer",Fa,i(e)),e}e(o,t);var r=o.prototype;return r.Open=function(){var e=this;t.prototype.Open.call(this),this.infoContainer.active=!0,this.animateInfoContainer(),this.scheduleOnce((function(){e.Close()}),3)},r.animateInfoContainer=function(){this.infoContainer.scale=new _(1.2,1.2,1);var t=this.infoContainer.getComponent(Y);t||(t=this.infoContainer.addComponent(Y)),t.opacity=0,G(this.infoContainer).to(.2,{scale:new _(1,1,1)}).start(),G(t).to(.2,{opacity:255}).start()},o}(Yo)).prototype,"infoContainer",[Da],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ka=Ga));l._RF.pop(),l._RF.push({},"16b50I2dNVB9Z0Y9XMNdt/e","Mafia_WaitingScreen",void 0);var xa,Ya=c.ccclass;c.property,Ya("MafiaWaitingScreen")(Ba=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n}(Yo));l._RF.pop(),l._RF.push({},"b9dd67SajxB973UHAenpXcV","Mafia_WordDescriptionScreen",void 0);var Ka=c.ccclass;c.property,Ka("MafiaWordDescriptionScreen")(xa=function(t){function n(){return t.apply(this,arguments)||this}return e(n,t),n}(Yo));l._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/mafia_game', 'chunks:///mafia_game.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});