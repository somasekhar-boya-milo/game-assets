System.register("chunks:///snl_game.js",["./rollupPluginModLoBabelHelpers-5eee144e.js","cc","./colyseus.mjs_cjs=&original=-36827661.js"],(function(){var e,t,n,i,o,r,a,s,l,c,u,p,h,d,f,m,y,g,v,S,b,_,C,T,P,w,O,N,E,R,I,A,D,L,F,k,M,z,H,G,U,x,B,W,V,K,j,J,Y,Z,Q,q,X,$,ee,te,ne;return{setters:[function(l){e=l._,t=l.a,n=l.b,i=l.c,o=l.h,r=l.d,a=l.f,s=l.g},function(e){l=e.cclegacy,c=e._decorator,u=e.Node,p=e.CCString,h=e.Component,d=e.UITransform,f=e.Camera,m=e.screen,y=e.sys,g=e.view,v=e.math,S=e.EventTarget,b=e.CCBoolean,_=e.AudioClip,C=e.CCFloat,T=e.AudioSource,P=e.Prefab,w=e.instantiate,O=e.SpriteFrame,N=e.Color,E=e.Sprite,R=e.CCInteger,I=e.Label,A=e.Animation,D=e.tween,L=e.Vec3,F=e.quat,k=e.Quat,M=e.Vec2,z=e.Widget,H=e.RichText,G=e.Layout,U=e.UIOpacity,x=e.Tween,B=e.Input,W=e.assetManager,V=e.Texture2D,K=e.game,j=e.Game,J=e.Button,Y=e.PageView,Z=e.director,Q=e.Director,q=e.Enum,X=e.Size},function(e){$=e._,ee=e.M,te=e.H,ne=e.I}],execute:function(){var ie,oe,re,ae,se,le,ce;l._RF.push({},"280f3m/n5ZISY1kYV9kzuwD","Snl_Menu",void 0);var ue=c.ccclass,pe=c.property,he=(ie=ue("SnlMenu"),oe=pe({type:u}),re=pe({type:p}),ie((le=e((se=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"content",le,i(t)),n(t,"menuName",ce,i(t)),t.isOpened=!1,t}t(o,e);var r=o.prototype;return r.onLoad=function(){this.content=this.node.getChildByName("Content")},r.Open=function(){this.content.active=!0,this.isOpened=!0},r.Close=function(){this.content.active=!1,this.isOpened=!1},r.initialize=function(){console.log("Menu initialize called")},o}(h)).prototype,"content",[oe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ce=e(se.prototype,"menuName",[re],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ae=se))||ae);l._RF.pop(),l._RF.push({},"d69fb2gpsFAE6I6fpxonvnR","Snl_NetworkTypes",void 0);var de=function(e){return e[e.SERVER_ROOM_STATE_CHANGE=0]="SERVER_ROOM_STATE_CHANGE",e[e.CONNECTION_STATE_CHANGE=1]="CONNECTION_STATE_CHANGE",e[e.ROOM_STATUS_CHANGE=2]="ROOM_STATUS_CHANGE",e[e.SERVER_MESSAGE=3]="SERVER_MESSAGE",e}({}),fe=function(e){return e[e.INITIALIZING=0]="INITIALIZING",e[e.CONNECTING=1]="CONNECTING",e[e.CONNECTED=2]="CONNECTED",e[e.LOBBY=3]="LOBBY",e[e.JOINED_ROOM=4]="JOINED_ROOM",e[e.DISCONNECTED=5]="DISCONNECTED",e[e.RECONNECTING=6]="RECONNECTING",e[e.KICKED_OUT=7]="KICKED_OUT",e[e.NOT_FOUND=8]="NOT_FOUND",e[e.NO_INTERNET=9]="NO_INTERNET",e}({}),me=function(e){return e.NONE="none",e.KICKED_OUT="kicked_out",e.PLAYER_CAMEBACK="player_cameback",e.PLAYER_JOINED="player_joined",e}({});l._RF.pop(),l._RF.push({},"757e8Wrz9tIWYyubB5/TWQE","Snl_RoomTypes",void 0);var ye,ge,ve,Se,be,_e,Ce,Te,Pe,we,Oe,Ne,Ee=function(e){return e[e.NONE=0]="NONE",e[e.WAITING_FOR_PLAYERS=1]="WAITING_FOR_PLAYERS",e[e.COUNTDOWN=2]="COUNTDOWN",e[e.GAME_SIMULATION=3]="GAME_SIMULATION",e[e.END_GAME=4]="END_GAME",e[e.KICKED_OUT=5]="KICKED_OUT",e}({});l._RF.pop(),l._RF.push({},"78bacmf2DNE8YgvAunHfRKV","Snl_CameraManger",void 0);var Re=c.ccclass,Ie=c.property;(0,c.executionOrder)(-1);var Ae=(ye=Re("SnlCameraManger"),ge=Ie({type:d}),ye(((Ne=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"canvasUITransform",be,i(t)),n(t,"designHeight",_e,i(t)),n(t,"designWidth",Ce,i(t)),n(t,"defaultOrthoHeight",Te,i(t)),n(t,"minOrthoHeight",Pe,i(t)),n(t,"maxOrthoHeight",we,i(t)),n(t,"safeAreaPadding",Oe,i(t)),t.designAspectRatio=void 0,t.currentAspectRatio=void 0,t.camera=null,t.windowWidth=1080,t.windowHeight=1920,t}t(o,e);var r=o.prototype;return r.onLoad=function(){o.instance=this,this.designAspectRatio=this.designWidth/this.designHeight,this.camera=this.node.getComponent(f)},r.start=function(){var e=this;this.updateScreenSize(),this.adaptCameraToScreen(),window.addEventListener("resize",(function(){e.updateScreenSize(),e.adaptCameraToScreen()}))},r.update=function(e){},r.updateScreenSize=function(){this.windowWidth=m.windowSize.width||window.innerWidth,this.windowHeight=m.windowSize.height||window.innerHeight,this.currentAspectRatio=this.windowWidth/this.windowHeight,console.log("Window Size: "+this.windowWidth+"x"+this.windowHeight+", Aspect Ratio: "+this.currentAspectRatio.toFixed(2))},r.adaptCameraToScreen=function(){if(this.camera){var e=0,t=0,n=0,i=0;if(y.os===y.OS.IOS||y.os===y.OS.ANDROID){var o=g.getVisibleSize(),r=g.getVisibleOrigin();o&&(e=r.y,t=this.windowHeight-(r.y+o.height),n=r.x,i=this.windowWidth-(r.x+o.width))}var a=this.windowHeight-e-t-2*this.safeAreaPadding,s=this.windowWidth-n-i-2*this.safeAreaPadding,l=s/a;console.log("Effective Size: "+s+"x"+a+", Aspect Ratio: "+l.toFixed(2));var c=this.currentAspectRatio>=1,u=this.defaultOrthoHeight;if(c)console.log("=== Landscape Mode ==="),u=this.defaultOrthoHeight*(1/this.currentAspectRatio)*1.5;else{console.log("=== Portrait Mode ===");var p=.6/Math.min(this.currentAspectRatio,.6);u=this.defaultOrthoHeight*p}u=v.clamp(u,this.minOrthoHeight,this.maxOrthoHeight),this.camera.orthoHeight=u,console.log("Camera Ortho Height: "+u.toFixed(2))}},r.getWidth=function(){return 2*this.camera.orthoHeight*this.currentAspectRatio},r.getCurrentOrthoHeight=function(){return this.camera.orthoHeight},r.refreshCameraAdaptation=function(){this.updateScreenSize(),this.adaptCameraToScreen()},o}(h)).instance=null,be=e((Se=Ne).prototype,"canvasUITransform",[ge],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_e=e(Se.prototype,"designHeight",[Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1920}}),Ce=e(Se.prototype,"designWidth",[Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1080}}),Te=e(Se.prototype,"defaultOrthoHeight",[Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 820}}),Pe=e(Se.prototype,"minOrthoHeight",[Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 750}}),we=e(Se.prototype,"maxOrthoHeight",[Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1080}}),Oe=e(Se.prototype,"safeAreaPadding",[Ie],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),ve=Se))||ve);l._RF.pop(),l._RF.push({},"ea7e7ceKUFCkYMEtbS9yNEY","Snl_PlayerTypes",void 0);var De=function(e){return e[e.HUMAN=0]="HUMAN",e[e.BOT=1]="BOT",e[e.SPECTATOR=2]="SPECTATOR",e}({});l._RF.pop(),l._RF.push({},"279dedudGRJ76w+OOE9ojcP","Snl_PBLogger",void 0);var Le,Fe=function(e){return e[e.Debug=0]="Debug",e[e.Info=1]="Info",e[e.Warning=2]="Warning",e[e.Error=3]="Error",e}({}),ke=function(){function e(){}return e.debug=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.log(Fe.Debug,e,n)},e.info=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.log(Fe.Info,e,n)},e.warning=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.log(Fe.Warning,e,n)},e.error=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];this.log(Fe.Error,e,n)},e.log=function(e,t,n){if(e>=this.currentLevel){var i,o=Fe[e]+": "+t;if((i=console).log.apply(i,[o].concat(n)),this.isProduction&&window.ReactNativeWebView)try{var r={event:"log",level:Fe[e],message:o,params:n};window.ReactNativeWebView.postMessage(JSON.stringify(r))}catch(e){console.error("Failed to send log to ReactNativeWebView:",e)}}},e.setLevel=function(e){this.currentLevel=e},e.setProductionMode=function(e){this.isProduction=e},e}();ke.currentLevel=Fe.Debug,ke.isProduction=!1,l._RF.pop(),l._RF.push({},"0b7d0/mFfxOnqFZ7HJc5MNP","Snl_PbSaveSystem",void 0);var Me,ze,He,Ge,Ue,xe,Be,We,Ve,Ke,je,Je,Ye,Ze,Qe,qe=(0,c.ccclass)("SnlPbSaveSystem")(Le=function(){function e(){}return e.SaveData=function(e,t){ke.info("============ Saving data in pb save system ========="),y.localStorage.setItem(e,JSON.stringify(t))},e.LoadData=function(e){return JSON.parse(y.localStorage.getItem(e))},e.RemoveData=function(e){y.localStorage.removeItem(e)},e.ClearAllData=function(){y.localStorage.clear()},e}())||Le;l._RF.pop(),l._RF.push({},"4c7ffh7Y1pBd67s2Y5vw4dv","Snl_NetworkConfig",void 0);var Xe,$e,et,tt,nt,it,ot,rt,at=c.ccclass,st=c.property,lt=(Me=at("SnlNetworkConfig"),ze=st({tooltip:"Server host address"}),He=st({tooltip:"Server port number"}),Ge=st({tooltip:"Use SSL for connections"}),Ue=st({tooltip:"Player identifier"}),xe=st({tooltip:"Room identifier"}),Be=st({tooltip:"Name of the game"}),Me((Ke=e((Ve=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"serverHost",Ke,i(t)),n(t,"serverPort",je,i(t)),n(t,"useSSL",Je,i(t)),n(t,"userId",Ye,i(t)),n(t,"roomId",Ze,i(t)),n(t,"gameName",Qe,i(t)),t}t(o,e);var r=o.prototype;return r.initNetworkConfig=function(){if(y.isBrowser){var e=new URLSearchParams(window.location.search),t="true"===e.get("debug");ke.debug("Initializing network config (debug="+t+")"),t?this.parseQueryParams(e):this.parseInjectedConfig(),ke.debug("Final network config:",{serverHost:this.serverHost,serverPort:this.serverPort,useSSL:this.useSSL,userId:this.userId,roomId:this.roomId,gameName:this.gameName})}},r.parseQueryParams=function(e){var t=this;ke.debug("Parsing config from query parameters"),this.updateConfigFromQueryParam(e,"userId",(function(e){return t.userId=e})),this.updateConfigFromQueryParam(e,"roomId",(function(e){return t.roomId=e})),this.updateConfigFromQueryParam(e,"apiUrl",(function(e){return t.serverHost=e})),this.updateConfigFromQueryParam(e,"apiPort",(function(e){var n=parseInt(e);isNaN(n)||(t.serverPort=n)})),this.updateConfigFromQueryParam(e,"useSSL",(function(e){return t.useSSL="true"===e}))},r.parseInjectedConfig=function(){ke.debug("Parsing config from injected GameConfig");try{var e=window.GameConfig;if(!e)return void ke.debug("No injected GameConfig found");var t="string"==typeof e?JSON.parse(e):e;this.applyConfig(t)}catch(e){ke.debug("Failed to parse injected GameConfig:",e)}},r.applyConfig=function(e){var t,n,i,o,r;e&&(this.userId=null!=(t=e.userId)?t:this.userId,this.roomId=null!=(n=e.roomId)?n:this.roomId,this.serverHost=null!=(i=e.apiUrl)?i:this.serverHost,this.serverPort=Number(null!=(o=e.apiPort)?o:this.serverPort),this.useSSL=null!=(r=e.useSSL)?r:this.useSSL)},r.updateConfigFromQueryParam=function(e,t,n){var i=e.get(t);null!=i&&n(i)},o}(h)).prototype,"serverHost",[ze],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"localhost"}}),je=e(Ve.prototype,"serverPort",[He],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 2567}}),Je=e(Ve.prototype,"useSSL",[Ge],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),Ye=e(Ve.prototype,"userId",[Ue],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return""}}),Ze=e(Ve.prototype,"roomId",[xe],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"testroom1"}}),Qe=e(Ve.prototype,"gameName",[Be],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return"Pictionary"}}),We=Ve))||We);l._RF.pop(),l._RF.push({},"98ff6lgDH1NyKL9cGbzig4G","Snl_NetworkManager",void 0);var ct,ut,pt,ht,dt,ft,mt,yt,gt,vt,St,bt,_t,Ct,Tt,Pt,wt,Ot,Nt,Et,Rt,It,At,Dt=c.ccclass,Lt=c.property,Ft={roomId:"testroom1",reconnectionToken:"eyJ"},kt=new S,Mt=new S,zt=new S,Ht=(Xe=Dt("SnlNetworkManager"),$e=Lt({type:b,tooltip:"Enable development mode for additional logging"}),et=Lt({type:lt,tooltip:"Network configuration settings"}),Xe(((rt=function(e){function l(){for(var t,r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return t=e.call.apply(e,[this].concat(a))||this,n(t,"isDevMode",it,i(t)),n(t,"networkConfig",ot,i(t)),t._client=void 0,t._room=void 0,t._currentConnectionState=fe.INITIALIZING,t._reconnectionData=o({},Ft),t}t(l,e);var c=l.prototype;return c.onLoad=function(){l._instance&&(this.log("NetworkManager instance already exists. Destroying duplicate."),this.node.destroy()),l._instance=this,this.networkConfig.initNetworkConfig(),this.isDevMode||ke.setProductionMode(!0)},c.start=function(){this.initializeClient(),ke.info("============ Initializing client ========="),ke.info("============ Connecting to room ========="),this.connect(this.networkConfig.roomId,this.networkConfig.userId)},c.initializeClient=function(){var e=this.networkConfig.useSSL?"wss":"ws",t="";t=0==this.networkConfig.serverPort?e+"://"+this.networkConfig.serverHost:e+"://"+this.networkConfig.serverHost+":"+this.networkConfig.serverPort,this.log("Initializing client with endpoint: "+t),this._client=new $.Client(t)},c.shouldRejoin=function(){return!this.isDevMode&&(this._reconnectionData=qe.LoadData(this.networkConfig.gameName),!!(this._reconnectionData&&this._reconnectionData.roomId&&this._reconnectionData.reconnectionToken)&&this._reconnectionData.roomId===this.networkConfig.roomId)},c.connect=function(){var e=a(s().mark((function e(t,n){var i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ke.info("============ Connecting to room from connect function ========="),this.updateConnectionState(fe.CONNECTING),!this.shouldRejoin()){e.next=7;break}return this.log("Rejoining room",t),e.next=6,this.rejoin();case 6:return e.abrupt("return");case 7:return e.prev=7,i=this.createPlayerData(n),this.log("Joining with options ",{player:i}),e.next=12,this._client.joinById(t,{player:i});case 12:this._room=e.sent,this.initAfterJoin(t),e.next=20;break;case 16:throw e.prev=16,e.t0=e.catch(7),this.handleConnectionError(e.t0),e.t0;case 20:case"end":return e.stop()}}),e,this,[[7,16]])})));return function(t,n){return e.apply(this,arguments)}}(),c.initAfterJoin=function(e){this.updateConnectionState(fe.JOINED_ROOM),this.log("Joined room "+e+" with sessionId: "+this._room.sessionId),this.initializeRoomCallbacks(),this.saveReconnectionData()},c.createAndJoinRoom=function(){var e=a(s().mark((function e(t,n){var i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.log("Creating room",t),this.updateConnectionState(fe.CONNECTING),e.prev=2,i=this.createPlayerData(n),e.next=6,this._client.create("PictionaryRoom",{roomId:t,player:i,roomSettings:{maxClients:10}});case 6:this._room=e.sent,this.initAfterJoin(t),e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(2),this.handleConnectionError(e.t0),e.t0;case 14:case"end":return e.stop()}}),e,this,[[2,10]])})));return function(t,n){return e.apply(this,arguments)}}(),c.createPlayerData=function(e){return{userId:e,name:e,avatar:"randomProfilePicture",type:De.HUMAN}},c.initializeRoomCallbacks=function(){var e=this;console.log("============ Initializing room callbacks ========="),this._room?(this._room.onStateChange((function(e){Mt.emit(de.SERVER_ROOM_STATE_CHANGE,e)})),this._room.onLeave((function(t){4001===t?e.updateConnectionState(fe.KICKED_OUT):e.updateConnectionState(fe.DISCONNECTED)})),this._room.onMessage(me.KICKED_OUT,(function(){e.updateConnectionState(fe.KICKED_OUT)})),this._room.onMessage("*",(function(e,t){zt.emit(de.SERVER_MESSAGE,e,t)}))):this.log("Cannot initialize callbacks: Room is not defined")},c.updateConnectionState=function(e){if(this._currentConnectionState!==e){var t=this._currentConnectionState;this._currentConnectionState=e,this.log("Connection state changed: "+fe[t]+" -> "+fe[e]),kt.emit(de.CONNECTION_STATE_CHANGE,t,e)}},c.reconnect=function(){var e=a(s().mark((function e(t,n,i){var o,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===t&&(t=1),void 0===n&&(n=10),void 0===i&&(i=2e3),this._currentConnectionState===fe.DISCONNECTED||this._currentConnectionState===fe.RECONNECTING){e.next=6;break}return this.log("Cannot reconnect: Current state is "+fe[this._currentConnectionState]),e.abrupt("return");case 6:return this._room&&this._room.state&&(o=this._room.state).roomSettings&&o.roomSettings.maxReconnectionAttempts&&(n=o.roomSettings.maxReconnectionAttempts),this.updateConnectionState(fe.RECONNECTING),this.log("Reconnect attempt "+t+"/"+n),e.prev=9,e.next=12,this.delay(i);case 12:if(this._room&&this._room.reconnectionToken){e.next=14;break}throw new Error("Reconnection token not available");case 14:return e.next=16,this._client.reconnect(this._room.reconnectionToken);case 16:r=e.sent,this._room=r,this.saveReconnectionData(),this.initializeRoomCallbacks(),this.updateConnectionState(fe.JOINED_ROOM),this.log("Reconnected successfully."),e.next=27;break;case 24:e.prev=24,e.t0=e.catch(9),this.handleReconnectionError(e.t0,t,n,i);case 27:case"end":return e.stop()}}),e,this,[[9,24]])})));return function(t,n,i){return e.apply(this,arguments)}}(),c.rejoin=function(){var e=a(s().mark((function e(t,n,i){var o,r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return void 0===t&&(t=1),void 0===n&&(n=10),void 0===i&&(i=2e3),this.log("Rejoin attempt "+t+"/"+n),e.prev=4,e.next=7,this.delay(i);case 7:if(this._reconnectionData&&this._reconnectionData.reconnectionToken){e.next=9;break}throw new Error("Reconnection data not available");case 9:return o=this._reconnectionData.roomId+":"+this._reconnectionData.reconnectionToken,ke.info("Using formatted reconnection token: ",o),e.next=13,this._client.reconnect(o);case 13:r=e.sent,this._room=r,this.saveReconnectionData(),this.initializeRoomCallbacks(),this.updateConnectionState(fe.JOINED_ROOM),this.log("Rejoined successfully."),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(4),this.handleReconnectionError(e.t0,t,n,i,"reJoin");case 24:case"end":return e.stop()}}),e,this,[[4,21]])})));return function(t,n,i){return e.apply(this,arguments)}}(),c.delay=function(){var e=a(s().mark((function e(t){return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return setTimeout(e,t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c.handleConnectionError=function(e){var t=(null==e?void 0:e.message)||"Unknown error";this.log("Error connecting to room:",t),this.updateConnectionState(fe.DISCONNECTED)},c.handleReconnectionError=function(e,t,n,i,o){void 0===o&&(o="reconnect");var r=(null==e?void 0:e.message)||"Unknown error";this.log(o+" attempt "+t+" failed:",r),t<n||-1===n?"reconnect"===o?this.reconnect(t+1,n,i):this.rejoin(t+1,n,i):(this.log("Max reconnection attempts reached. Please check your network or contact support."),this.updateConnectionState(fe.NOT_FOUND))},c.saveReconnectionData=function(){if(ke.info("============ Saving reconnection data ========="),this._room&&this._room.reconnectionToken){var e=this._room.reconnectionToken;e.includes(":")&&(e=e.split(":")[1]),ke.info("saving Reconnection token: ",e),this._reconnectionData={roomId:this.networkConfig.roomId,reconnectionToken:e},qe.SaveData(this.networkConfig.gameName,this._reconnectionData),ke.info("Reconnection data saved")}else this.log("Cannot save reconnection data: Room or reconnection token not available")},c.leaveRoom=function(){var e=this;this._room?(this.log("Leaving room"),this._room.leave(!0).then((function(){return e.log("Left room successfully")})).catch((function(t){return e.log("Error leaving room:",(null==t?void 0:t.message)||"Unknown error")}))):this.log("Cannot leave room: Room is not defined")},c.getMySessionId=function(){return this._room.sessionId},c.sendMessage=function(e,t){this._room?(this.isDevMode&&this.log("Sending message:",e,t),this._room.send(e,t)):this.log("Cannot send message: Room is not defined")},c.log=function(e){if(this.isDevMode){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];n.length>0?ke.info.apply(ke,["[NetworkManager] "+e].concat(n)):ke.info("[NetworkManager] "+e)}},c.onDestroy=function(){this.cleanup()},c.cleanup=function(){this._room&&(this.leaveRoom(),this._room=null),this._client&&(this._client=null),this._currentConnectionState=fe.INITIALIZING,this._reconnectionData=o({},Ft),l._instance===this&&(l._instance=null)},r(l,[{key:"CurrentRoom",get:function(){return this._room}},{key:"CurrentConnectionState",get:function(){return this._currentConnectionState}}],[{key:"Instance",get:function(){if(!this._instance)throw new Error("NetworkManager instance is not initialized.");return this._instance}}]),l}(h))._instance=null,it=e((nt=rt).prototype,"isDevMode",[$e],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ot=e(nt.prototype,"networkConfig",[et],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),tt=nt))||tt);l._RF.pop(),l._RF.push({},"c004fDlv/xDRazYPy/e2qJL","Snl_AudioManager",void 0);var Gt=c.ccclass,Ut=c.property,xt=(ct=Gt("SnlAudioClipData"),ut=Ut({type:p}),pt=Ut({type:_}),ht=Ut({type:C}),dt=Ut({type:C}),ft=Ut({type:b}),ct((gt=e((yt=function(){function e(){n(this,"name",gt,this),n(this,"audioClips",vt,this),n(this,"delayBetweenClips",St,this),n(this,"volume",bt,this),n(this,"loop",_t,this),this.isLoopPlaying=void 0,this.lastPlayedTime=0,this.clipIndex=0}var t=e.prototype;return t.GetClip=function(){var e=this.audioClips[this.clipIndex];if(this.clipIndex=(this.clipIndex+1)%this.audioClips.length,this.CanPlay())return this.lastPlayedTime=Date.now(),e},t.CanPlay=function(){return Date.now()-this.lastPlayedTime>1e3*this.delayBetweenClips},e}()).prototype,"name",[ut],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vt=e(yt.prototype,"audioClips",[pt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),St=e(yt.prototype,"delayBetweenClips",[ht],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),bt=e(yt.prototype,"volume",[dt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 1}}),_t=e(yt.prototype,"loop",[ft],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mt=yt))||mt),Bt=(Ct=Gt("SnlAudioManager"),Tt=Ut({type:xt}),Pt=Ut({type:T}),wt=Ut({type:P}),Ct(((At=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"audioClipData",Et,i(t)),n(t,"backgroundAudioSource",Rt,i(t)),t.localStorageAudioEnabledKey="SNLAudioEnabled",n(t,"audioSourcePrefab",It,i(t)),t.audioSources=[],t._isAudioEnabled="true",t}t(o,e);var a=o.prototype;return a.onLoad=function(){o.instance=this,this.ReadAudioEnabledFromLocalStorage()},a.onDestroy=function(){o.instance===this&&(o.instance=null)},a.start=function(){this.SetAudioEnabled(this.IsAudioEnabled)},a.playSound=function(e){if("false"!=this.IsAudioEnabled){var t=this.audioClipData.find((function(t){return t.name==e}));if(null!=t){var n=t.GetClip();if(n){if(t.isLoopPlaying)return;var i=this.getEmptyAudioSource();i.loop=t.loop,t.isLoopPlaying=t.loop,i.volume=t.volume,i.clip=n,t.loop?i.play():i.playOneShot(n)}else console.warn("Audio Clip is in use ",e)}}},a.stopSound=function(e){var t=this.audioClipData.find((function(t){return t.name==e}));t?this.audioSources.forEach((function(e){e.clip==t.audioClips[t.clipIndex]&&(t.isLoopPlaying=!1,e.stop())})):console.warn("Audio Clip not found for ",e)},a.stopAllSounds=function(){this.audioSources.forEach((function(e){e.stop()})),this.audioClipData.forEach((function(e){e.isLoopPlaying=!1}))},a.ToggleAudio=function(){"true"==this.IsAudioEnabled?this.SetAudioEnabled("false"):this.SetAudioEnabled("true")},a.SetAudioEnabled=function(e){this._isAudioEnabled=e,this.UpdateBackgroundMusic(),this.WriteAudioEnabledToLocalStorage()},a.WriteAudioEnabledToLocalStorage=function(){y.localStorage.setItem(this.localStorageAudioEnabledKey,this.IsAudioEnabled)},a.ReadAudioEnabledFromLocalStorage=function(){var e=y.localStorage.getItem(this.localStorageAudioEnabledKey);this._isAudioEnabled=null==e?"true":e},a.UpdateBackgroundMusic=function(){var e,t;"true"==this.IsAudioEnabled?null==(e=this.backgroundAudioSource)||e.play():null==(t=this.backgroundAudioSource)||t.stop()},a.printAllPlayingAudioSources=function(){this.audioSources.forEach((function(e){e.playing&&console.log("Playing audio source: ",e.playing,e.clip.name,e.uuid)}))},a.getEmptyAudioSource=function(){var e=this.audioSources.find((function(e){return!e.playing}));return null==e&&(e=this.createAudioSource()),e},a.createAudioSource=function(){var e=w(this.audioSourcePrefab).getComponent(T);return e.node.setParent(this.node),this.audioSources.push(e),console.log("==== Created new audio source: ",this.audioSources.length),e},r(o,[{key:"IsAudioEnabled",get:function(){return this._isAudioEnabled}}]),o}(h)).instance=null,Et=e((Nt=At).prototype,"audioClipData",[Tt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Rt=e(Nt.prototype,"backgroundAudioSource",[Pt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),It=e(Nt.prototype,"audioSourcePrefab",[wt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ot=Nt))||Ot);l._RF.pop(),l._RF.push({},"50ec9GN3mFGcJFtBNdZFMLH","SNLTileType",void 0);var Wt,Vt,Kt,jt,Jt,Yt,Zt,Qt,qt,Xt,$t,en,tn,nn,on,rn,an,sn,ln,cn,un,pn,hn,dn,fn,mn,yn,gn,vn,Sn,bn,_n,Cn=function(e){return e[e.DEFAULT=1]="DEFAULT",e[e.SNAKE=2]="SNAKE",e[e.LADDER=4]="LADDER",e[e.SHIELD=8]="SHIELD",e[e.ROCKET=16]="ROCKET",e[e.SAFE=32]="SAFE",e}({});l._RF.pop(),l._RF.push({},"0ae8612InhFj5ke08oinLqA","Snl_PlayerAssets",void 0);var Tn,Pn=c.ccclass,wn=c.property,On=(Wt=Pn("SnlPlayerAssets"),Vt=wn({type:O}),Kt=wn({type:N}),jt=wn({type:N}),Jt=wn({type:P}),Yt=wn({type:C}),Zt=wn({type:P}),Qt=wn({type:O}),qt=wn({type:O}),Xt=wn({type:O}),$t=wn({type:P}),en=wn({type:[O]}),tn=wn({type:P}),nn=wn({type:[P]}),on=wn({type:[P]}),Wt(((_n=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"pawnSprites",sn,i(t)),n(t,"pawnColors",ln,i(t)),n(t,"DiceBgColors",cn,i(t)),n(t,"pawnPrefab",un,i(t)),n(t,"pawnWidth",pn,i(t)),n(t,"basePrefab",hn,i(t)),n(t,"diceOutComeSprites",dn,i(t)),n(t,"diceOutComesStackSprites",fn,i(t)),n(t,"goldenDiceOutComeSprite",mn,i(t)),n(t,"moveOptionsUI",yn,i(t)),n(t,"powerUpSprites",gn,i(t)),n(t,"powerUpPrefab",vn,i(t)),n(t,"snakePrefabs",Sn,i(t)),n(t,"ladderPrefabs",bn,i(t)),t}t(o,e);var r=o.prototype;return r.onLoad=function(){o.instance=this},r.onDestroy=function(){o.instance===this&&(o.instance=null)},r.getPawnSprite=function(e){return this.pawnSprites[e]},r.getDiceOutComeSprite=function(e){return this.diceOutComeSprites[e]},r.getDiceOutComesStackSprite=function(e){return this.diceOutComesStackSprites[e]},r.getGoldenDiceOutComeSprite=function(){return this.goldenDiceOutComeSprite},r.getPawnWidth=function(){return this.pawnWidth},r.getPowerUpSprite=function(e){var t=e&Cn.SHIELD,n=e&Cn.ROCKET;return t?this.powerUpSprites[0]:n?this.powerUpSprites[1]:void 0},r.getPawnColor=function(e){return this.pawnColors[e]},r.getDiceBgColor=function(e){return N.WHITE.clone()},o}(h)).instance=null,sn=e((an=_n).prototype,"pawnSprites",[Vt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ln=e(an.prototype,"pawnColors",[Kt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),cn=e(an.prototype,"DiceBgColors",[jt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),un=e(an.prototype,"pawnPrefab",[Jt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),pn=e(an.prototype,"pawnWidth",[Yt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 50}}),hn=e(an.prototype,"basePrefab",[Zt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),dn=e(an.prototype,"diceOutComeSprites",[Qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),fn=e(an.prototype,"diceOutComesStackSprites",[qt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),mn=e(an.prototype,"goldenDiceOutComeSprite",[Xt],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),yn=e(an.prototype,"moveOptionsUI",[$t],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),gn=e(an.prototype,"powerUpSprites",[en],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),vn=e(an.prototype,"powerUpPrefab",[tn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Sn=e(an.prototype,"snakePrefabs",[nn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),bn=e(an.prototype,"ladderPrefabs",[on],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),rn=an))||rn);l._RF.pop(),l._RF.push({},"011efV97bZLd60uRUeUsEEd","Snl_Pooler",void 0);var Nn,En,Rn=c.ccclass,In=(c.property,Rn("SnlPooler")(Tn=function(){function e(e){this.poolName="NodePool",this.pooledObjects=[],this.objectPrefab=null,this.pooledObjectCount=0,this.tempNode=null,this.poolName=e}var t=e.prototype;return t.getObject=function(){return this.pooledObjects.length>0?(this.tempNode=this.pooledObjects.pop(),this.tempNode.active=!0,this.tempNode):this.createObject()},t.returnObject=function(e){this.pooledObjects.push(e),e.active=!1},t.createObject=function(){this.pooledObjectCount++;var e=w(this.objectPrefab);return e.name=this.poolName+" "+this.pooledObjectCount,e},e}())||Tn);l._RF.pop(),l._RF.push({},"6502eM2PDBM77A668pOBDf5","Snl_PoolManager",void 0);var An,Dn,Ln,Fn,kn,Mn,zn,Hn,Gn,Un,xn,Bn,Wn,Vn,Kn,jn,Jn,Yn,Zn,Qn,qn,Xn,$n,ei,ti,ni,ii,oi=c.ccclass,ri=(c.property,oi("SnlPoolManager")(((En=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this).pools=[],t}t(n,e);var i=n.prototype;return i.onLoad=function(){n.instance=this},i.onDestroy=function(){n.instance===this&&(n.instance=null)},i.createPool=function(e){var t=new In(e.name);t.objectPrefab=e,this.pools.push(t)},i.getObjectFromPool=function(e){var t=this.getPool(e.name);return null!=t?t.getObject():(this.createPool(e),this.pools[this.pools.length-1].getObject())},i.getPool=function(e){for(var t=0;t<this.pools.length;t++)if(this.pools[t].poolName==e)return this.pools[t];return null},i.returnObjectToPool=function(e){if(e.active){var t=e.name.split(" ")[0],n=this.getPool(t);null!=n?n.returnObject(e):console.warn("No pool found for object "+e.name)}},n}(h)).instance=null,Nn=En))||Nn);l._RF.pop(),l._RF.push({},"3c5efHL9E1NOoTfjyepiDsI","Snl_Piece",void 0);var ai,si,li,ci,ui,pi,hi,di=c.ccclass,fi=c.property,mi=.9,yi=(An=di("SnlPiece"),Dn=fi({type:E}),Ln=fi({type:R}),Fn=fi({type:R}),kn=fi({type:E}),Mn=fi({type:u}),zn=fi({type:I}),Hn=fi({type:A}),Gn=fi({type:A}),Un=fi({type:P}),xn=fi({type:b}),Bn=fi({type:A}),Wn=fi({type:u}),An((jn=e((Kn=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"pieceSprite",jn,i(t)),n(t,"pieceNumber",Jn,i(t)),n(t,"playerNumber",Yn,i(t)),n(t,"labelSprite",Zn,i(t)),n(t,"labelNode",Qn,i(t)),n(t,"pieceLabel",qn,i(t)),t.moveData=[],t.previousPathNumber=0,t.pathNumber=0,n(t,"propellerAnimation",Xn,i(t)),n(t,"selectAnimation",$n,i(t)),n(t,"moveRippleEffect",ei,i(t)),n(t,"hasShield",ti,i(t)),n(t,"shieldAnimation",ni,i(t)),n(t,"snakeBumpNode",ii,i(t)),t.player=null,t}t(o,e);var r=o.prototype;return r.Initialize=function(e,t,n){this.labelNode.active=!1,this.playerNumber=e,this.pieceNumber=t,this.player=n,this.pieceSprite.spriteFrame=On.instance.getPawnSprite(e),this.labelSprite.color=On.instance.getPawnColor(e),this.pieceLabel.string=this.getPieceLabel(n.playerData.name),this.updatePieceScale()},r.move=function(e,t){var n=this.pathNumber+e;return this.isOnBase()&&6==e&&(this.labelNode.active=!0,n=1),this.setPathNumber(n),this.updateParentNode(),this.getMoveAnimation(n,t)},r.moveToTargetPathNumber=function(e,t,n){return void 0===n&&(n=.12),this.setPathNumber(e),this.updateParentNode(),this.getMoveAnimation(e,t,n)},r.getMoveAnimation=function(e,t,n){var i=this;void 0===n&&(n=.12);for(var o=this.node.worldPosition.clone(),r=io.Instance.getPathPositions(this.previousPathNumber,e,this.playerNumber,this.pieceNumber),a=(io.Instance.getPathTile(e,this.playerNumber,this.pieceNumber),D(this.node).call((function(){i.node.setWorldPosition(o)}))),s=1;s<r.length;s++)a.then(this.jumpToNextTileAnimation(this.node,r[s-1],r[s],n));return a.call((function(){null!=t&&(console.log("[Piece] Calling on pieces  landed CallBack"),t())})),a},r.jumpToNextTileAnimation=function(e,t,n,i){var o=this;void 0===i&&(i=.12);var r=t.clone().add(n).multiplyScalar(.5),a=e.scale.clone(),s=D(e).call((function(){Bt.instance.playSound("Move"),e.setWorldPosition(t)}));return s.call((function(){o.playMoveRippleEffect(t.clone())})),s.to(i,{worldPosition:r,scale:a.clone().multiplyScalar(1.25)}),s.to(i,{worldPosition:n,scale:a}),s},r.setPathNumber=function(e){this.previousPathNumber=this.pathNumber,this.pathNumber=e},r.updateParentNode=function(e){void 0===e&&(e=-1),-1==e&&(e=this.pathNumber);var t=io.Instance.getPathTile(e,this.playerNumber,this.pieceNumber);this.node.setParent(t,!0)},r.updatePiecePosition=function(e){void 0===e&&(e=-1),-1==e&&(e=this.pathNumber),this.node.setPosition(L.ZERO.clone());io.Instance.getPathTile(e,this.playerNumber,this.pieceNumber);io.Instance.piecesOnTile(e,this.playerNumber)>1&&this.node.setWorldPosition(this.node.worldPosition.add(this.getOffsetPosition())),this.updatePieceScale()},r.getOffsetPosition=function(){if(1==this.node.parent.children.length||0==this.pathNumber)return L.ZERO.clone();var e=this.myIndexInTile(this.node.parent),t=this.node.parent.children.length;return new L((e-(t-1)/2)*(t>3?7.5:15),0,0)},r.updatePieceScale=function(){var e=io.Instance.getPawnsCountOnTile(this.pathNumber),t=L.ONE.clone(),n=mi;n=this.isOnBase()?mi:e>4?.4:e>2?.65:.9,this.node.scale=t.multiplyScalar(n)},r.myIndexInTile=function(e){for(var t=0;t<e.children.length;t++)if(e.children[t]==this.node)return t;return-1},r.animatePieceToSize=function(e){D(this.node).to(.5,{scale:L.ONE.clone().multiplyScalar(e)}).start()},r.isOnBase=function(){return 0==this.pathNumber},r.playPropellerAnimation=function(e){this.propellerAnimation.node.active=!0,this.propellerAnimation.node.setPosition(L.ZERO.clone()),this.setNodeUpDirection(this.propellerAnimation.node,e),this.propellerAnimation.node.setWorldPosition(this.node.worldPosition.clone().subtract(this.propellerAnimation.node.up.multiplyScalar(50))),this.propellerAnimation.play(),Bt.instance.playSound("Propeller")},r.setNodeUpDirection=function(e,t){var n=t.clone().normalize(),i=new L(0,0,1),o=new L(0,0,0);L.cross(o,n,i).normalize();var r=F();k.fromAxes(r,o,n,i),e.setWorldRotation(r)},r.stopPropellerAnimation=function(){this.propellerAnimation.stop(),this.propellerAnimation.node.active=!1,Bt.instance.stopSound("Propeller")},r.playSelectAnimation=function(){this.selectAnimation.node.active=!0;var e=this.selectAnimation.node.getComponent(E);null!=e&&(e.color=On.instance.getPawnColor(this.playerNumber)),this.selectAnimation.play()},r.stopSelectAnimation=function(){this.selectAnimation.stop(),this.selectAnimation.node.active=!1},r.playMoveRippleEffect=function(e){var t=ri.instance.getObjectFromPool(this.moveRippleEffect);t.setParent(io.Instance.node,!0),t.setWorldPosition(e);var n=t.getComponent(E);null!=n&&(n.color=On.instance.getPawnColor(this.playerNumber)),t.getComponent(A).play()},r.setShieldActive=function(e){if(this.hasShield!=e){e&&Bt.instance.playSound("Power"),this.hasShield=e;var t=this.shieldAnimation.node.getComponent(E);null!=t&&(t.color=On.instance.getPawnColor(this.playerNumber)),e?(console.log("[Piece] Playing Shield Animation"),this.shieldAnimation.node.active=!0,this.shieldAnimation.play()):(console.log("[Piece] Stopping Shield Animation"),this.shieldAnimation.stop(),this.shieldAnimation.node.active=!1)}},r.reset=function(e){this.setPathNumber(e),this.updateParentNode(),this.updatePiecePosition(),this.stopPropellerAnimation()},r.scaleDownPiece=function(e){var t=this;return void 0===e&&(e=.1),D(this.pieceSprite.node).call((function(){t.pieceSprite.node.active=!0})).to(e,{scale:this.pieceSprite.node.scale.clone().multiplyScalar(0)}).call((function(){t.pieceSprite.node.active=!1}))},r.scaleDownPieceWithWiggle=function(e){var t=this;return void 0===e&&(e=.25),D(this.pieceSprite.node).call((function(){t.pieceSprite.node.active=!0})).to(.3*e,{scale:this.pieceSprite.node.scale.clone().multiplyScalar(.8),angle:15}).to(.3*e,{scale:this.pieceSprite.node.scale.clone().multiplyScalar(.5),angle:-15}).to(.4*e,{scale:this.pieceSprite.node.scale.clone().multiplyScalar(0),angle:0}).call((function(){t.pieceSprite.node.active=!1}))},r.scaleDownBump=function(e){var t=this;return void 0===e&&(e=.1),D(this.snakeBumpNode).call((function(){t.snakeBumpNode.active=!0,t.snakeBumpNode.scale=L.ONE.clone()})).to(e,{scale:L.ONE.clone().multiplyScalar(.5)}).call((function(){t.snakeBumpNode.active=!1}))},r.animateSnakeBulge=function(e){var t=this;return void 0===e&&(e=.1),D(this.snakeBumpNode).delay(.1).call((function(){t.snakeBumpNode.active=!0,t.snakeBumpNode.scale=L.ONE.clone().multiplyScalar(1.2)})).to(e,{scale:L.ONE.clone().multiplyScalar(.5)}).call((function(){t.snakeBumpNode.active=!1}))},r.scaleUpPiece=function(e){var t=this;return void 0===e&&(e=.1),D(this.pieceSprite.node).call((function(){t.pieceSprite.node.active=!0})).to(e,{scale:L.ONE.clone().multiplyScalar(mi)})},r.scaleUpPieceWithBounce=function(e){var t=this;return void 0===e&&(e=.25),D(this.pieceSprite.node).call((function(){t.pieceSprite.node.active=!0,t.pieceSprite.node.scale=L.ONE.clone().multiplyScalar(0)})).to(.4*e,{scale:L.ONE.clone().multiplyScalar(1.3*mi)}).to(.3*e,{scale:L.ONE.clone().multiplyScalar(.8*mi)}).to(.3*e,{scale:L.ONE.clone().multiplyScalar(mi)})},r.onKilled=function(){Bt.instance.playSound("Kill"),this.player._isLocal&&(Mo.instance.playFlashEffect(),this.labelNode.active=!1)},r.getPieceLabel=function(e){var t=e.split(" ")[0].trim();return t.length>=4?(t[0]+t[2]).toUpperCase():t.length>=2?t.substring(0,2).toUpperCase():1===t.length?t.toUpperCase():"??"},o}(h)).prototype,"pieceSprite",[Dn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Jn=e(Kn.prototype,"pieceNumber",[Ln],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Yn=e(Kn.prototype,"playerNumber",[Fn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Zn=e(Kn.prototype,"labelSprite",[kn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qn=e(Kn.prototype,"labelNode",[Mn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qn=e(Kn.prototype,"pieceLabel",[zn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xn=e(Kn.prototype,"propellerAnimation",[Hn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$n=e(Kn.prototype,"selectAnimation",[Gn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ei=e(Kn.prototype,"moveRippleEffect",[Un],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ti=e(Kn.prototype,"hasShield",[xn],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ni=e(Kn.prototype,"shieldAnimation",[Bn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ii=e(Kn.prototype,"snakeBumpNode",[Wn],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Vn=Kn))||Vn);l._RF.pop(),l._RF.push({},"99481y3p3VOEpcm60dYYIoG","Snl_PowerUp",void 0);var gi,vi,Si,bi,_i,Ci=c.ccclass,Ti=c.property,Pi=(ai=Ci("SnlPowerUp"),si=Ti({type:E}),li=Ti({type:A}),ai((pi=e((ui=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"sprite",pi,i(t)),t.pathNumber=0,t.powerupType=0,n(t,"animation",hi,i(t)),t}t(o,e);var r=o.prototype;return r.start=function(){this.playIdleAnimation()},r.setPathNumber=function(e){this.pathNumber=e},r.setPowerUpType=function(e){this.powerupType=e,this.sprite.spriteFrame=On.instance.getPowerUpSprite(e)},r.blinkWithRedColor=function(){D(this.sprite).to(.2,{color:N.RED},{onUpdate:function(e,t){e.color=N.RED}}).to(.2,{color:N.WHITE},{onUpdate:function(e,t){e.color=N.WHITE}}).union().repeatForever().start()},r.playIdleAnimation=function(){var e=this,t=2e3*Math.random();null==this.animation&&(this.animation=this.getComponent(A)),setTimeout((function(){var t;null==(t=e.animation)||t.play()}),t)},o}(h)).prototype,"sprite",[si],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),hi=e(ui.prototype,"animation",[li],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ci=ui))||ci);l._RF.pop(),l._RF.push({},"2c025zDT5RKir2I4ai+fJ68","Snl_AnimationPoints",void 0);var wi=c.ccclass,Oi=c.property,Ni=(gi=wi("SnlAnimationPoints"),vi=Oi([u]),gi((_i=e((bi=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"points",_i,i(t)),t}t(o,e);var r=o.prototype;return r.start=function(){this.log(this.node.name+" totalLength ",this.getTotalLength())},r.getTotalLength=function(){for(var e=0,t=0;t<this.points.length-1;t++)e+=L.distance(this.points[t].worldPosition,this.points[t+1].worldPosition);return e},o}(h)).prototype,"points",[vi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Si=bi))||Si);l._RF.pop(),l._RF.push({},"d6c7foIuztErrmdF1D3CXBx","Snl_PlayerService",void 0);new S;var Ei,Ri,Ii,Ai,Di,Li,Fi,ki,Mi,zi,Hi,Gi,Ui,xi,Bi,Wi,Vi,Ki,ji,Ji,Yi,Zi,Qi,qi,Xi=function(){function e(){this._players=[],this._localPlayer=null,this._myPlayerNumber=0}var t=e.prototype;return t.registerPlayer=function(e,t){void 0===t&&(t=!1),this._players.push(e),t&&(this._localPlayer=e)},t.setMyPlayerNumber=function(e){this._myPlayerNumber=e},t.getMyPlayerNumber=function(){return this._myPlayerNumber},t.getPlayer=function(e){return e===this._myPlayerNumber&&this._localPlayer?this._localPlayer:this._players.find((function(t){return t.playerNumber===e}))},t.getPlayerBase=function(e){var t=this.getPlayer(e);return t?t.piecesBase:null},t.getPlayerPiece=function(e,t){var n=this.getPlayer(e);return n&&n.pawns.length>t?n.pawns[t]:null},t.clearPlayers=function(){this._players=[],this._localPlayer=null},r(e,null,[{key:"instance",get:function(){return this._instance||(this._instance=new e),this._instance}}]),e}();Xi._instance=null,l._RF.pop(),l._RF.push({},"7d609DnofpOup1Z3nz9INPE","Snl_Board",void 0);var $i=c.ccclass,eo=c.property,to=(Ei=$i("SnlHomeTiles"),Ri=eo({type:[u]}),Ei((Di=e((Ai=function(){n(this,"homeTiles",Di,this)}).prototype,"homeTiles",[Ri],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ii=Ai))||Ii),no=$i("Snake")(Li=function(e,t,n){this.data=void 0,this.animationPoints=void 0,this.node=null,this.data=e,this.node=t,this.animationPoints=n})||Li,io=(Fi=$i("SnlBoard"),ki=eo({type:[u]}),Mi=eo({type:[to]}),zi=eo({type:M}),Hi=eo({type:u}),Gi=eo({type:u}),Ui=eo({type:u}),xi=eo({type:u}),Fi(((qi=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"pathTiles",Vi,i(t)),n(t,"homeTiles",Ki,i(t)),n(t,"powerupOffsetFromTileCenter",ji,i(t)),n(t,"rotationPivot",Ji,i(t)),n(t,"boardSpriteNode",Yi,i(t)),n(t,"snakesAndLaddersParent",Zi,i(t)),n(t,"powerupsParent",Qi,i(t)),t._initialOffset=0,t._isInitialized=!1,t.gameOptions=null,t.rocketSteps=8,t.tileTypes=[],t.pieces=[],t.powerUps=[],t.snakesData=[],t.ladders=[],t.snakesAnimationPoints=[],t.laddersAnimationPoints=[],t.snakes=[],t}t(o,e);var a=o.prototype;return a.onLoad=function(){null!=o._instance&&this.node.destroy(),o._instance=this,this._initialOffset=26},a.onDestroy=function(){this.cleanup()},a.cleanup=function(){o._instance===this&&(o._instance=null)},a.Initialize=function(e){if(!this._isInitialized){this.gameOptions=e.gameOptions;var t=e.playersData.find((function(e){return e.sessionId==Ht.Instance.getMySessionId()}));null!=t&&this.rotationPivot.setRotationFromEuler(0,0,180+90*this.getPlayerPositionOnBoard(t.playerNumber)),this._isInitialized=!0,this.rocketSteps=this.gameOptions.rocketSteps,null!=t&&console.log("Creating board preset for player ",t.playerNumber),this.createTiles(e),this.createLadders(e),this.createSnakes(e)}},a.reset=function(e){this.createTiles(e)},a.createTiles=function(e){this.tileTypes=[];for(var t=0;t<e.board.boardTiles.length;t++)this.tileTypes.push(e.board.boardTiles[t]);this.createPowerups()},a.createSnakes=function(e){var t=e.board.snakes;console.log("[Snakes] snakes count: ",t.length);for(var n=0;n<t.length;n++){var i=t[n],o=On.instance.snakePrefabs[i.snakePresetIndex],r=w(o);r.setParent(this.snakesAndLaddersParent,!0);var a=this.pathTiles[i.startTile-1];r.setWorldPosition(a.worldPosition.clone()),r.setScale(1,1,1),this.snakesData.push(i);var s=r.getComponent(Ni);this.snakesAnimationPoints.push(s),this.snakes.push(new no(i,r,s))}console.log("[Snakes] snakes animation points count: ",this.snakesAnimationPoints.length)},a.createLadders=function(e){for(var t=e.board.ladders,n=0;n<t.length;n++){var i=t[n],o=On.instance.ladderPrefabs[i.ladderPresetIndex],r=w(o);r.setParent(this.snakesAndLaddersParent,!0);var a=this.pathTiles[i.startTile-1];r.setWorldPosition(a.worldPosition.clone()),r.setScale(1,1,1),this.ladders.push(i),this.laddersAnimationPoints.push(r.getComponent(Ni))}},a.createPowerups=function(){for(var e=[],t=0;t<this.tileTypes.length;t++)for(var n=0;n<this.gameOptions.PowerupTypes.length;n++)if(this.tileTypes[t]&this.gameOptions.PowerupTypes[n]){var i=this.popPowerupON(t);if(null!=i){e.push(i);break}var o=w(On.instance.powerUpPrefab).getComponent(Pi);o.node.setParent(this.powerupsParent,!0),o.node.worldPosition=this.pathTiles[t-1].worldPosition.clone().add(new L(0,-15,0)),o.setPathNumber(t),o.setPowerUpType(this.tileTypes[t]),e.push(o);break}for(var r=0;r<this.powerUps.length;r++)this.powerUps[r].node.destroy();this.powerUps=e},a.popPowerupON=function(e){var t=this.powerUps.findIndex((function(t){return t.pathNumber===e}));if(-1!==t){var n=this.powerUps[t];return this.powerUps.splice(t,1),n}return null},a.getPowerUpType=function(e){for(var t=this.tileTypes[e.pathNumber],n=0;n<this.gameOptions.PowerupTypes.length;n++)if(t&this.gameOptions.PowerupTypes[n])return this.gameOptions.PowerupTypes[n];return Cn.DEFAULT},a.getPowerupNode=function(e){var t=this.powerUps.find((function(t){return t.pathNumber===e.pathNumber}));return t?t.node:null},a.removePowerUp=function(e){this.tileTypes[e.pathNumber]=Cn.DEFAULT;var t=this.powerUps.indexOf(e);-1!==t&&this.powerUps.splice(t,1),e.node.destroy()},a.removePowerUpByPathNumber=function(e){this.tileTypes[e]=Cn.DEFAULT;var t=this.powerUps.findIndex((function(t){return t.pathNumber===e}));-1!==t&&(this.powerUps[t].node.destroy(),this.powerUps.splice(t,1))},a.getPathTile=function(e,t,n){if(0===e)return this.getPlayerBase(t);var i=this.getGlobalTileIndex(e,t);return this.pathTiles[i]},a.getPathPositions=function(e,t,n,i){var o=[],r=null;if(0===t){for(var a=e;a>=0;a--)(r=this.getPathTile(a,n,i))||console.error("Path tile not found for path number: ",a," player number: ",n," piece index: ",i),o.push(r.worldPosition.clone());return console.log("Piece going to home: path positions length ",o.length," start path number: ",e," end path number: ",t),o}for(var s=e;s<=t;s++)null!=(r=this.getPathTile(s,n,i))&&o.push(r.worldPosition.clone());return o},a.getGlobalTileIndex=function(e,t){return e-1},a.isValidPathNumber=function(e,t){return e>=1&&e<=this.TotalPathCount(this.gameOptions)},a.TotalPathCount=function(e){return e.boardTilesCount},a.isSafeTile=function(e){return(this.tileTypes[e]&Cn.SAFE)>0},a.isPathOccupied=function(e,t){return 0!==e&&this.pieces.some((function(e){return e.pathNumber===t.pathNumber&&e!==t}))},a.getPawnsCountOnTile=function(e){return 0===e?0:this.pieces.filter((function(t){return t.pathNumber===e})).length},a.getPawnsOnTile=function(e){return 0===e?[]:this.pieces.filter((function(t){return t.pathNumber===e}))},a.canKillOtherPieces=function(e,t,n){if(e<=0)return!1;if(this.isSafeTile(e))return!1;var i=this.getPathTile(e,t,n);return!(i.children.length>=3)&&i.children.some((function(e){return e.getComponent(yi).playerNumber!==t}))},a.piecesOnTile=function(e,t){return e<=0?0:this.pieces.filter((function(t){return t.pathNumber===e})).length},a.getKillablePieces=function(e){if(e.pathNumber<=0)return null;if(this.isSafeTile(e.pathNumber))return null;var t=this.pieces.filter((function(t){return t!==e&&t.pathNumber===e.pathNumber}));if(1===t.length){var n=t[0];if(n.playerNumber!==e.playerNumber)return n}return null},a.doesEnemyExist=function(e,t){return!(0===t||t>this.TotalPathCount(this.gameOptions))&&this.pieces.some((function(t){return t.pathNumber===e.pathNumber&&t.playerNumber!==e.playerNumber}))},a.doesAnyPieceExistOnPath=function(e,t){return!(0===t||t>this.TotalPathCount(this.gameOptions))&&this.pieces.some((function(n){return n!==e&&n.pathNumber===t}))},a.getRocketLandingPathNumber=function(e){for(var t=e.pathNumber,n=0;n<this.rocketSteps;n++){if(!this.isValidPathNumber(t+1,e.playerNumber))return console.log("Invalid Path Number: ",t+1),t;t+=1}return t},a.getPlayerPositionOnBoard=function(e){return[0,2,3,1][e]||0},a.getPlayerBase=function(e){return Xi.instance.getPlayerBase(e)},a.getPlayerPiece=function(e,t){return Xi.instance.getPlayerPiece(e,t)},a.addPieces=function(e){var t;(t=this.pieces).push.apply(t,e)},a.addPiece=function(e){this.pieces.push(e)},a.updateAllPiecePositions=function(){this.pieces.forEach((function(e){return e.updatePiecePosition()}))},a.getLadderAnimationPoints=function(e){var t=this.ladders.findIndex((function(t){return t.ladderPresetIndex===e}));return this.laddersAnimationPoints[t]},a.getSnakeAnimationPoints=function(e){var t=this.snakesData.findIndex((function(t){return t.snakePresetIndex===e}));return this.snakesAnimationPoints[t]},a.getSnake=function(e){var t=this.snakesData.findIndex((function(t){return t.snakePresetIndex===e}));return this.snakes[t]},r(o,null,[{key:"Instance",get:function(){return o._instance}}]),o}(h))._instance=null,Vi=e((Wi=qi).prototype,"pathTiles",[ki],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Ki=e(Wi.prototype,"homeTiles",[Mi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ji=e(Wi.prototype,"powerupOffsetFromTileCenter",[zi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return new M(0,0)}}),Ji=e(Wi.prototype,"rotationPivot",[Hi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Yi=e(Wi.prototype,"boardSpriteNode",[Gi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Zi=e(Wi.prototype,"snakesAndLaddersParent",[Ui],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qi=e(Wi.prototype,"powerupsParent",[xi],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Bi=Wi))||Bi);l._RF.pop(),l._RF.push({},"73474ShBSNCp6MYj8EOTjIP","SNLGameState",void 0);var oo=function(e){return e[e.NONE=0]="NONE",e[e.ROLLING=1]="ROLLING",e[e.MOVING_PIECE=2]="MOVING_PIECE",e[e.END_TURN=3]="END_TURN",e[e.ROLLING_ACK=4]="ROLLING_ACK",e[e.MOVING_PIECE_ACK=5]="MOVING_PIECE_ACK",e}({});l._RF.pop(),l._RF.push({},"188d5VyH+tJTahm43bSZiKp","Snl_BaseRoomState",void 0);var ro=function(){function e(e,t){this.currentRoomStatus=Ee.WAITING_FOR_PLAYERS,this.previousRoomStatus=Ee.NONE,this.roomSettings=void 0,this.playersData=void 0,this.spectatorsData=void 0,this.roomSettings=e,this.playersData=t,this.spectatorsData=[]}return e.prototype.copyFrom=function(e){this.currentRoomStatus=e.currentRoomStatus,this.previousRoomStatus=e.previousRoomStatus,this.roomSettings.copyFrom(e.roomSettings)},e}();l._RF.pop(),l._RF.push({},"e8295XdaVJK04GaKMfAZPMP","Snl_BasePlayerData",void 0);var ao=function(){function e(){this.userId=void 0,this.name=void 0,this.avatar=void 0,this.sessionId=void 0,this.playerNumber=void 0,this.type=void 0,this.isOnline=void 0,this.isConnected=void 0,this.isReplacedByBot=void 0,this.isKickedOut=void 0,this.isReady=void 0,this.score=void 0}return e.prototype.copyFrom=function(e){this.userId=e.userId,this.name=e.name,this.avatar=e.avatar,this.sessionId=e.sessionId,this.playerNumber=e.playerNumber,this.type=e.type,this.isOnline=e.isOnline,this.isConnected=e.isConnected,this.isReplacedByBot=e.isReplacedByBot,this.isKickedOut=e.isKickedOut,this.isReady=e.isReady,this.score=e.score},e}();l._RF.pop(),l._RF.push({},"bf274ySHyVCRaBe1Lt+wkW8","Snl_BaseRoomSettings",void 0);var so=function(){function e(){this.maxPlayers=void 0,this.minPlayers=void 0,this.maxClients=void 0,this.countdownTimeInSeconds=void 0,this.allowLateJoin=void 0,this.maxReconnectionAttempts=void 0,this.reconnectionAttemptInterval=void 0,this.reconnectionTime=void 0,this.gameFPS=void 0,this.serverFPS=void 0,this.patchRate=void 0}return e.prototype.copyFrom=function(e){this.maxPlayers=e.maxPlayers,this.minPlayers=e.minPlayers,this.maxClients=e.maxClients,this.countdownTimeInSeconds=e.countdownTimeInSeconds,this.allowLateJoin=e.allowLateJoin,this.reconnectionTime=e.reconnectionTime,this.gameFPS=e.gameFPS,this.serverFPS=e.serverFPS,this.patchRate=e.patchRate},e}();l._RF.pop(),l._RF.push({},"c748eNlwE9CRZ3zS/0Zlhjn","Snl_GameConfig",void 0);var lo=o({},{maxPlayers:8,minPlayers:2,maxClients:8,countdownTimeInSeconds:3,allowLateJoin:!0,maxReconnectionAttempts:3,reconnectionAttemptInterval:1e3,reconnectionTime:1e4,gameFPS:30,serverFPS:30,patchRate:1e3},{boardTilesCount:7,diceRollWaitTime:30,movePiecesWaitTime:30,lagDelayCompensationTime:1,animationWaitTime:10,rocketSteps:8,PowerupTypes:[Cn.ROCKET,Cn.SHIELD],show_mute_button:!1,show_result_screen:!0,show_faq:!0,MissTurnsToKickOut:3,turnWaitTime:30,maxReconnectionAttempts:10,piecesPerPlayer:2,boardIndex:0,boardTilesPerRow:8,snakeAnimationTimePerTile:.25,ladderAnimationTimePerTile:.1});l._RF.pop(),l._RF.push({},"4dde0jF7xFNHKcvHV98qN+F","SNLRoomSettings",void 0);var co=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this).turnWaitTime=lo.turnWaitTime,t.boardTilesCount=lo.boardTilesCount,t.boardTilesPerRow=lo.boardTilesPerRow,t.piecesPerPlayer=lo.piecesPerPlayer,t.boardIndex=lo.boardIndex,t.diceRollWaitTime=lo.diceRollWaitTime,t.movePiecesWaitTime=lo.movePiecesWaitTime,t.lagDelayCompensationTime=lo.lagDelayCompensationTime,t.animationWaitTime=lo.animationWaitTime,t.rocketSteps=lo.rocketSteps,t.PowerupTypes=lo.PowerupTypes,t.show_mute_button=lo.show_mute_button,t.show_result_screen=lo.show_result_screen,t.show_faq=lo.show_faq,t.MissTurnsToKickOut=lo.MissTurnsToKickOut,t.maxReconnectionAttempts=lo.maxReconnectionAttempts,t.snakeAnimationTimePerTile=lo.snakeAnimationTimePerTile,t.ladderAnimationTimePerTile=lo.ladderAnimationTimePerTile,t}return t(n,e),n.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.turnWaitTime=t.turnWaitTime,this.boardTilesCount=t.boardTilesCount,this.boardTilesPerRow=t.boardTilesPerRow,this.piecesPerPlayer=t.piecesPerPlayer,this.boardIndex=t.boardIndex,this.diceRollWaitTime=t.diceRollWaitTime,this.movePiecesWaitTime=t.movePiecesWaitTime,this.lagDelayCompensationTime=t.lagDelayCompensationTime,this.animationWaitTime=t.animationWaitTime,this.rocketSteps=t.rocketSteps,this.PowerupTypes=t.PowerupTypes,this.show_mute_button=t.show_mute_button,this.show_result_screen=t.show_result_screen,this.show_faq=t.show_faq,this.MissTurnsToKickOut=t.MissTurnsToKickOut,this.maxReconnectionAttempts=t.maxReconnectionAttempts,this.snakeAnimationTimePerTile=t.snakeAnimationTimePerTile,this.ladderAnimationTimePerTile=t.ladderAnimationTimePerTile},n}(so);l._RF.pop(),l._RF.push({},"7f17fKQ0pxNmppfWHiEOdtz","SNLBoard",void 0);var uo=function(){function e(){this.boardTiles=[],this.snakes=[],this.ladders=[]}return e.prototype.copyFrom=function(e){this.boardTiles=[];for(var t=0;t<e.boardTiles.length;t++)this.boardTiles.push(e.boardTiles[t]);this.snakes=[];for(var n=0;n<e.snakes.length;n++)this.snakes.push(e.snakes[n]);this.ladders=[];for(var i=0;i<e.ladders.length;i++)this.ladders.push(e.ladders[i])},e}();l._RF.pop(),l._RF.push({},"f8954WpxNhFWpgDtrYTrr9V","SNLPlayerData",void 0);var po=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this).pieces=[0,0],t.rollsList=[],t.timeLeft=0,t.finishPosition=-1,t.isBot=!1,t.hasKilled=!1,t.remainingTurnSkips=0,t.deathsCount=0,t.ladderClimbCount=0,t.hasShield=[!1,!1],t}return t(n,e),n.prototype.copyFrom=function(t){e.prototype.copyFrom.call(this,t),this.pieces=[];for(var n=0;n<t.pieces.length;n++)this.pieces.push(t.pieces[n]);this.rollsList=[];for(var i=0;i<t.rollsList.length;i++)this.rollsList.push(t.rollsList[i]);this.timeLeft=t.timeLeft,this.finishPosition=t.finishPosition,this.isBot=t.isBot,this.hasShield=[];for(var o=0;o<t.hasShield.length;o++)this.hasShield.push(t.hasShield[o]);this.hasKilled=t.hasKilled,this.remainingTurnSkips=t.remainingTurnSkips,this.deathsCount=t.deathsCount,this.ladderClimbCount=t.ladderClimbCount},n}(ao);l._RF.pop(),l._RF.push({},"eacc0N6oc1ISakU6bdEwjIT","SNLRoomState",void 0);var ho,fo,mo=function(){function e(){this.inputType=void 0,this.inputValue=void 0}return e.prototype.copyFrom=function(e){this.inputType=e.inputType,this.inputValue=e.inputValue},e}(),yo=function(e){function n(){var t;return(t=e.call(this,new co,[])||this).turnPlayerNumber=0,t.finishedCount=0,t.gameOptions=new co,t.inputPayload=new mo,t.currentGameState=oo.NONE,t.previousGameState=oo.NONE,t.syncStateNumber=0,t.board=new uo,t.hasMissedTurn=!0,t.timer=0,t}return t(n,e),n.prototype.copyFrom=function(t){console.log("============ CopyFrom snl room state ========="),e.prototype.copyFrom.call(this,t),this.playersData=t.playersData.map((function(e){var t=new po;return t.copyFrom(e),t})),this.spectatorsData=t.spectatorsData.map((function(e){var t=new ao;return t.copyFrom(e),t})),this.turnPlayerNumber=t.turnPlayerNumber,this.finishedCount=t.finishedCount,this.gameOptions=new co,this.gameOptions.copyFrom(t.gameOptions),this.syncStateNumber=t.syncStateNumber,this.inputPayload=new mo,this.inputPayload.copyFrom(t.inputPayload),this.board=new uo,this.board.copyFrom(t.board),this.hasMissedTurn=t.hasMissedTurn,this.timer=t.timer,this.currentGameState=t.currentGameState,this.previousGameState=t.previousGameState},n}(ro);l._RF.pop(),l._RF.push({},"8f941Mt23tMO4B9iQk2PiAH","Snl_GameManager",void 0);var go,vo,So,bo,_o,Co,To,Po,wo,Oo,No,Eo,Ro,Io,Ao=c.ccclass,Do=new S,Lo=Ao("SnlGameManager")(((fo=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this)._roomState=Ee.NONE,t._won=!1,t._handledGameOverCallbacks=!1,t._serverStateCopy=null,t._missTurnsToKickOut=3,t.miloSDK=new ee,t.gameStartTime=0,t}t(n,e);var i=n.prototype;return i.onLoad=function(){null!=n._instance&&this.node.destroy(),n._instance=this,this.miloSDK.init({gameId:"snl-game",debug:!0}),this.sendGameLoaded(),kt.on(de.CONNECTION_STATE_CHANGE,this.onConnectionStateChange,this),Mt.on(de.SERVER_ROOM_STATE_CHANGE,this.onServerStateChange,this)},i.sendGameLoaded=function(){var e={timestamp:Date.now()};this.miloSDK.gameLoaded(e)},i.sendGameStarted=function(){this.gameStartTime=Date.now();var e={timestamp:this.gameStartTime};this.miloSDK.gameStarted(e)},i.sendGameEnded=function(){var e=this,t=Date.now(),n={duration:this.gameStartTime>0?t-this.gameStartTime:0,hasWinningScreen:!0};setTimeout((function(){e.miloSDK.gameEnded(n)}),2e3)},i.onConnectionStateChange=function(e,t){t==fe.DISCONNECTED?this._roomState!=Ee.END_GAME&&Ht.Instance.reconnect():t==fe.KICKED_OUT&&this.setState(Ee.KICKED_OUT)},i.setState=function(e){this.OnRemoteGameStateChange(e),this._roomState=e,Do.emit(de.ROOM_STATUS_CHANGE,e)},i.onServerStateChange=function(e){null==this._serverStateCopy&&(this._serverStateCopy=new yo,this._serverStateCopy.copyFrom(e),this._missTurnsToKickOut=this._serverStateCopy.gameOptions.MissTurnsToKickOut),e.currentRoomStatus==Ee.END_GAME&&(console.log("Game Over"),this._serverStateCopy=new yo,this._serverStateCopy.copyFrom(e),this.handleWon(e)),this.setState(e.currentRoomStatus)},i.handleWon=function(e){var t=new yo;t.copyFrom(e);var n=Ht.Instance.CurrentRoom.sessionId,i=t.playersData.findIndex((function(e){return e.sessionId==n}));if(-1!=i){for(var o=t.playersData[i].pieces,r=io.Instance.TotalPathCount(t.gameOptions),a=0;a<o.length;a++)o[a]==r&&(this._won=!0);this._won?(Mo.instance.showConfetti(),Bt.instance.playSound("Win")):Bt.instance.playSound("Lose")}},i.onDestroy=function(){this.cleanup()},i.cleanup=function(){kt.off(de.CONNECTION_STATE_CHANGE,this.onConnectionStateChange,this),Mt.off(de.SERVER_ROOM_STATE_CHANGE,this.onServerStateChange,this),n._instance===this&&(n._instance=null)},i.GetPlayerData=function(){return console.log("Player Profiles : ",this._serverStateCopy.playersData),this._serverStateCopy.playersData.find((function(e){return e.sessionId==Ht.Instance.CurrentRoom.sessionId}))},i.GetWinnerPlayerData=function(){for(var e=-1,t=0;t<this._serverStateCopy.playersData.length;t++)if(this._serverStateCopy.playersData[t].finishPosition>=0){e=t;break}return console.log("Winner Player Id : ",e),-1==e?null:this._serverStateCopy.playersData.find((function(t){return t.playerNumber==e}))},i.OnRemoteGameStateChange=function(e){console.log("RemoteGameStateChange Message : "+e),this._roomState!=e&&(this._roomState==Ee.NONE&&e==Ee.WAITING_FOR_PLAYERS||e==Ee.COUNTDOWN||(e==Ee.GAME_SIMULATION?this.sendGameStarted():e==Ee.END_GAME&&(this.sendGameEnded(),this.HandleGameOverCallbacks())))},i.HandleGameOverCallbacks=function(){console.log("HandleGameOverCallbacks"),this._handledGameOverCallbacks?console.log("Already handled game over callbacks"):this._handledGameOverCallbacks=!0},i.setInput=function(e){},r(n,null,[{key:"Instance",get:function(){return this._instance}}]),n}(h))._instance=null,ho=fo))||ho;l._RF.pop(),l._RF.push({},"2304fly6R9HErKhay4HPyij","UIManager",void 0);var Fo=c.ccclass,ko=c.property,Mo=(go=Fo("UIManager"),vo=ko({type:f}),So=ko({type:[he]}),bo=ko({type:u}),_o=ko({type:P}),Co=ko({type:u}),go(((Io=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"uiCamera",wo,i(t)),n(t,"menus",Oo,i(t)),n(t,"flashNode",No,i(t)),n(t,"showerConfettiPrefab",Eo,i(t)),n(t,"confettiPositionNode",Ro,i(t)),t.showMuteButton=!0,t.showResultScreen=!0,t.showFAQ=!0,t}t(o,e);var r=o.prototype;return r.onLoad=function(){o.instance=this,Do.on(de.ROOM_STATUS_CHANGE,this.onGameStateChange,this)},r.start=function(){this.FixWidthOfUICamera()},r.onDestroy=function(){Do.off(de.ROOM_STATUS_CHANGE,this.onGameStateChange,this)},r.OpenHowToPlay=function(){this.OpenMenu("HowToPlay")},r.OpenMenu=function(e){for(var t=0;t<this.menus.length;t++)this.menus[t].menuName==e&&this.menus[t].Open()},r.CloseMenu=function(e){for(var t=0;t<this.menus.length;t++)this.menus[t].menuName==e&&this.menus[t].Close()},r.GetMenu=function(e){for(var t=0;t<this.menus.length;t++)if(this.menus[t].menuName==e)return this.menus[t];return null},r.CloseAllMenus=function(){for(var e=0;e<this.menus.length;e++)this.menus[e].Close()},r.onGameStateChange=function(e){var t=this;console.log("[UIManager] Game State Change: ",e),e==Ee.WAITING_FOR_PLAYERS?(console.log("Opening waiting screen"),this.updateUiBasedOnConfig(),this.OpenMenu("WaitingScreen")):e==Ee.COUNTDOWN?(console.log("Opening countdown screen"),this.CloseAllMenus(),this.OpenMenu("CountdownScreen")):e==Ee.GAME_SIMULATION?this.scheduleOnce((function(){t.CloseMenu("CountdownScreen"),t.OpenMenu("InGameMenu")}),1):e==Ee.END_GAME?(console.log("[UIManager] End Game State handling in ui manager"),this.CloseAllMenus(),console.log("[UIManager] Opening end round screen"),this.OpenMenu("RoundCompletedScreen")):e==Ee.KICKED_OUT&&(this.CloseAllMenus(),this.OpenMenu("KickedOutScreen"))},r.FixWidthOfUICamera=function(){console.log("Fixing width of UI Camera"),this.FixCanvasSize()},r.FixCanvasSize=function(){var e=this.node.getComponent(d);e.setContentSize(Ae.instance.getWidth(),2*Ae.instance.camera.orthoHeight),console.log("UI Width: ",e.width,"UI Height: ",e.height);var t=this.node.getComponent(z);t.top=960-e.height/2,t.bottom=960-e.height/2,t.updateAlignment();for(var n=this.node.getComponentsInChildren(z),i=0;i<n.length;i++)n[i].updateAlignment()},r.getAllChildWidgets=function(e){var t=e.getComponentsInChildren(z);console.log("All widgets: ",t.length)},r.updateUiBasedOnConfig=function(){this.showMuteButton=Lo.Instance._serverStateCopy.gameOptions.show_mute_button,this.showResultScreen=Lo.Instance._serverStateCopy.gameOptions.show_result_screen,this.showFAQ=Lo.Instance._serverStateCopy.gameOptions.show_faq;for(var e=0;e<this.menus.length;e++)this.menus[e].initialize()},r.playFlashEffect=function(e){var t=this;void 0===e&&(e=new N(197,8,8)),this.flashNode.active=!0;var n=this.flashNode.getComponent(E);n?(n.color=new N(e.r,e.g,e.b,0),D(n).to(.2,{color:new N(e.r,e.g,e.b,255)}).delay(.05).to(.3,{color:new N(e.r,e.g,e.b,0)}).call((function(){t.flashNode.active=!1})).start()):console.error("No Sprite component found on flashNode")},r.showConfetti=function(){var e=w(this.showerConfettiPrefab);this.confettiPositionNode.addChild(e),e.setPosition(new L(0,150,0))},o}(h)).instance=null,wo=e((Po=Io).prototype,"uiCamera",[vo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Oo=e(Po.prototype,"menus",[So],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),No=e(Po.prototype,"flashNode",[bo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Eo=e(Po.prototype,"showerConfettiPrefab",[_o],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ro=e(Po.prototype,"confettiPositionNode",[Co],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),To=Po))||To);l._RF.pop(),l._RF.push({},"9decd10gftDqoJe/mgUT2az","Snl_GameMessageType",void 0);var zo,Ho=function(e){return e.NONE="none",e.SET_STATE="set_state",e.DICE_OUTCOME="dice_outcome",e.CLIENT_DICE_ROLL="client_dice_roll",e.MOVE_PIECE="move_piece",e.ROLLING_ACK="rolling_ack",e.MOVE_PIECE_ACK="move_piece_ack",e.WAITING_ACK="waiting_ack",e.KICKED_OUT="kicked_out",e.PLAYER_CAMEBACK="player_cameback",e}({});l._RF.pop(),l._RF.push({},"b2e8fzT4bJJkqddZgECVmkg","Snl_BotMadeMoveScreen",void 0);var Go,Uo,xo,Bo,Wo,Vo,Ko,jo=c.ccclass;c.property,jo("SnlBotMadeMoveScreen")(zo=function(e){function n(){for(var t,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return(t=e.call.apply(e,[this].concat(i))||this)._timer=0,t}t(n,e);var i=n.prototype;return i.onLoad=function(){e.prototype.onLoad.call(this),this.content.on(u.EventType.TOUCH_START,this.OnClick,this)},i.onDestroy=function(){},i.Open=function(){e.prototype.Open.call(this),this._timer=0},i.Close=function(){e.prototype.Close.call(this)},i.initHandTween=function(){},i.initialization=function(){this.initHandTween()},i.OnClick=function(){Ht.Instance.sendMessage(Ho.PLAYER_CAMEBACK,{}),Mo.instance.CloseMenu(this.menuName)},n}(he));l._RF.pop(),l._RF.push({},"1e126xY1TNAfKHpOQHeNPdl","Snl_CountdownScreen",void 0);var Jo=c.ccclass,Yo=c.property;Go=Jo("SnlCountdownScreen"),Uo=Yo({type:I}),xo=Yo({type:u}),Go((Vo=e((Wo=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this)._countdownTween=null,n(t,"countdownText",Vo,i(t)),n(t,"blackBG",Ko,i(t)),t}t(o,e);var r=o.prototype;return r.onLoad=function(){e.prototype.onLoad.call(this)},r.onDestroy=function(){},r.Open=function(){e.prototype.Open.call(this),this.initialization()},r.Close=function(){e.prototype.Close.call(this),null!=this._countdownTween&&this._countdownTween.stop()},r.initCountdownTween=function(){var e=this;this.countdownText.node.active=!0,this._countdownTween=D(this.countdownText.node);for(var t=function(t){e._countdownTween.call((function(){e.countdownText.string=t.toString(),e.countdownText.node.scale=L.ONE.clone().multiplyScalar(2)})).to(1,{scale:L.ONE.clone().multiplyScalar(1)},{easing:"sineIn"})},n=3;n>=1;n--)t(n);this._countdownTween.call((function(){e.deactivateScreen()}))},r.deactivateScreen=function(){this.countdownText.string="",this.countdownText.node.active=!1,this.blackBG.active=!1},r.initialization=function(){this.initCountdownTween(),this._countdownTween.start()},o}(he)).prototype,"countdownText",[Uo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ko=e(Wo.prototype,"blackBG",[xo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Bo=Wo));l._RF.pop(),l._RF.push({},"7d0d7BMdoVEXqSMYiQCj7U2","Snl_AnimationTag",void 0);var Zo,Qo,qo,Xo,$o,er,tr,nr,ir,or=function(e){return e[e.DICE_ROLL=0]="DICE_ROLL",e[e.PIECE_MOVE=1]="PIECE_MOVE",e}({});l._RF.pop(),l._RF.push({},"7dd36jzz+1A04Qf8KqHC45+","Snl_Dice",void 0);var rr,ar,sr,lr,cr,ur=c.ccclass,pr=c.property,hr=(Zo=ur("SnlDice"),Qo=pr({type:[O]}),qo=pr({type:[O]}),Xo=pr({type:E}),Zo((tr=e((er=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"diceFaces",tr,i(t)),n(t,"rollingFrames",nr,i(t)),n(t,"diceSprite",ir,i(t)),t.onDiceRollDone=function(){},t._currentFace=0,t._rollingTween=null,t._rollDuration=.5,t}t(o,e);var r=o.prototype;return r.onLoad=function(){this._rollingTween=D(this.diceSprite.node)},r.rollDice=function(e){Bt.instance.playSound("DiceRoll"),this.rollAnimation(e)},r.setDiceFace=function(e){e<0||e>=this.diceFaces.length||(this._currentFace=e,this.diceSprite.spriteFrame=this.diceFaces[e])},r.rollAnimation=function(e){var t=this;this.stopRolling(),this._rollingTween=D({value:0}).to(.5,{value:13},{onUpdate:function(e){var n=Math.floor(e.value)%t.rollingFrames.length;t.diceSprite.spriteFrame=t.rollingFrames[n]}}).call((function(){t.setDiceFace(e),console.log("~~~ Dice Rolling Done ~~~"),t.onDiceRollDone()})),this._rollingTween.tag(or.DICE_ROLL),this._rollingTween.start()},r.stopRolling=function(){this._rollingTween&&this._rollingTween.stop()},r.reset=function(){this.diceSprite.spriteFrame=this.diceFaces[0]},o}(h)).prototype,"diceFaces",[Qo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),nr=e(er.prototype,"rollingFrames",[qo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),ir=e(er.prototype,"diceSprite",[Xo],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$o=er))||$o);l._RF.pop(),l._RF.push({},"80a58wc6VlK84Ys/IBzIYmU","Timer",void 0);var dr=c.ccclass,fr=c.property,mr=(rr=dr("Timer"),ar=fr({type:E}),rr((cr=e((lr=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this)._totalTime=0,t._currentTime=0,n(t,"timerSprite",cr,i(t)),t._canRunTimer=!1,t._isTimerWarning=!1,t._isLocal=!1,t}t(o,e);var r=o.prototype;return r.update=function(e){this._canRunTimer&&(this._currentTime-=e,this._currentTime<0&&(this._currentTime=0),this.timerSprite.fillRange=this.getTimeLeftPercentage(),this.checkAndSetTimerWarning())},r.isTimeUp=function(){return this._currentTime<=0},r.setTotalTime=function(e){this._totalTime=e,this._currentTime=e,this.timerSprite.fillRange=this.getTimeLeftPercentage()},r.setCurrentTime=function(e){this._currentTime=e,this.timerSprite.fillRange=this.getTimeLeftPercentage()},r.run=function(){this._canRunTimer=!0},r.stop=function(){this._canRunTimer=!1,this.reset()},r.reset=function(){this._isTimerWarning=!1,this.timerSprite.fillRange=0,Bt.instance.stopSound("TimerWarning")},r.getTimeLeftPercentage=function(){return this._currentTime/this._totalTime},r.checkAndSetTimerWarning=function(){this._isLocal&&this.getTimeLeftPercentage()<.2&&(this._isTimerWarning||(Bt.instance.playSound("TimerWarning"),this._isTimerWarning=!0))},r.setLocal=function(e){this._isLocal=e},o}(h)).prototype,"timerSprite",[ar],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),sr=lr))||sr);l._RF.pop(),l._RF.push({},"fad84JHd51NponoK3hrgvEv","Snl_BoardData",void 0);var yr=[{offset:{x:-2,y:-1,length:150}},{offset:{x:-2,y:-3,length:450}},{offset:{x:1,y:-2,length:300}},{offset:{x:1,y:-5,length:750}},{offset:{x:0,y:-4,length:600}},{offset:{x:-1,y:-1,length:150}}],gr=[{offset:{x:1,y:1,length:144}},{offset:{x:1,y:2,length:282}},{offset:{x:-1,y:3,length:424}},{offset:{x:0,y:5,length:604}},{offset:{x:-1,y:5,length:604}},{offset:{x:1,y:1,length:144}}];function vr(e,t,n,i,o){var r=Math.floor((e-1)/o),a=(e-1)%o;r%2==1&&(a=o-1-a);var s,l=r+n,c=a+t;return l<0||l>=Math.ceil(i/o)||c<0||c>=o||(s=l%2==0?l*o+c+1:l*o+(o-1-c)+1)<1||s>i?-1:s}l._RF.pop(),l._RF.push({},"d450ec5/GxKB6SIOpxWx3vz","Snl_DeathType",void 0);var Sr,br,_r,Cr,Tr,Pr,wr,Or,Nr,Er,Rr,Ir,Ar=function(e){return e[e.PAWN_KILL=0]="PAWN_KILL",e[e.SNAKE_BITE=1]="SNAKE_BITE",e}({});l._RF.pop(),l._RF.push({},"b44a9UahXtP4J/rmk4XDCCh","Snl_DeathPopup",void 0);var Dr=c.ccclass,Lr=c.property,Fr=(Sr=Dr("SnlDeathPopup"),br=Lr({type:H}),_r=Lr({type:E}),Cr=Lr({type:u}),Tr=Lr({type:O}),Sr(((Ir=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"deathText",Or,i(t)),n(t,"deathIcon",Nr,i(t)),n(t,"deathPopupNode",Er,i(t)),n(t,"deathIconSprites",Rr,i(t)),t.scaleTween=null,t.opacityTween=null,t.pendingScheduleId=null,t}t(o,e);var r=o.prototype;return r.onLoad=function(){o.instance=this},o.showDeathPopup=function(e,t,n){if(o.instance.deathPopupNode){o.instance.deathPopupNode.active=!0,o.instance.deathText.string=t,o.instance.deathIcon.spriteFrame=o.instance.getDeathIconSprite(n);var i=o.instance.deathPopupNode.getComponent(G);i&&i.updateLayout();var r=o.instance.deathPopupNode.getComponent(d);if(r){var a=o.instance.calculateAdjustedPosition(e,r,n);o.instance.deathPopupNode.setWorldPosition(a),o.instance.playDeathPopupAnimation()}else console.error("DeathPopup: Missing UITransform component on deathPopupNode")}else console.log("DeathPopup: deathPopupNode not assigned")},r.calculateAdjustedPosition=function(e,t,n){var i=io.Instance.boardSpriteNode,o=i.getComponent(d);if(!o)return console.error("DeathPopup: Board node missing UITransform component"),e;var r=i.worldPosition,a=o.width,s=r.x-.5*a,l=r.x+.5*a,c=t.width,u=e.x-.5*c,p=e.x+.5*c,h=e.x;if(u<s)h+=s-u;else if(p>l){h-=p-l}var f=.5*t.height+(n===Ar.SNAKE_BITE?40:50);return new L(h,e.y+f,e.z)},r.playDeathPopupAnimation=function(){var e=this;if(this.deathPopupNode){this.stopCurrentAnimation();var t=this.deathPopupNode.getComponent(U);t||(t=this.deathPopupNode.addComponent(U)),this.deathPopupNode.setScale(.75,.75,1),t.opacity=0,this.scaleTween=D(this.deathPopupNode).to(.3,{scale:new L(1,1,1)}).start(),this.opacityTween=D(t).to(.3,{opacity:255}).call((function(){e.pendingScheduleId=window.setTimeout((function(){e.scaleTween=D(e.deathPopupNode).to(.5,{scale:new L(.75,.75,1)}).start(),e.opacityTween=D(t).to(.5,{opacity:0}).call((function(){e.deathPopupNode.active=!1,e.scaleTween=null,e.opacityTween=null,e.pendingScheduleId=null})).start()}),2e3)})).start()}else console.error("DeathPopup: deathPopupNode not assigned for animation")},r.stopCurrentAnimation=function(){this.scaleTween&&(this.scaleTween.stop(),this.scaleTween=null),this.opacityTween&&(this.opacityTween.stop(),this.opacityTween=null),null!==this.pendingScheduleId&&(clearTimeout(this.pendingScheduleId),this.pendingScheduleId=null)},r.getDeathIconSprite=function(e){return this.deathIconSprites[e]},o}(h)).instance=null,Or=e((wr=Ir).prototype,"deathText",[br],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Nr=e(wr.prototype,"deathIcon",[_r],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Er=e(wr.prototype,"deathPopupNode",[Cr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Rr=e(wr.prototype,"deathIconSprites",[Tr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return[]}}),Pr=wr))||Pr);l._RF.pop(),l._RF.push({},"ba9c67Eq2dJO6NuKLSrX9Hi","Snl_PawnHandler",void 0);var kr,Mr,zr,Hr,Gr,Ur,xr,Br=0,Wr=1,Vr=function(){function e(e,t){this.player=void 0,this.pawns=void 0,this.state=Br,this.moveDataQueue=[],this.pawnAnimation=null,this.currentHandlingPieceIndex=-1,this.currentHandlingMoveData=null,this.pieceAnimationsTag=or.PIECE_MOVE,this.hasKilledInThisMove=!1,this.pawns=e,this.player=t}var t=e.prototype;return t.setState=function(e){this.state=e},t.onPawnMoveAnimationComplete=function(){io.Instance.updateAllPiecePositions()},t.handleData=function(){if(this.hasKilledInThisMove=!1,0!=this.moveDataQueue.length){this.StopPieceSelectAnimations();var e=this.moveDataQueue.shift();this.setState(Wr),this.player.outComesUIManager.removeOutCome(e.rollValue),this.currentHandlingPieceIndex=e.pieceIndex,this.currentHandlingMoveData=e,console.log("Handling Move Data: ","piece ",e.pieceIndex,"with roll value ",e.rollValue),this.pawnAnimation=this.pawns[e.pieceIndex].move(e.rollValue,this.onPieceLandedOnTargetTile.bind(this)),this.pawnAnimation.tag(this.pieceAnimationsTag),this.pawnAnimation.start()}else this.state==Wr&&(this.setState(Br),this.StartSelectAnimationsForValidMovePieces())},t.onPieceLandedOnTargetTile=function(){var e=this;console.log("Moved Piece to Target Tile: ",this.pawns[this.currentHandlingPieceIndex].pathNumber);var t=this.killOpponentPieces(this.pawns[this.currentHandlingPieceIndex]);if(null!=t)return t.call((function(){e.onPieceLandedOnTargetTile()})),void t.start();var n=this.handlePowerUps(this.pawns[this.currentHandlingPieceIndex]);if(null!=n)return Bt.instance.playSound("Power"),void n.start();var i=this.handleSnake(this.pawns[this.currentHandlingPieceIndex]);if(null==i){var o=this.handleLadder(this.pawns[this.currentHandlingPieceIndex]);null==o?(this.sendMoveAck(),this.onPawnMoveAnimationComplete()):o.start()}else i.start()},t.handlePowerUps=function(e){var t=io.Instance.getPowerUpType(e);switch(t){case Cn.ROCKET:return console.log("[PawnHandler] Landed on Rocket Powerup"),this.getRocketAnimation(e);case Cn.SHIELD:return console.log("[PawnHandler] Landed on Shield Powerup"),this.getShieldAnimation(e);default:return console.warn("[PawnHandler] Unhandled PowerUp Type: "+Cn[t]),null}},t.handleSnake=function(e){if(0==(io.Instance.tileTypes[e.pathNumber]&Cn.SNAKE))return null;if(console.log("---------------------Landed on Snake"),e.hasShield)return console.log("[PawnHandler] Piece has Shield. Skipping Snake Animation"),this.handleShield(e,!1),null;var t=io.Instance.snakesData.find((function(t){return t.startTile===e.pathNumber}));if(!t)return console.error("Couldn't Find Snake. Check Board Preset Data"),null;var n=yr[t.snakePresetIndex],i=vr(t.startTile,n.offset.x,n.offset.y,io.Instance.gameOptions.boardTilesCount,io.Instance.gameOptions.boardTilesPerRow),o=io.Instance.getPathTile(i,e.playerNumber,e.pieceNumber).worldPosition.clone(),r=this.player.playerData.name,a="<color=#FF0000><b>"+this.player.truncateName(r,8)+"</b> got bitten</color>",s=io.Instance.getSnake(t.snakePresetIndex);return s?(this.handleShield(e,!1),Fr.showDeathPopup(e.node.worldPosition.clone(),a,Ar.SNAKE_BITE),this.getSnakeAnimationFromPoints(e,o,s,i,n)):(console.error("Couldn't Find Snake. Check Board Preset Data"),null)},t.handleLadder=function(e){if(!(0!=(io.Instance.tileTypes[e.pathNumber]&Cn.LADDER)))return null;console.log("--------------------- Landed on Ladder");var t=io.Instance.ladders.find((function(t){return t.startTile==e.pathNumber}));if(null==t)return console.error("Couldnt FInd Ladder. Check Board Preset Data"),null;var n=gr[t.ladderPresetIndex],i=vr(t.startTile,n.offset.x,n.offset.y,io.Instance.gameOptions.boardTilesCount,io.Instance.gameOptions.boardTilesPerRow),o=io.Instance.getPathTile(i,e.playerNumber,e.pieceNumber).worldPosition.clone();return console.log("[Ladder] Final Position: ",o),this.getLadderMoveAnimation(e,e.node.worldPosition.clone(),o,i,n)},t.getSnakeAnimationFromPoints=function(e,t,n,i,o){var r=this,a=n.animationPoints.points,s=io.Instance.gameOptions.snakeAnimationTimePerTile,l=.25,c=.9*(o.offset.length*s),u=o.offset.length/c,p=D(e.node);p.delay(1),p.call((function(){r.player._isLocal&&(console.log("[PawnHandler] Playing Flash Effect"),Mo.instance.playFlashEffect()),D(e.node).to(.1,{scale:e.node.scale.clone().multiplyScalar(1.2)}).to(.1,{scale:e.node.scale.clone().multiplyScalar(.9)}).start()})),p.delay(.2),p.call((function(){Bt.instance.playSound("ChompSnakeBite"),e.scaleDownPieceWithWiggle(l).start()})),p.call((function(){r.AnimateSnakeHead(n.node).start()})),p.delay(.35),p.call((function(){Bt.instance.stopSound("ChompSnakeBite"),Bt.instance.playSound("SnakeBite"),e.animateSnakeBulge(c).start()}));Math.floor(a.length/2);for(var h=0;h<a.length-1;h++){var d=L.distance(a[h].worldPosition,a[h+1].worldPosition)/u;p.to(d,{worldPosition:a[h+1].worldPosition})}var f=L.distance(a[a.length-1].worldPosition,t)/u;return p.to(f,{worldPosition:t}),p.call((function(){e.scaleUpPieceWithBounce(l).start()})),p.delay(.35),p.call((function(){e.setPathNumber(i),e.updateParentNode(),r.onPieceLandedOnTargetTile()}))},t.getDistanceBetweenTwoTiles=function(e,t){var n=Math.floor(e/io.Instance.gameOptions.boardTilesPerRow),i=Math.floor(t/io.Instance.gameOptions.boardTilesPerRow),o=e%io.Instance.gameOptions.boardTilesPerRow,r=t%io.Instance.gameOptions.boardTilesPerRow;return Math.sqrt(Math.pow(n-i,2)+Math.pow(o-r,2))},t.getRocketAnimation=function(e){var t=this,n=io.Instance.getRocketLandingPathNumber(e);console.log("Rocket Landing Path Number: ",n);var i=io.Instance.getPowerupNode(e);io.Instance.removePowerUp(i.getComponent(Pi)),e.setPathNumber(n),e.updateParentNode();var o=io.Instance.getPathTile(n,e.playerNumber,e.pieceNumber).worldPosition.clone(),r=L.distance(e.node.worldPosition,o)/100*.15,a=o.clone().subtract(e.node.worldPosition).normalize();r=Math.max(r,.3);var s=D(e.node).call((function(){e.playPropellerAnimation(a)})).to(r,{worldPosition:o});return s.call((function(){e.stopPropellerAnimation(),t.onPieceLandedOnTargetTile()})),s.tag(this.pieceAnimationsTag),s},t.handleShield=function(e,t){console.log("[PawnHandler] Handling Shield for Piece: ",e.pieceNumber,"with active: ",t),e.setShieldActive(t)},t.getShieldAnimation=function(e){return e.setShieldActive(!0),null},t.getLadderMoveAnimation=function(e,t,n,i,o){var r=this,a=(e.pathNumber,o.offset.length*io.Instance.gameOptions.ladderAnimationTimePerTile);console.log("[Ladder] Distance: ",o.offset.length,"totalTime: ",a);var s=e.node.scale.clone(),l=D(e.node).call((function(){r.player._isLocal&&Mo.instance.playFlashEffect(new N(15,156,4)),Bt.instance.playSound("Ladder"),e.node.setWorldPosition(t)}));return l.to(a,{worldPosition:n,scale:s}),l.call((function(){console.log("[Ladder] Climb Animation complete"),e.setPathNumber(i),e.updateParentNode(),r.onPieceLandedOnTargetTile()})),l},t.killOpponentPieces=function(e){var t=this,n=io.Instance.getKillablePieces(e);if(null!=n){console.log("Killing Opponent Piece: ","piece ",n.pieceNumber,"of player ",n.playerNumber);var i=this.player.playerData.name,o=this.player.truncateName(i,8),r=n.playerNumber,a=Xi.instance.getPlayer(r),s=a.playerData.name,l="<color=#FF0000><b>"+o+"</b> killed <b>"+a.truncateName(s,8)+"!</b></color>";Fr.showDeathPopup(n.node.worldPosition.clone(),l,Ar.PAWN_KILL);var c=io.Instance.getPathPositions(n.pathNumber,0,n.playerNumber,n.pieceNumber);n.setPathNumber(0),n.updateParentNode(),n.updatePieceScale();var u=v.clamp(L.distance(n.node.worldPosition,c[c.length-1])/50*.15,.3,1);console.log("kill animation duration per tile: ",u),this.handleShield(n,!1);var p=D(n.node);return p.delay(1),p.call((function(){n.onKilled(),n.node.setWorldPosition(c[0])})),p.to(u,{worldPosition:c[c.length-1]},{progress:function(e,n,i,o){return v.lerp(e,n,t.easeOutBack(o))}}),p.call((function(){})),this.hasKilledInThisMove=!0,p}},t.easeOutBack=function(e){var t=1.70158*1.5;return 1+3.5523700000000002*Math.pow(e-1,3)+t*Math.pow(e-1,2)},t.movePiece=function(e,t,n){this.moveDataQueue.push({pieceIndex:e,rollValue:t,sendAck:n}),this.state==Br&&this.handleData()},t.updateShields=function(e){for(var t=0;t<this.pawns.length;t++)this.handleShield(this.pawns[t],e.playersData[this.player.playerNumber].hasShield[t])},t.Reset=function(e){this.stopAllAnimations(),this.moveDataQueue=[],this.setState(Br),this.ResetPawnPositions(e),this.updateShields(e),io.Instance.reset(e)},t.ResetPawnPositions=function(e){for(var t=e.playersData[this.player.playerNumber],n=0;n<t.pieces.length;n++)this.pawns[n].reset(t.pieces[n]);console.log("Reset Pawn Positions of Player: ",this.player.playerNumber)},t.stopAllAnimations=function(){this.StopPieceSelectAnimations(),x.stopAllByTag(this.pieceAnimationsTag)},t.sendMoveAck=function(){Ht.Instance.CurrentRoom.send(Ho.MOVE_PIECE_ACK,JSON.stringify({}))},t.isAnimating=function(){return this.state==Wr},t.StartSelectAnimationsForValidMovePieces=function(){if(this.player._isLocal)for(var e=this.player._stateMachine.movePieceState.getAllMovablePieces(),t=0;t<e.length;t++)e[t].playSelectAnimation()},t.StopPieceSelectAnimations=function(){if(this.player._isLocal)for(var e=0;e<this.pawns.length;e++)this.pawns[e].stopSelectAnimation()},t.AnimateSnakeHead=function(e){var t=e.children[0].getChildByName("SnakeHead");if(null!=t){console.log("Animating Snake Head: ",t);var n=D(t),i=t.scale.clone();return n.to(.15,{scale:new L(.6*i.x,1.8*i.y,i.z)}),n.to(.2,{scale:new L(.85*i.x,1.3*i.y,i.z)}),n.to(.15,{scale:i}),n}},e}();l._RF.pop(),l._RF.push({},"1589dGol3RCZrnubRpcxJKA","Snl_OutComesUIManager",void 0);var Kr,jr,Jr,Yr,Zr,Qr,qr,Xr,$r,ea,ta,na,ia,oa=c.ccclass,ra=c.property,aa=(kr=oa("SnlOutComesUIManager"),Mr=ra({type:P}),zr=ra({type:E}),kr((Ur=e((Gr=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"outComesPrefab",Ur,i(t)),n(t,"outcomesUiBgSprite",xr,i(t)),t.currentOutComesUI=[],t.currentOutComesValues=[],t.goldenDiceOutcomes=0,t.player=null,t}t(o,e);var r=o.prototype;return r.setGoldenDiceOutcomes=function(e){this.goldenDiceOutcomes=e},r.addOutCome=function(e){var t=w(this.outComesPrefab);t.setParent(this.node),t.getComponent(E).spriteFrame=On.instance.getDiceOutComesStackSprite(e),this.currentOutComesUI.length<this.goldenDiceOutcomes&&6==e&&(t.getComponent(E).spriteFrame=On.instance.getGoldenDiceOutComeSprite()),this.currentOutComesUI.push(t),this.currentOutComesValues.push(e),this.onOutComesChanged()},r.removeOutCome=function(e){var t=this.currentOutComesValues.indexOf(e);-1!=t&&(this.currentOutComesUI[t].destroy(),this.currentOutComesUI.splice(t,1),this.currentOutComesValues.splice(t,1)),this.onOutComesChanged()},r.clearAllOutComes=function(){this.currentOutComesUI.forEach((function(e){e.destroy()})),this.currentOutComesUI=[],this.currentOutComesValues=[],this.onOutComesChanged()},r.getOutComes=function(){return this.currentOutComesValues},r.onOutComesChanged=function(){this.currentOutComesValues.length<=0?this.player.enableName(!0):this.player.enableName(!1)},r.reset=function(e){this.clearAllOutComes();for(var t=0;t<e.length;t++)this.addOutCome(e[t])},r.setPlayer=function(e){this.player=e},r.enableOutComesBg=function(e){this.outcomesUiBgSprite.enabled=e},o}(h)).prototype,"outComesPrefab",[Mr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),xr=e(Gr.prototype,"outcomesUiBgSprite",[zr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Hr=Gr))||Hr);l._RF.pop(),l._RF.push({},"57a2bIGh8lM7qLp8vSOmTjE","Snl_MoveOptionsInput",void 0);var sa=c.ccclass,la=c.property,ca=(Kr=sa("SnlMoveOptionsInput"),jr=la({type:E}),Jr=la({type:E}),Yr=la({type:E}),Zr=la({type:u}),Qr=la({type:d}),Kr(($r=e((Xr=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"firstOutComeSprite",$r,i(t)),n(t,"secondOutComeSprite",ea,i(t)),n(t,"thirdOutComeSprite",ta,i(t)),t.outComeValues=[6,6,6],n(t,"pointer",na,i(t)),t.outComeClickedCallback=null,t.uiTransform=null,n(t,"optionsUITransform",ia,i(t)),t}t(o,e);var r=o.prototype;return r.onLoad=function(){this.uiTransform=this.node.getComponent(d)},r.onEnable=function(){this.firstOutComeSprite.node.on(u.EventType.TOUCH_START,this.onFirstOutComeClick,this),this.secondOutComeSprite.node.on(u.EventType.TOUCH_START,this.onSecondOutComeClick,this),this.thirdOutComeSprite.node.on(u.EventType.TOUCH_START,this.onThirdOutComeClick,this)},r.onDisable=function(){this.firstOutComeSprite.node.off(u.EventType.TOUCH_START,this.onFirstOutComeClick,this),this.secondOutComeSprite.node.off(u.EventType.TOUCH_START,this.onSecondOutComeClick,this),this.thirdOutComeSprite.node.off(u.EventType.TOUCH_START,this.onThirdOutComeClick,this)},r.onDestroy=function(){this.cleanup()},r.cleanup=function(){this.firstOutComeSprite&&this.firstOutComeSprite.node&&this.firstOutComeSprite.node.off(u.EventType.TOUCH_START,this.onFirstOutComeClick,this),this.secondOutComeSprite&&this.secondOutComeSprite.node&&this.secondOutComeSprite.node.off(u.EventType.TOUCH_START,this.onSecondOutComeClick,this),this.thirdOutComeSprite&&this.thirdOutComeSprite.node&&this.thirdOutComeSprite.node.off(u.EventType.TOUCH_START,this.onThirdOutComeClick,this)},r.setOutComeSprites=function(e){this.outComeValues=e,e.length>=1&&(this.firstOutComeSprite.spriteFrame=On.instance.getDiceOutComesStackSprite(this.outComeValues[0])),e.length>=2?(console.log("Setting Second OutCome"),this.secondOutComeSprite.node.active=!0,this.secondOutComeSprite.spriteFrame=On.instance.getDiceOutComesStackSprite(this.outComeValues[1])):this.secondOutComeSprite.node.active=!1,e.length>=3?(console.log("Setting Third OutCome"),this.thirdOutComeSprite.node.active=!0,this.thirdOutComeSprite.spriteFrame=On.instance.getDiceOutComesStackSprite(this.outComeValues[2])):this.thirdOutComeSprite.node.active=!1},r.onFirstOutComeClick=function(){null!=this.outComeClickedCallback&&this.outComeClickedCallback(this.outComeValues[0])},r.onSecondOutComeClick=function(){null!=this.outComeClickedCallback&&this.outComeClickedCallback(this.outComeValues[1])},r.onThirdOutComeClick=function(){null!=this.outComeClickedCallback&&this.outComeClickedCallback(this.outComeValues[2])},r.SetPosition=function(e){this.node.setWorldPosition(e);var t=Ae.instance.getWidth(),n=this.optionsUITransform.node.position;n.set(0,7.5,0),console.log("setting worldPosintion : ",e);var i=e.x-.5*this.optionsUITransform.width,o=e.x+.5*this.optionsUITransform.width;i<0?(console.log("My X Left Bound: ",i,"Screen Width: ",t),n.add(new L(.5*this.optionsUITransform.width-45,0,0))):o>t&&(console.log("My X Right Bound: ",o,"Screen Width: ",t),n.add(new L(.5*-this.optionsUITransform.width+45,0,0))),this.optionsUITransform.node.setPosition(n)},o}(h)).prototype,"firstOutComeSprite",[jr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ea=e(Xr.prototype,"secondOutComeSprite",[Jr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ta=e(Xr.prototype,"thirdOutComeSprite",[Yr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),na=e(Xr.prototype,"pointer",[Zr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ia=e(Xr.prototype,"optionsUITransform",[Qr],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qr=Xr))||qr);l._RF.pop(),l._RF.push({},"a481d7dTmFEGoDykgL19t0o","Snl_PlayerBaseState",void 0);var ua=function(){};l._RF.pop(),l._RF.push({},"6b743sDeAhByp9my+GfwP/h","Snl_IdleState",void 0);var pa=function(e){function n(t){var n;return(n=e.call(this)||this).stateMachine=void 0,n._stateName=vs.IDLE,n.player=void 0,n.stateMachine=t,n.player=n.stateMachine.player,n}t(n,e);var i=n.prototype;return i.enterState=function(){this.clearPlayerData()},i.updateState=function(e){},i.exitState=function(){},i.clearPlayerData=function(){this.player.timer.stop(),this.player.timer.reset(),this.player.outComesUIManager.setGoldenDiceOutcomes(0),this.player.outComesUIManager.clearAllOutComes(),this.player.outComesUIManager.enableOutComesBg(!1),this.player.dice.reset(),this.player.diceRoot.active=!1,null!=this.player._moveOptioneInput&&(this.player._moveOptioneInput.node.active=!1)},n}(ua);l._RF.pop(),l._RF.push({},"41da4EV04xLZIopQqU1Qqt5","Snl_MovePieceState",void 0);var ha=function(e){function n(t){var n;return(n=e.call(this)||this).stateMachine=void 0,n._stateName=vs.MOVING_PIECE,n.player=void 0,n.moveOptionsOffset=new L(0,120,0),n.stateMachine=t,n.player=n.stateMachine.player,n}t(n,e);var i=n.prototype;return i.enterState=function(){console.log("Entered Moving Piece State"),console.log("Rolls : ",this.player.outComesUIManager.getOutComes());var e=this.stateMachine.currentServerState.playersData[this.player.playerNumber];this.player.outComesUIManager.reset(e.rollsList),this.player.diceRoot.active=!0,this.player.timer.stop(),this.player.timer.setTotalTime(this.stateMachine.currentServerState.gameOptions.movePiecesWaitTime),this.player.timer.run(),this.player._pawnHandler.StartSelectAnimationsForValidMovePieces();for(var t=0;t<this.player.pawns.length;t++)this.player.pawns[t].node.on(u.EventType.TOUCH_START,this.OnPieceClick,this)},i.updateState=function(e){},i.exitState=function(){console.log("Exited Move Piece State local ",this.player._isLocal),this.player.diceRoot.active=!1,this.player.timer.stop(),this.player._pawnHandler.Reset(this.stateMachine.currentServerState);for(var e=0;e<this.player.pawns.length;e++)this.player.pawns[e].node.off(u.EventType.TOUCH_START,this.OnPieceClick,this)},i.getAllMovablePieces=function(){for(var e,t=this,n=[],i=this.player.outComesUIManager.getOutComes(),o=function(o){e=i.filter((function(e){return t.canMovePiece(t.player.pawns[o].pathNumber,e)})),(e=Array.from(new Set(e))).length>0&&n.push(t.player.pawns[o])},r=0;r<this.player.pawns.length;r++)o(r);return n},i.OnPieceClick=function(e){var t=this;if(this.player._isLocal)if(this.player._pawnHandler.isAnimating())this.player._moveOptioneInput.node.active=!1;else{this.player._moveOptioneInput.node.active=!1;var n=e.target.getComponent(yi),i=this.player.outComesUIManager.getOutComes().filter((function(e){return t.canMovePiece(n.pathNumber,e)}));if(i=Array.from(new Set(i)),console.log("Piece Valid OutComes: ",i),0!=i.length)return 1==i.length&&this.sendMovePieceMessage(n.pieceNumber,i[0]),i.length>=2?(this.player._moveOptioneInput.node.active=!0,this.player._moveOptioneInput.outComeClickedCallback=this.outComeClickedCallback.bind(this),this.player._moveOptioneInput.setOutComeSprites(i),this.player._currentSelectedPieceNumber=n.pieceNumber,void this.player._moveOptioneInput.SetPosition(e.target.worldPosition.clone().add(this.moveOptionsOffset))):void 0}},i.onMovePiece=function(){var e=JSON.parse(this.stateMachine.currentServerState.inputPayload.inputValue);console.log("Move Piece From Server: ",e);var t=e.pieceIndex,n=e.rollValue;this.player.timer.stop(),this.player._moveOptioneInput.node.active=!1,this.player._pawnHandler.movePiece(t,n,!0)},i.canMovePiece=function(e,t){var n=this.player._gameOptions;return(0!=e||6==t)&&!(e+t>this.TotalPathCount(n))},i.TotalPathCount=function(e){return e.boardTilesCount},i.sendMovePieceMessage=function(e,t){Lo.Instance.setInput("MovePiece"),Ht.Instance.CurrentRoom.send(Ho.MOVE_PIECE,JSON.stringify({pieceIndex:e,rollValue:t})),console.log("Move Piece Message Sent : ","piece ",e,"with roll value ",t)},i.outComeClickedCallback=function(e){this.sendMovePieceMessage(this.player._currentSelectedPieceNumber,e),this.player._moveOptioneInput.node.active=!1,this.player._currentSelectedPieceNumber=-1},i.reset=function(){this.exitState()},n}(ua);l._RF.pop(),l._RF.push({},"9a8829asNRNJrRAy5IvaFib","Snl_RollingState",void 0);var da=function(e){function n(t){var n;return(n=e.call(this)||this).stateMachine=void 0,n._stateName=vs.ROLLING,n.player=void 0,n.currentDiceOutcome=0,n.goldenDiceOutcomes=0,n.stateMachine=t,n.player=n.stateMachine.player,n.player.dice.onDiceRollDone=n.onDiceRollDone.bind(i(n)),n}t(n,e);var o=n.prototype;return o.enterState=function(){console.log("Entered Rolling State"),this.player.diceRoot.active=!0,this.player.timer.stop(),this.player.outComesUIManager.enableOutComesBg(!0),this.player.timer.setTotalTime(this.stateMachine.currentServerState.gameOptions.diceRollWaitTime),this.player.timer.run(),this.player._pawnHandler.Reset(this.stateMachine.currentServerState),this.player.dice.reset();var e=this.stateMachine.currentServerState.playersData[this.player.playerNumber];this.player.outComesUIManager.reset(e.rollsList),this.player._isLocal&&(console.log("Setting Local Player Dice Click"),this.player.dice.node.on(u.EventType.TOUCH_START,this.OnDiceClick,this),this.player.arrowPointToDiceAnimation(!0),Lo.Instance.miloSDK.vibratePreset("light"))},o.updateState=function(e){},o.exitState=function(){this.player.diceRoot.active=!0,this.player.timer.stop(),console.log("Exited Rolling State local ",this.player._isLocal),this.player._isLocal&&this.player.dice.node.off(B.EventType.TOUCH_START,this.OnDiceClick,this)},o.OnDiceClick=function(e){console.log("OnDiceClick"),this.player._isLocal&&(console.log("OnDiceClick 2"),this.player.dice.node.off(B.EventType.TOUCH_START,this.OnDiceClick,this),Lo.Instance.setInput("DiceRoll"),this.player.arrowPointToDiceAnimation(!1),console.log("Clicked on Dice"),Ht.Instance.CurrentRoom.send(Ho.CLIENT_DICE_ROLL,JSON.stringify({})))},o.onDiceRollDone=function(){this.player.outComesUIManager.addOutCome(this.currentDiceOutcome),Ht.Instance.CurrentRoom.send(Ho.ROLLING_ACK,JSON.stringify({})),console.log("Roll Ack Sent")},o.onDiceOutCome=function(){var e=JSON.parse(this.stateMachine.currentServerState.inputPayload.inputValue);this.player.dice.rollDice(e.value),this.currentDiceOutcome=e.value,console.log("Rolled : ",e.value),this.player.timer.stop()},o.reset=function(){this.exitState()},n}(ua);l._RF.pop(),l._RF.push({},"fad72B8hv9DkrVl5zLtWckn","Snl_PlayerStateMachine",void 0);var fa,ma,ya,ga,va,Sa,ba,_a=function(){function e(e){this._currentState=void 0,this.idleState=void 0,this.rollingState=void 0,this.movePieceState=void 0,this.player=void 0,this.currentServerState=void 0,this.currentTurnPlayerNumber=-1,this.player=e,this.idleState=new pa(this),this.rollingState=new da(this),this.movePieceState=new ha(this),this._currentState=this.idleState}var t=e.prototype;return t.updateState=function(e){null!=this._currentState&&this._currentState.updateState(e)},t.changeState=function(e){this._currentState.exitState(),this._currentState=e,this._currentState.enterState()},t.getPlayerNumber=function(){return this.player.playerNumber},t.onServerStateChange=function(e){if(this.currentServerState=e,this.currentTurnPlayerNumber!=e.turnPlayerNumber&&(this.currentTurnPlayerNumber=e.turnPlayerNumber,this.player.isMyTurn(e.turnPlayerNumber)&&(console.log("===================================="),console.log("Player Turn : ",this.currentTurnPlayerNumber))),this.currentServerState.currentRoomStatus!==Ee.END_GAME&&this.checkAndUpdateBotScreen(),this.player.isMyTurn(e.turnPlayerNumber)){if(e.inputPayload.inputType!=Ho.NONE)switch(e.inputPayload.inputType){case Ho.SET_STATE:this.onSetState(e);break;case Ho.DICE_OUTCOME:this._currentState==this.rollingState&&this.rollingState.onDiceOutCome();break;case Ho.MOVE_PIECE:this._currentState==this.movePieceState&&this.movePieceState.onMovePiece()}}else this._currentState!=this.idleState&&this.changeState(this.idleState)},t.onReconnection=function(e){if(this.currentServerState=e,this.rollingState.exitState(),this.movePieceState.exitState(),this.player.isMyTurn(e.turnPlayerNumber)){var t=e.playersData[this.player.playerNumber];this.player.outComesUIManager.reset(t.rollsList),e.currentGameState==oo.ROLLING?(this._currentState=this.rollingState,this._currentState.enterState(),this.player.timer.setCurrentTime(e.timer)):e.currentGameState==oo.MOVING_PIECE&&(this._currentState=this.movePieceState,this._currentState.enterState(),this.player.timer.setCurrentTime(e.timer))}else this.changeState(this.idleState)},t.onSetState=function(e){var t=e.playersData[this.player.playerNumber];this.player.outComesUIManager.reset(t.rollsList),e.currentGameState==oo.ROLLING?this.changeState(this.rollingState):e.currentGameState==oo.MOVING_PIECE&&this.changeState(this.movePieceState)},t.checkAndUpdateBotScreen=function(){this.player._isLocal&&(this.currentServerState.playersData[this.player.playerNumber].isKickedOut?Mo.instance.OpenMenu("KickedOutScreen"):this.currentServerState.playersData[this.player.playerNumber].isBot&&Mo.instance.OpenMenu("BotMadeMoveScreen"))},e}();l._RF.pop(),l._RF.push({},"3240d/RDEVAiZyC8mIyd7PY","Snl_PlayerAvatar",void 0);var Ca,Ta,Pa,wa,Oa,Na,Ea,Ra,Ia,Aa,Da,La,Fa,ka,Ma,za,Ha,Ga,Ua,xa,Ba,Wa,Va,Ka,ja,Ja,Ya,Za,Qa,qa,Xa,$a,es,ts,ns,is=c.ccclass,os=c.property,rs=(fa=is("SnlPlayerAvatar"),ma=os({type:E,tooltip:"Player Avatar"}),ya=os({type:E,tooltip:"Player Avatar Outline"}),fa((Sa=e((va=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"playerAvatar",Sa,i(t)),n(t,"outline",ba,i(t)),t.enableOnClick=!1,t.userId="",t}t(o,e);var r=o.prototype;return r.initialize=function(e,t){this.enableOnClick=e,this.userId=t},r.onEnable=function(){this.registerTouchEvents()},r.onDisable=function(){this.unregisterTouchEvents()},r.start=function(){},r.update=function(e){},r.registerTouchEvents=function(){this.playerAvatar&&this.playerAvatar.node&&this.playerAvatar.node.on(u.EventType.TOUCH_START,this.handleTouchStart,this)},r.unregisterTouchEvents=function(){this.playerAvatar&&this.playerAvatar.node&&this.playerAvatar.node.off(u.EventType.TOUCH_START,this.handleTouchStart,this)},r.handleTouchStart=function(){this.enableOnClick},r.setOutline=function(e){this.outline&&(this.outline.enabled=e)},r.setOutlineColor=function(e){this.outline&&(this.outline.color=e)},r.setAvatarFromUrl=function(e){console.log("Setting avatar from url: ",e);var t=this.getFromCache(e);t?this.createSpriteFrameFromTexture(t):this.loadRemoteImage(e)},r.setAvatarFromSpriteFrame=function(e){this.playerAvatar&&(this.playerAvatar.spriteFrame=e)},r.getFromCache=function(e){var t=W.assets.get(e);return t&&t.isValid&&"function"==typeof t.getHash?t:null},r.createSpriteFrameFromTexture=function(e){if(e&&e.isValid&&"function"==typeof e.getHash)if(this.playerAvatar){var t=new O;t.texture=e,this.playerAvatar.spriteFrame=t}else console.warn("[SnlPlayerAvatar] PlayerAvatar component is null");else console.warn("[SnlPlayerAvatar] Invalid texture provided")},r.loadRemoteImage=function(e){var t=this;W.loadRemote(e,{ext:".png"},(function(n,i){if(n)return console.error("[Player] Failed to load profile image: "+JSON.stringify(n)),void(window.ReactNativeWebView&&window.ReactNativeWebView.postMessage(JSON.stringify({message:"player_avatar_load_failed",data:{userId:t.userId,url:e,errorName:n.name,errorMessage:n.message,errorStack:n.stack}})));try{var o=new O,r=new V;r.image=i,r.isValid&&"function"==typeof r.getHash?(o.texture=r,t.playerAvatar?t.playerAvatar.spriteFrame=o:console.warn("[SnlPlayerAvatar] PlayerAvatar component is null")):console.warn("[SnlPlayerAvatar] Invalid texture created from imageAsset")}catch(n){console.error("[Player] Error creating sprite frame: "+n),window.ReactNativeWebView&&window.ReactNativeWebView.postMessage(JSON.stringify({message:"player_sprite_frame_creation_failed",data:{userId:t.userId,url:e,error:n}}))}}))},o}(h)).prototype,"playerAvatar",[ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ba=e(va.prototype,"outline",[ya],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ga=va))||ga);l._RF.pop(),l._RF.push({},"0064a8AWZtHXaUaCzp7VEKF","Snl_Player",void 0);var as,ss,ls,cs,us,ps,hs,ds,fs,ms,ys=c.ccclass,gs=c.property,vs=function(e){return e[e.IDLE=0]="IDLE",e[e.ROLLING=1]="ROLLING",e[e.MOVING_PIECE=2]="MOVING_PIECE",e}({}),Ss=(Ca=ys("SnlPlayer"),Ta=gs({type:R}),Pa=gs({type:I}),wa=gs({type:E}),Oa=gs({type:E}),Na=gs({type:E}),Ea=gs({type:z}),Ra=gs({type:mr}),Ia=gs({type:E}),Aa=gs({type:hr}),Da=gs({type:u}),La=gs({type:E}),Fa=gs({type:E}),ka=gs({type:u}),Ma=gs({type:rs}),za=gs({type:aa}),Ha=gs({type:u}),Ca((xa=e((Ua=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"playerNumber",xa,i(t)),n(t,"playerName",Ba,i(t)),n(t,"profileImage",Wa,i(t)),n(t,"profilePicHolder",Va,i(t)),n(t,"borderSprite",Ka,i(t)),n(t,"profilePicWidget",ja,i(t)),n(t,"timer",Ja,i(t)),n(t,"timerSprite",Ya,i(t)),n(t,"dice",Za,i(t)),n(t,"diceRoot",Qa,i(t)),n(t,"diceBgSprite",qa,i(t)),n(t,"namePlateSprite",Xa,i(t)),n(t,"piecesBase",$a,i(t)),n(t,"playerAvatar",es,i(t)),t.bases=[],t.sortedBasesHorizontalPosition=[],t.pawns=[],t.playerData=null,t.state=vs.IDLE,t._isLocal=!1,t._isInitialized=!1,t._currentPiecesData=[0,0,0,0],t._currentDiceValue=1,t._pieceAnimations=[],t._isProfileInitialized=!1,t._board=null,t._myBasesParent=null,t._pawnHandler=null,n(t,"outComesUIManager",ts,i(t)),n(t,"dicePointingArrow",ns,i(t)),t.diceArrowInitialPosition=new L(0,0,0),t._currentSelectedPieceNumber=-1,t._moveOptioneInput=null,t._gameOptions=null,t._stateMachine=void 0,t.profileImageUrl="",t.arrowAnimation=null,t}t(o,e);var r=o.prototype;return r.onLoad=function(){this._pawnHandler=new Vr(this.pawns,this),this.diceArrowInitialPosition=this.dicePointingArrow.getPosition(),null==this._stateMachine&&(this._stateMachine=new _a(this))},r.start=function(){this.createMoveOptionsUI()},r.update=function(e){this._stateMachine.updateState(e)},r.createMoveOptionsUI=function(){var e=w(On.instance.moveOptionsUI);e.setParent(this.node),e.setPosition(new L(0,0,0)),this._moveOptioneInput=e.getComponent(ca),this._moveOptioneInput.node.active=!1},r.initialize=function(e,t,n){var i=this;console.log("[Player] Initializing Player : ",this.playerNumber),this._board=t,this.playerNumber=n;var o=e.playersData.find((function(e){return e.playerNumber==i.playerNumber}));if(this.playerData=o,console.log("[Player] My Profile Data : ",o),null!=o){o.sessionId==Ht.Instance.CurrentRoom.sessionId&&(console.log("Setting Local Player"),this._isLocal=!0,this.timer.setLocal(this._isLocal)),this.loadProfile(o),this._myBasesParent=t.getPlayerBase(this.playerNumber);var r=e.gameOptions.piecesPerPlayer;this.createPawns(r),this._gameOptions=e.gameOptions,this.setDiceBgColor(),this.setBorderAndTimerColor(),this.outComesUIManager.setPlayer(this)}},r.loadProfile=function(e){if(!this._isProfileInitialized&&null!=e){var t=e.name;this._isLocal&&(t="You"),this.playerName.string=this.truncateName(t,8),this.profileImageUrl=e.avatar,this._isInitialized=!0,this.loadProfileImage(),this.profileImage.node.on(u.EventType.TOUCH_START,this.openProfile,this)}},r.loadProfileImage=function(){this.profileImageUrl?this.playerAvatar.setAvatarFromUrl(this.profileImageUrl):console.warn("[Player] No profile image URL provided")},r.createBases=function(e){var t=this;console.log("[Player] Creating Bases for Player : ",this.playerNumber);var n=On.instance.getPawnWidth();this.bases=Array.from({length:e},(function(e,i){var o=w(On.instance.basePrefab),r=(n+0)*i;return o.setParent(t._myBasesParent,!0),o.name="Base"+i,o.setPosition(new L(r,0,0)),o})),this.sortedBasesHorizontalPosition=this.bases.sort((function(e,t){return e.position.x-t.position.x}))},r.createPawns=function(e){console.log("[Player] Creating Pawns for Player : ",this.playerNumber);for(var t=On.instance.pawnPrefab,n=0;n<e;n++){this.log("CREATING PAWN ",n),this.log("BASES : ",this.bases);var i=w(t);i.setParent(this.piecesBase,!0),i.setPosition(new L(0,0,0));var o=i.getComponent(yi);o.Initialize(this.playerNumber,n,this),this.pawns.push(o),io.Instance.addPiece(o)}},r.onServerStateChange=function(e){null==this._stateMachine&&(this._stateMachine=new _a(this)),this._stateMachine.onServerStateChange(e)},r.onReconnection=function(e){this._stateMachine.onReconnection(e)},r.isMyTurn=function(e){return this.playerNumber==e},r.isAnyPieceSelected=function(){return-1!=this._currentSelectedPieceNumber},r.truncateName=function(e,t){var n=e.indexOf(" ");return-1!=n&&(e=e.substring(0,n)),e.length>t?e.substring(0,t)+"..":e},r.setPlayerNumber=function(e){this.playerNumber=e},r.enableName=function(e){},r.arrowPointToDiceAnimation=function(e){var t;null==(t=this.arrowAnimation)||t.stop(),console.log("arrowPointToDiceAnimation : ",e),e?(console.log("Enabling Arrow"),this.dicePointingArrow.active=!0,this.dicePointingArrow.setPosition(this.diceArrowInitialPosition),this.arrowAnimation=D(this.dicePointingArrow),this.arrowAnimation.by(.2,{position:new L(-10,-0,0)}),this.arrowAnimation.by(.2,{position:new L(10,0,0)}),this.arrowAnimation.union(),this.arrowAnimation.repeatForever(),this.arrowAnimation.start()):(console.log("Disabling Arrow"),this.dicePointingArrow.active=!1,this.arrowAnimation.stop())},r.isFinished=function(){for(var e=this._gameOptions,t=0;t<this.pawns.length;t++)if(this.pawns[t].pathNumber==io.Instance.TotalPathCount(e))return!0;return!1},r.setDiceBgColor=function(){this.diceBgSprite.color=On.instance.getDiceBgColor(this.playerNumber)},r.setBorderAndTimerColor=function(){this.borderSprite&&(this.borderSprite.color=On.instance.getPawnColor(this.playerNumber))},r.GetProfileSpriteFrame=function(){return this.profileImage.spriteFrame},r.openProfile=function(){var e=this,t=this._stateMachine.currentServerState.playersData.find((function(t){return t.playerNumber==e.playerNumber})).userId;console.log("Opening Profile of User : ",t)},o}(h)).prototype,"playerNumber",[Ta],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),Ba=e(Ua.prototype,"playerName",[Pa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Wa=e(Ua.prototype,"profileImage",[wa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Va=e(Ua.prototype,"profilePicHolder",[Oa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ka=e(Ua.prototype,"borderSprite",[Na],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ja=e(Ua.prototype,"profilePicWidget",[Ea],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ja=e(Ua.prototype,"timer",[Ra],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ya=e(Ua.prototype,"timerSprite",[Ia],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Za=e(Ua.prototype,"dice",[Aa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Qa=e(Ua.prototype,"diceRoot",[Da],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),qa=e(Ua.prototype,"diceBgSprite",[La],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Xa=e(Ua.prototype,"namePlateSprite",[Fa],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),$a=e(Ua.prototype,"piecesBase",[ka],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),es=e(Ua.prototype,"playerAvatar",[Ma],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ts=e(Ua.prototype,"outComesUIManager",[za],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ns=e(Ua.prototype,"dicePointingArrow",[Ha],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ga=Ua))||Ga);l._RF.pop(),l._RF.push({},"043b9WCKYxCpKgbHB9BKVdi","SNLGameHandler",void 0);var bs,_s,Cs,Ts,Ps,ws,Os,Ns=c.ccclass,Es=c.property,Rs=(new S,as=Ns("SNLGameHandler"),ss=Es({type:u}),ls=Es({type:io}),cs=Es({type:Ss}),as(((ms=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return(t=e.call.apply(e,[this].concat(r))||this)._clientState=void 0,t._serverState=void 0,n(t,"playersParent",hs,i(t)),t.allPlayers=[],n(t,"board",ds,i(t)),t.myPlayerNumber=0,t.hasReconnected=!1,n(t,"localPlayer",fs,i(t)),t}t(o,e);var a=o.prototype;return a.onLoad=function(){this.LoadPlayers(),kt.on(de.CONNECTION_STATE_CHANGE,this.onConnectionStateChange,this),Mt.on(de.SERVER_ROOM_STATE_CHANGE,this.OnServerStateChange,this),o._instance=this,K.on(j.EVENT_HIDE,this.onGameHide,this),K.on(j.EVENT_SHOW,this.onGameShow,this),K.on(j.EVENT_RESTART,this.onGameRestart,this),K.on(j.EVENT_CLOSE,this.onGameClose,this),window.addEventListener("beforeunload",this.onGameClose)},a.LoadPlayers=function(){this.allPlayers=this.playersParent.children.map((function(e){return e.getComponent(Ss)}))},a.Init=function(e){},a.onGameHide=function(){console.log("====== Game Hide ======"),x.stopAll()},a.onGameShow=function(){console.log("====== Game Show ======"),x.stopAllByTag(or.DICE_ROLL),Lo.Instance._roomState,Ee.GAME_SIMULATION},a.onGameRestart=function(){console.log("====== Game Restart ======")},a.onGameClose=function(){console.log("====== Game Close ======"),Xi.instance.clearPlayers()},a.onGameDisconnect=function(){console.log("====== Game Disconnect ======"),Bt.instance.stopAllSounds()},a.onGameReconnect=function(){console.log("====== Game Reconnect ======")},a.OnServerStateChange=function(e){return console.log("============ OnServerStateChange ========="),null==this._clientState?(this._clientState=new yo,this._clientState.copyFrom(e),this._serverState=new yo,this._serverState.copyFrom(e),this.board.Initialize(e),this.InitializePlayers(e),void(this._serverState.currentGameState!=oo.NONE&&(console.log("========= joined game in between ========="),this.board.reset(this._serverState),this.sendReconnectionStateToAllPlayers(this._serverState)))):(this._serverState=new yo,this._serverState.copyFrom(e),e.currentRoomStatus==Ee.END_GAME?(console.log("========= Game Over State Change "),void this.board.reset(this._serverState)):this.hasReconnected?(console.log("========= sending Reconnection State Change "),this.board.reset(this._serverState),this.sendReconnectionStateToAllPlayers(this._serverState),void(this.hasReconnected=!1)):void this.sendStateToAllPlayers(this._serverState))},a.onConnectionStateChange=function(e,t){t==fe.DISCONNECTED?this.onGameDisconnect():e==fe.RECONNECTING&&t==fe.JOINED_ROOM&&(this.hasReconnected=!0,this.onGameReconnect())},a.sendStateToAllPlayers=function(e){for(var t=0;t<this.allPlayers.length;t++)this.allPlayers[t].onServerStateChange(e)},a.sendReconnectionStateToAllPlayers=function(e){console.log("=========Reconnection State Sent to All Players");for(var t=0;t<this.allPlayers.length;t++)this.allPlayers[t].node.active&&this.allPlayers[t].onReconnection(e)},a.InitializePlayers=function(e){this.assignMyPlayerNumber(e),Xi.instance.setMyPlayerNumber(this.myPlayerNumber),ke.info("My Player Number : ",this.myPlayerNumber);for(var t=0;t<e.playersData.length;t++)if(t==this.myPlayerNumber)this.localPlayer.node.active=!0,this.localPlayer.initialize(e,this.board,this.myPlayerNumber),this.allPlayers.push(this.localPlayer),Xi.instance.registerPlayer(this.localPlayer,!0),ke.info("Local Player node name : ",this.localPlayer.node.name);else{console.log("Initializing Player : ",t),console.log("current player : ",this.allPlayers[t]);var n=this.allPlayers[t];n.node.active=!0,n.initialize(e,this.board,t),Xi.instance.registerPlayer(n),ke.info("Current Player node name : ",n.node.name)}},a.assignMyPlayerNumber=function(e){for(var t=0;t<e.playersData.length;t++)if(e.playersData[t].sessionId==Ht.Instance.CurrentRoom.sessionId){this.myPlayerNumber=t;break}},a.getPlayer=function(e){return Xi.instance.getPlayer(e)},a.getNumberOfProfileRotation=function(e){return 0==e?0:1==e?2:2==e?1:3==e?3:void 0},a.allPlayersFinished=function(){for(var e=0,t=0,n=0;n<this.allPlayers.length;n++)this.allPlayers[n].node.active&&(t++,this.allPlayers[n].isFinished()&&e++);return console.log("Finished Players Count ",e),console.log("Total Players ",this.allPlayers.length),e==t-1},a.anyPlayerFinished=function(){for(var e=0;e<this.allPlayers.length;e++)if(this.allPlayers[e].isFinished())return!0;return!1},a.getMostDeathsPlayer=function(){for(var e=-1,t=-1,n=0;n<this._serverState.playersData.length;n++){var i=this._serverState.playersData[n];i.deathsCount>e&&(e=i.deathsCount,t=i.playerNumber)}return this.getPlayer(t)},a.getMostLadderClimbsPlayer=function(){for(var e=-1,t=-1,n=0;n<this._serverState.playersData.length;n++){var i=this._serverState.playersData[n];i.ladderClimbCount>e&&(e=i.ladderClimbCount,t=i.playerNumber)}return this.getPlayer(t)},a.isLocalUserHost=function(){return Lo.Instance.miloSDK.getHostId()==this.localPlayer.playerData.userId},a.getHostPlayer=function(){var e=Lo.Instance.miloSDK.getHostId();return e?this.allPlayers.filter((function(e){return e.playerData})).find((function(t){return t.playerData.userId==e})):null},a.onDestroy=function(){this.cleanup()},a.cleanup=function(){kt.off(de.CONNECTION_STATE_CHANGE,this.onConnectionStateChange,this),Mt.off(de.SERVER_ROOM_STATE_CHANGE,this.OnServerStateChange,this),K.off(j.EVENT_HIDE,this.onGameHide,this),K.off(j.EVENT_SHOW,this.onGameShow,this),K.off(j.EVENT_RESTART,this.onGameRestart,this),K.off(j.EVENT_CLOSE,this.onGameClose,this),window.removeEventListener("beforeunload",this.onGameClose),Xi.instance.clearPlayers(),o._instance===this&&(o._instance=null)},r(o,null,[{key:"Instance",get:function(){return this._instance}}]),o}(h))._instance=void 0,hs=e((ps=ms).prototype,"playersParent",[ss],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ds=e(ps.prototype,"board",[ls],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),fs=e(ps.prototype,"localPlayer",[cs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),us=ps))||us);l._RF.pop(),l._RF.push({},"0c5b9AHjNhFyp75IDpZBX2d","Snl_EndRoundScreen",void 0);var Is,As,Ds,Ls,Fs,ks,Ms,zs=c.ccclass,Hs=c.property;bs=zs("SnlEndRoundScreen"),_s=Hs({type:rs}),Cs=Hs({type:I}),bs((ws=e((Ps=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"playerAvatar",ws,i(t)),n(t,"playerName",Os,i(t)),t._shouldShowThisScreen=!1,t._optionsInitialized=!1,t._rotatingGlow=null,t}t(o,e);var r=o.prototype;return r.onLoad=function(){e.prototype.onLoad.call(this),Mt.on(de.SERVER_ROOM_STATE_CHANGE,this.ServerStateChanged,this)},r.onDestroy=function(){Mt.off(de.SERVER_ROOM_STATE_CHANGE,this.ServerStateChanged,this)},r.ServerStateChanged=function(e){if(!this._optionsInitialized){var t=new yo;t.gameOptions&&(this._shouldShowThisScreen=t.gameOptions.show_result_screen,this._optionsInitialized=!0),t.copyFrom(e)}},r.Open=function(){this._shouldShowThisScreen&&(e.prototype.Open.call(this),this.initialize())},r.Close=function(){e.prototype.Close.call(this),this.stopRotateGlow()},r.initialize=function(){if(e.prototype.initialize.call(this),Mo.instance.showResultScreen){Lo.Instance._won;var t=Lo.Instance._serverStateCopy.playersData.findIndex((function(e){return 1==e.finishPosition}));if(-1!=t){var n=Rs.Instance.getPlayer(t);this.playerAvatar.setAvatarFromSpriteFrame(n.GetProfileSpriteFrame()),this.playerAvatar.setOutlineColor(On.instance.getPawnColor(t)),this.playerName.string=this.GetDisplayName(n.playerName.string)}else console.error("no winning player")}else this.Close()},r.stopRotateGlow=function(){this._rotatingGlow&&(this._rotatingGlow.stop(),this._rotatingGlow=null)},r.GetDisplayName=function(e){return e.length>8?e.substring(0,8)+"..":e},o}(he)).prototype,"playerAvatar",[_s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Os=e(Ps.prototype,"playerName",[Cs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ts=Ps));l._RF.pop(),l._RF.push({},"296caJJcldLUrOdusp7ig4x","Snl_HowToPlay",void 0);var Gs,Us,xs,Bs,Ws,Vs,Ks,js,Js,Ys,Zs,Qs=c.ccclass,qs=c.property;Is=Qs("SnlHowToPlay"),As=qs({type:J}),Ds=qs({type:Y}),Is((ks=e((Fs=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"nextButton",ks,i(t)),n(t,"pageView",Ms,i(t)),t}t(o,e);var r=o.prototype;return r.onLoad=function(){e.prototype.onLoad.call(this)},r.onDestroy=function(){},r.Open=function(){e.prototype.Open.call(this)},r.Close=function(){e.prototype.Close.call(this)},r.initHandTween=function(){},r.onNextButtonClick=function(){this.log("Next button clicked"),this.pageView.scrollToPage(1)},o}(he)).prototype,"nextButton",[As],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ms=e(Fs.prototype,"pageView",[Ds],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Ls=Fs));l._RF.pop(),l._RF.push({},"a2162SoADBGWarZh5FA49gB","Snl_InGameMenu",void 0);var Xs,$s,el,tl,nl,il,ol,rl,al,sl,ll,cl=c.ccclass,ul=c.property;Gs=cl("SnlInGameMenu"),Us=ul({type:O}),xs=ul({type:O}),Bs=ul({type:E}),Ws=ul({type:u}),Gs((js=e((Ks=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"soundOnSprite",js,i(t)),n(t,"soundOffSprite",Js,i(t)),n(t,"soundButton",Ys,i(t)),n(t,"faqButton",Zs,i(t)),t}t(o,e);var r=o.prototype;return r.onLoad=function(){e.prototype.onLoad.call(this),Mt.on(de.SERVER_ROOM_STATE_CHANGE,this.ServerStateChanged,this)},r.onDestroy=function(){Mt.off(de.SERVER_ROOM_STATE_CHANGE,this.ServerStateChanged,this)},r.ServerStateChanged=function(e){this.soundButton.node.active=e.gameOptions.show_mute_button},r.start=function(){},r.Open=function(){console.log("InGameMenu open called"),e.prototype.Open.call(this),this.initialize()},r.Close=function(){e.prototype.Close.call(this)},r.initialize=function(){e.prototype.initialize.call(this),this.UpdateAudioSprite(),this.soundButton.node.active=Mo.instance.showMuteButton,this.faqButton.active=Mo.instance.showFAQ},r.UpdateAudioSprite=function(){"true"==Bt.instance.IsAudioEnabled?this.soundButton.spriteFrame=this.soundOnSprite:this.soundButton.spriteFrame=this.soundOffSprite},r.ToggleSound=function(){Bt.instance.ToggleAudio(),this.UpdateAudioSprite()},o}(he)).prototype,"soundOnSprite",[Us],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Js=e(Ks.prototype,"soundOffSprite",[xs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Ys=e(Ks.prototype,"soundButton",[Bs],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Zs=e(Ks.prototype,"faqButton",[Ws],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Vs=Ks));l._RF.pop(),l._RF.push({},"323427oA1NHOrzVll+3ZoDO","Snl_InstructionsScreen",void 0);var pl,hl,dl,fl,ml,yl=c.ccclass,gl=c.property;Xs=yl("SnlInstructionsScreen"),$s=gl({type:u}),el=gl({type:u}),tl=gl({type:u}),nl=gl({type:u}),Xs((rl=e((ol=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"helpInstructions",rl,i(t)),n(t,"autoMoveInstructions",al,i(t)),n(t,"waitingForUser",sl,i(t)),n(t,"spinner",ll,i(t)),t._isHelpInstructionDone=!1,t._isAutoMoveInstructionDone=!1,t}t(o,e);var r=o.prototype;return r.onLoad=function(){e.prototype.onLoad.call(this),D(this.spinner).repeatForever(D().by(1,{angle:360})).start()},r.onDestroy=function(){},r.Open=function(){e.prototype.Open.call(this),this.initialization()},r.Close=function(){e.prototype.Close.call(this)},r.initialization=function(){},o}(he)).prototype,"helpInstructions",[$s],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),al=e(ol.prototype,"autoMoveInstructions",[el],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),sl=e(ol.prototype,"waitingForUser",[tl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),ll=e(ol.prototype,"spinner",[nl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),il=ol));l._RF.pop(),l._RF.push({},"fd780+uGGxGLrb+sG3j/mKp","Snl_KickedOutScreen",void 0);var vl,Sl,bl,_l,Cl,Tl=c.ccclass,Pl=c.property;pl=Tl("SnlKickedOutScreen"),hl=Pl({type:I}),pl((ml=e((fl=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"kickedOutLabel",ml,i(t)),t}t(o,e);var r=o.prototype;return r.onLoad=function(){e.prototype.onLoad.call(this)},r.onDestroy=function(){},r.Open=function(){e.prototype.Open.call(this),this.kickedOutLabel.string="You missed "+Lo.Instance._missTurnsToKickOut+" turns. kicked out of the game!"},r.Close=function(){e.prototype.Close.call(this)},r.initHandTween=function(){},r.update=function(e){},o}(he)).prototype,"kickedOutLabel",[hl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),dl=fl));l._RF.pop(),l._RF.push({},"654c4C1kvRI9o7GcV+JKcUM","Snl_ReconnectingScreen",void 0);var wl,Ol,Nl,El,Rl,Il=c.ccclass,Al=c.property;vl=Il("SnlReconnectingScreen"),Sl=Al({type:u}),vl((Cl=e((_l=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"spinner",Cl,i(t)),t._spinnerTween=null,t}t(o,e);var r=o.prototype;return r.onLoad=function(){e.prototype.onLoad.call(this)},r.onDestroy=function(){},r.Open=function(){e.prototype.Open.call(this),this.startSpinner()},r.Close=function(){e.prototype.Close.call(this),this.stopSpinner()},r.startSpinner=function(){this._spinnerTween=D(this.spinner).repeatForever(D().by(1,{angle:360})).start()},r.stopSpinner=function(){var e;null==(e=this._spinnerTween)||e.stop(),this._spinnerTween=null},r.initHandTween=function(){},r.initialization=function(){this.initHandTween()},o}(he)).prototype,"spinner",[Sl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),bl=_l));l._RF.pop(),l._RF.push({},"afe91hzxTRN/4/agyLtHzs5","TutorialScreen",void 0);var Dl,Ll=c.ccclass,Fl=c.property;wl=Ll("TutorialScreen"),Ol=Fl({type:u}),wl((Rl=e((El=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"handNode",Rl,i(t)),t._showHandGesture=!0,t._handAnimationTween=null,t}t(o,e);var r=o.prototype;return r.onLoad=function(){e.prototype.onLoad.call(this)},r.start=function(){},r.onDestroy=function(){},r.ServerGameOptionsReceived=function(e){this._showHandGesture=e.show_hand_gesture},r.onSelectedLane=function(){console.log("Selected lane so closing tutorial"),this.Close()},r.Open=function(){this._showHandGesture&&(e.prototype.Open.call(this),this.initialization())},r.Close=function(){e.prototype.Close.call(this),this._handAnimationTween&&this._handAnimationTween.stop()},r.handClickAnimation=function(){var e=this,t=new k;k.fromEuler(t,0,0,15);new k;k.fromEuler(t,0,0,15),this._handAnimationTween=D(this.handNode).call((function(){e.handNode.eulerAngles=L.ZERO.clone()})).delay(.2).to(.3,{rotation:t},{easing:"backOut"}).delay(.7).union().repeatForever(),this._handAnimationTween.start()},r.initialization=function(){this.handClickAnimation()},o}(he)).prototype,"handNode",[Ol],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Nl=El));l._RF.pop(),l._RF.push({},"a09e5Z+tyVKPLUvl7lBdOyg","WaitingScreen",void 0);var kl,Ml,zl,Hl,Gl,Ul=c.ccclass;c.property,Ul("WaitingScreen")(Dl=function(e){function n(){return e.apply(this,arguments)||this}t(n,e);var i=n.prototype;return i.onLoad=function(){e.prototype.onLoad.call(this)},i.onDestroy=function(){},i.Open=function(){e.prototype.Open.call(this)},i.Close=function(){e.prototype.Close.call(this)},i.initialize=function(){e.prototype.initialize.call(this)},n}(he));l._RF.pop(),l._RF.push({},"af0c5MGzgxFxYg7gwI0cmu1","Snl_FitToScreen",void 0);var xl,Bl,Wl,Vl,Kl,jl,Jl,Yl,Zl,Ql,ql,Xl,$l,ec,tc,nc=c.ccclass,ic=c.property;kl=nc("SnlFitToScreen"),Ml=ic({type:b}),kl((Gl=e((Hl=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"updateWidgetsRecursively",Gl,i(t)),t}t(o,e);var r=o.prototype;return r.onEnable=function(){var e=this;Z.once(Q.EVENT_AFTER_UPDATE,(function(){e.refresh()}))},r.setUiTransformToScreenSize=function(){var e=this.node.getComponent(d),t=Ae.instance.getCurrentOrthoHeight()/Ae.instance.defaultOrthoHeight,n=m.windowSize.width||window.innerWidth,i=m.windowSize.height||window.innerHeight,o=Ae.instance.designHeight*t,r=o*n/i;console.log("windowWidth",n,"windowHeight",i),e.setContentSize(r,o)},r.refresh=function(){this.setUiTransformToScreenSize(),this.updateWidgetsRecursively&&this.updateWidgetsInHierarchy()},r.updateWidgetsInHierarchy=function(){this.updateWidgetAndDescendants(this.node)},r.updateWidgetAndDescendants=function(e){var t=this,n=e.getComponent(z);n&&this.node.uuid!=e.uuid&&n.updateAlignment(),e.children.forEach((function(e){t.updateWidgetAndDescendants(e)}))},o}(h)).prototype,"updateWidgetsRecursively",[Ml],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),zl=Hl));l._RF.pop(),l._RF.push({},"074a0/fIGpEnrPANvPQz6du","Snl_MiloLayout",void 0);var oc,rc,ac,sc,lc,cc,uc,pc,hc,dc,fc,mc,yc,gc,vc,Sc,bc,_c,Cc,Tc,Pc,wc,Oc,Nc=c.ccclass,Ec=c.property,Rc=function(e){return e[e.HORIZONTAL=0]="HORIZONTAL",e[e.VERTICAL=1]="VERTICAL",e[e.GRID=2]="GRID",e}({}),Ic=function(e){return e[e.LEFT_TOP=0]="LEFT_TOP",e[e.CENTER_TOP=1]="CENTER_TOP",e[e.RIGHT_TOP=2]="RIGHT_TOP",e[e.LEFT_CENTER=3]="LEFT_CENTER",e[e.CENTER=4]="CENTER",e[e.RIGHT_CENTER=5]="RIGHT_CENTER",e[e.LEFT_BOTTOM=6]="LEFT_BOTTOM",e[e.CENTER_BOTTOM=7]="CENTER_BOTTOM",e[e.RIGHT_BOTTOM=8]="RIGHT_BOTTOM",e}({});xl=Nc("SnlMiloLayout"),Bl=Ec({type:q(Rc)}),Wl=Ec({type:q(Rc)}),Vl=Ec({type:q(Ic)}),Kl=Ec({type:q(Ic)}),jl=Ec({visible:function(){return this._layoutType===Rc.GRID}}),xl((Zl=e((Yl=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"_layoutType",Zl,i(t)),n(t,"_alignment",Ql,i(t)),n(t,"_spacingX",ql,i(t)),n(t,"_spacingY",Xl,i(t)),n(t,"_columns",$l,i(t)),n(t,"_padding",ec,i(t)),n(t,"_autoResize",tc,i(t)),t._activeChildCount=0,t._layoutSize=new X(0,0),t._lastChildActiveState=[],t}t(o,e);var a=o.prototype;return a.onLoad=function(){this.node.on(u.EventType.CHILD_ADDED,this.onChildAdded,this),this.node.on(u.EventType.CHILD_REMOVED,this.onChildRemoved,this)},a.onDestroy=function(){this.node.off(u.EventType.CHILD_ADDED,this.onChildAdded,this),this.node.off(u.EventType.CHILD_REMOVED,this.onChildRemoved,this),this.removeAllChildListeners()},a.onChildRemoved=function(e){this.removeChildListener(e),this.updateLayout()},a.removeAllChildListeners=function(){},a.removeChildListener=function(e){e.__miloLayoutActiveHandler&&(e.off(u.EventType.ACTIVE_IN_HIERARCHY_CHANGED,e.__miloLayoutActiveHandler),e.__miloLayoutActiveHandler=null)},a.start=function(){this._lastChildActiveState=this.node.children.map((function(e){return e.active})),this.updateLayout(),this.addChildActiveListeners()},a.addChildActiveListeners=function(){var e=this;this.node.children.forEach((function(t){e.addChildActiveListener(t)}))},a.addChildActiveListener=function(e){var t=this;e.off(u.EventType.ACTIVE_IN_HIERARCHY_CHANGED,this.onChildActiveChanged,this);var n=function(){t.scheduleOnce((function(){t.updateLayout()}),0)};e.__miloLayoutActiveHandler=n,e.on(u.EventType.ACTIVE_IN_HIERARCHY_CHANGED,n)},a.onChildActiveChanged=function(e){},a.onEnable=function(){this.updateLayout()},a.getAlignmentOffset=function(e){var t,n=new L,i=(null==(t=this.node.getComponent(d))?void 0:t.contentSize)||new X(0,0);switch(this._alignment){case Ic.LEFT_TOP:case Ic.LEFT_CENTER:case Ic.LEFT_BOTTOM:n.x=this._padding;break;case Ic.CENTER_TOP:case Ic.CENTER:case Ic.CENTER_BOTTOM:n.x=(i.width-e.width)/2;break;case Ic.RIGHT_TOP:case Ic.RIGHT_CENTER:case Ic.RIGHT_BOTTOM:n.x=i.width-e.width-this._padding}switch(this._alignment){case Ic.LEFT_TOP:case Ic.CENTER_TOP:case Ic.RIGHT_TOP:n.y=-this._padding;break;case Ic.LEFT_CENTER:case Ic.CENTER:case Ic.RIGHT_CENTER:n.y=-(i.height-e.height)/2;break;case Ic.LEFT_BOTTOM:case Ic.CENTER_BOTTOM:case Ic.RIGHT_BOTTOM:n.y=-i.height+e.height+this._padding}return n},a.updateLayout=function(){if(this.node){var e=this.node.children.filter((function(e){return e.active}));if(this._activeChildCount=e.length,0!==this._activeChildCount)switch(this._layoutType){case Rc.HORIZONTAL:this.updateHorizontalLayout(e);break;case Rc.VERTICAL:this.updateVerticalLayout(e);break;case Rc.GRID:this.updateGridLayout(e)}}},a.updateHorizontalLayout=function(e){var t=this,n=2*this._padding,i=0;e.forEach((function(o,r){var a=o.getComponent(d);a&&(n+=a.width,r<e.length-1&&(n+=t._spacingX),i=Math.max(i,a.height))}));var o=new X(n,i+2*this._padding),r=this.getAlignmentOffset(o),a=r.x;if(e.forEach((function(e){var n=e.getComponent(d);if(n){var o=n.height,s=n.width,l=r.y;switch(t._alignment){case Ic.LEFT_TOP:case Ic.CENTER_TOP:case Ic.RIGHT_TOP:l=r.y-t._padding;break;case Ic.LEFT_CENTER:case Ic.CENTER:case Ic.RIGHT_CENTER:l=r.y-(i-o)/2;break;case Ic.LEFT_BOTTOM:case Ic.CENTER_BOTTOM:case Ic.RIGHT_BOTTOM:l=r.y-i+o}e.position=new L(a+s/2,l-o/2,0),a+=s+t._spacingX}})),this._layoutSize=o,this._autoResize){var s=this.node.getComponent(d);s&&s.setContentSize(o)}},a.updateVerticalLayout=function(e){var t=this,n=2*this._padding,i=0;e.forEach((function(o,r){var a=o.getComponent(d);a&&(n+=a.height,r<e.length-1&&(n+=t._spacingY),i=Math.max(i,a.width))}));var o=new X(i+2*this._padding,n),r=this.getAlignmentOffset(o),a=r.y;if(e.forEach((function(e){var n=e.getComponent(d);if(n){var o=n.height,s=n.width,l=r.x;switch(t._alignment){case Ic.LEFT_TOP:case Ic.LEFT_CENTER:case Ic.LEFT_BOTTOM:l=r.x+t._padding;break;case Ic.CENTER_TOP:case Ic.CENTER:case Ic.CENTER_BOTTOM:l=r.x+(i-s)/2+t._padding;break;case Ic.RIGHT_TOP:case Ic.RIGHT_CENTER:case Ic.RIGHT_BOTTOM:l=r.x+i-s+t._padding}e.position=new L(l+s/2,a-o/2,0),a-=o+t._spacingY}})),this._layoutSize=o,this._autoResize){var s=this.node.getComponent(d);s&&s.setContentSize(o)}},a.updateGridLayout=function(e){if(!(this._columns<=0)){var t=Math.ceil(e.length/this._columns),n=0,i=0;e.forEach((function(e){var t=e.getComponent(d);t&&(n=Math.max(n,t.width),i=Math.max(i,t.height))}));for(var o=2*this._padding+n*this._columns+this._spacingX*(this._columns-1),r=2*this._padding+i*t+this._spacingY*(t-1),a=new X(o,r),s=this.getAlignmentOffset(a),l=0;l<t;l++){var c=Math.min(this._columns,e.length-l*this._columns),u=c*n+(c-1)*this._spacingX,p=0;switch(this._alignment){case Ic.CENTER_TOP:case Ic.CENTER:case Ic.CENTER_BOTTOM:p=(this._columns*n+(this._columns-1)*this._spacingX-u)/2;break;case Ic.RIGHT_TOP:case Ic.RIGHT_CENTER:case Ic.RIGHT_BOTTOM:p=this._columns*n+(this._columns-1)*this._spacingX-u}for(var h=0;h<c;h++){var f=l*this._columns+h;if(f>=e.length)break;var m=e[f],y=m.getComponent(d);if(y){var g=y.width,v=y.height,S=s.x+this._padding+h*(n+this._spacingX)+p,b=s.y-this._padding-l*(i+this._spacingY),_=S,C=b;switch(this._alignment){case Ic.LEFT_TOP:case Ic.LEFT_CENTER:case Ic.LEFT_BOTTOM:_=S;break;case Ic.CENTER_TOP:case Ic.CENTER:case Ic.CENTER_BOTTOM:_=S+(n-g)/2;break;case Ic.RIGHT_TOP:case Ic.RIGHT_CENTER:case Ic.RIGHT_BOTTOM:_=S+n-g}switch(this._alignment){case Ic.LEFT_TOP:case Ic.CENTER_TOP:case Ic.RIGHT_TOP:C=b;break;case Ic.LEFT_CENTER:case Ic.CENTER:case Ic.RIGHT_CENTER:C=b-(i-v)/2;break;case Ic.LEFT_BOTTOM:case Ic.CENTER_BOTTOM:case Ic.RIGHT_BOTTOM:C=b-i+v}m.position=new L(_+g/2,C-v/2,0)}}}if(this._layoutSize=a,this._autoResize){var T=this.node.getComponent(d);T&&T.setContentSize(a)}}},a.update=function(e){if(this.node&&this.node.children.length>0){var t=this.node.children.map((function(e){return e.active})),n=!1;if(this._lastChildActiveState.length!==t.length)n=!0;else for(var i=0;i<t.length;i++)if(this._lastChildActiveState[i]!==t[i]){n=!0;break}n&&(this._lastChildActiveState=t,this.updateLayout())}},a.onChildAdded=function(e){this.addChildActiveListener(e),this.updateLayout()},r(o,[{key:"layoutType",get:function(){return this._layoutType},set:function(e){this._layoutType=e,this.updateLayout()}},{key:"alignment",get:function(){return this._alignment},set:function(e){this._alignment=e,this.updateLayout()}},{key:"spacingX",get:function(){return this._spacingX},set:function(e){this._spacingX=e,this.updateLayout()}},{key:"spacingY",get:function(){return this._spacingY},set:function(e){this._spacingY=e,this.updateLayout()}},{key:"columns",get:function(){return this._columns},set:function(e){this._columns=e,this.updateLayout()}},{key:"padding",get:function(){return this._padding},set:function(e){this._padding=e,this.updateLayout()}},{key:"autoResize",get:function(){return this._autoResize},set:function(e){this._autoResize=e,this.updateLayout()}}]),o}(h)).prototype,"_layoutType",[Bl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Rc.HORIZONTAL}}),e(Yl.prototype,"layoutType",[Wl],Object.getOwnPropertyDescriptor(Yl.prototype,"layoutType"),Yl.prototype),Ql=e(Yl.prototype,"_alignment",[Vl],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return Ic.LEFT_TOP}}),e(Yl.prototype,"alignment",[Kl],Object.getOwnPropertyDescriptor(Yl.prototype,"alignment"),Yl.prototype),ql=e(Yl.prototype,"_spacingX",[Ec],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),e(Yl.prototype,"spacingX",[Ec],Object.getOwnPropertyDescriptor(Yl.prototype,"spacingX"),Yl.prototype),Xl=e(Yl.prototype,"_spacingY",[Ec],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 10}}),e(Yl.prototype,"spacingY",[Ec],Object.getOwnPropertyDescriptor(Yl.prototype,"spacingY"),Yl.prototype),$l=e(Yl.prototype,"_columns",[Ec],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),e(Yl.prototype,"columns",[jl],Object.getOwnPropertyDescriptor(Yl.prototype,"columns"),Yl.prototype),ec=e(Yl.prototype,"_padding",[Ec],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 0}}),e(Yl.prototype,"padding",[Ec],Object.getOwnPropertyDescriptor(Yl.prototype,"padding"),Yl.prototype),tc=e(Yl.prototype,"_autoResize",[Ec],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return!1}}),e(Yl.prototype,"autoResize",[Ec],Object.getOwnPropertyDescriptor(Yl.prototype,"autoResize"),Yl.prototype),Jl=Yl));l._RF.pop(),l._RF.push({},"a9e0eKF9Q1HlomPy3h4ueJO","Snl_PbExtensions",void 0),L.prototype.clampMagnitude=function(e,t){if(!(e>t)){var n=this.length();return n>t?(this.normalize(),this.multiplyScalar(t)):n<e&&(this.normalize(),this.multiplyScalar(e)),this}console.error("min should be less than max")},h.prototype.log=function(){for(var e=this.constructor.name,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];ke.info.apply(ke,[e+" "].concat(n))},l._RF.pop(),l._RF.push({},"fa5cdOgOIxMo6E6ar3zoqUl","Snl_Utils",void 0),l._RF.pop(),l._RF.push({},"9311ep3LWtMpKxM3yK2sM8p","Snl_nterfaces",void 0),l._RF.pop(),l._RF.push({},"90b03rmJTpJi74Y9Ym6KIHF","Snl_InputManager",void 0),l._RF.pop(),l._RF.push({},"8d0b3eUubVFyZ500OV2Hmds","Snl_RoundCompleted",void 0);var Ac,Dc,Lc,Fc,kc,Mc,zc,Hc=c.ccclass,Gc=c.property;oc=Hc("SnlRoundCompleted"),rc=Gc({type:rs}),ac=Gc({type:I}),sc=Gc({type:rs}),lc=Gc({type:I}),cc=Gc({type:rs}),uc=Gc({type:I}),pc=Gc({type:I}),hc=Gc({type:I}),dc=Gc({type:u}),fc=Gc({type:u}),oc((gc=e((yc=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"winnerAvatar",gc,i(t)),n(t,"winnerName",vc,i(t)),n(t,"mostDeathsPlayerAvatar",Sc,i(t)),n(t,"mostDeathsPlayerName",bc,i(t)),n(t,"mostLadderClimbPlayerAvatar",_c,i(t)),n(t,"mostLadderClimbPlayerName",Cc,i(t)),n(t,"deathsCountLabel",Tc,i(t)),n(t,"ladderClimbCountLabel",Pc,i(t)),n(t,"actionsButtonContainer",wc,i(t)),n(t,"infoContainer",Oc,i(t)),t._shouldShowThisScreen=!1,t._optionsInitialized=!1,t}t(o,e);var r=o.prototype;return r.onLoad=function(){e.prototype.onLoad.call(this),Mt.on(de.SERVER_ROOM_STATE_CHANGE,this.ServerStateChanged,this),te.on(ne.HOST_CHANGED,this.onHostChanged,this)},r.onDestroy=function(){Mt.off(de.SERVER_ROOM_STATE_CHANGE,this.ServerStateChanged,this),te.off(ne.HOST_CHANGED,this.onHostChanged,this)},r.ServerStateChanged=function(e){if(!this._optionsInitialized){var t=new yo;t.gameOptions&&(this._shouldShowThisScreen=t.gameOptions.show_result_screen,this._optionsInitialized=!0),t.copyFrom(e)}},r.Open=function(){this._shouldShowThisScreen&&(e.prototype.Open.call(this),this.initialize())},r.Close=function(){e.prototype.Close.call(this)},r.initialize=function(){e.prototype.initialize.call(this);var t=Lo.Instance._serverStateCopy.playersData.findIndex((function(e){return 1==e.finishPosition}));if(-1!=t){var n=Rs.Instance.getPlayer(t);this.winnerAvatar.setAvatarFromSpriteFrame(n.GetProfileSpriteFrame()),this.winnerName.string=n.playerData.name;var i=Rs.Instance.getMostDeathsPlayer();this.mostDeathsPlayerAvatar.setAvatarFromSpriteFrame(i.GetProfileSpriteFrame()),this.mostDeathsPlayerName.string=i.playerName.string;var o=Rs.Instance.getMostLadderClimbsPlayer();this.mostLadderClimbPlayerAvatar.setAvatarFromSpriteFrame(o.GetProfileSpriteFrame()),this.mostLadderClimbPlayerName.string=o.playerName.string,this.deathsCountLabel.string="Most Deaths: "+i.playerData.deathsCount,this.ladderClimbCountLabel.string="Most Ladders: "+o.playerData.ladderClimbCount,this.updateHostUI()}else console.error("no winning player")},r.updateHostUI=function(){var e=Rs.Instance.isLocalUserHost(),t=Rs.Instance.getHostPlayer();e?t&&(this.infoContainer.active=!1,this.actionsButtonContainer.active=!0):t&&(this.actionsButtonContainer.active=!1,this.infoContainer.getComponent(I).string="Ask "+t.playerData.name+"(Host) to play again or change game",this.infoContainer.active=!0)},r.onHostChanged=function(e){console.log("RoundCompleted: Host changed from",e.oldHostId,"to",e.newHostId),this.node.active&&this.updateHostUI()},r.onPlayAgainButtonClicked=function(){var e=Date.now();Lo.Instance.miloSDK.playAgain({timestamp:e}),console.log("play again button clicked")},r.onChangeGameButtonClicked=function(){var e=Date.now();Lo.Instance.miloSDK.changeGame({timestamp:e}),console.log("change game button clicked")},o}(he)).prototype,"winnerAvatar",[rc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),vc=e(yc.prototype,"winnerName",[ac],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Sc=e(yc.prototype,"mostDeathsPlayerAvatar",[sc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),bc=e(yc.prototype,"mostDeathsPlayerName",[lc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),_c=e(yc.prototype,"mostLadderClimbPlayerAvatar",[cc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Cc=e(yc.prototype,"mostLadderClimbPlayerName",[uc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Tc=e(yc.prototype,"deathsCountLabel",[pc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Pc=e(yc.prototype,"ladderClimbCountLabel",[hc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),wc=e(yc.prototype,"actionsButtonContainer",[dc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),Oc=e(yc.prototype,"infoContainer",[fc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),mc=yc));l._RF.pop(),l._RF.push({},"33ad2bxJEtMXbFVNSIWVYh4","Snl_AutoReturnToPool",void 0);var Uc=c.ccclass,xc=c.property;Ac=Uc("SnlAutoReturnToPool"),Dc=xc({type:C}),Lc=xc({type:b}),Ac((Mc=e((kc=function(e){function o(){for(var t,o=arguments.length,r=new Array(o),a=0;a<o;a++)r[a]=arguments[a];return t=e.call.apply(e,[this].concat(r))||this,n(t,"timeToReturnToPool",Mc,i(t)),n(t,"shouldDestroy",zc,i(t)),t}t(o,e);var r=o.prototype;return r.onEnable=function(){this.scheduleOnce(this.returnToPool,this.timeToReturnToPool)},r.start=function(){},r.update=function(e){},r.returnToPool=function(){ri.instance.returnObjectToPool(this.node),this.shouldDestroy&&this.node.destroy()},o}(h)).prototype,"timeToReturnToPool",[Dc],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return 3}}),zc=e(kc.prototype,"shouldDestroy",[Lc],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Fc=kc));l._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/snl_game', 'chunks:///snl_game.js'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});